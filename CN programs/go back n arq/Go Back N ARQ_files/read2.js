/* :files, 'spec_javascripts', ... @ (none) */


/* :files, 'spec_javascripts', ... @ (none) */


/* :asset_packager_compatibility, 'config/asset_packages.yml' @ 1425075658 */
/* public/javascripts/4gen.js @ 1425075658 */
init_4gen=function(){var t;"undefined"!=typeof jQuery&&(t=jQuery);var e,n=3,i=8,r="/images/4gen/trans_1x1.gif",o=30,s=315,a=1,c=2,l=3,u=12;window.console||(window.console={log:function(){}});var d=function(){function d(){}function h(t,e){t.prototype.addEvent=d.prototype.addEvent,t.prototype.removeEvent=d.prototype.removeEvent,t.prototype.fireEvent=d.prototype.fireEvent,t.prototype.initEventHelper=d.prototype.initEventHelper,t.prototype.possibleEvents=e}function p(t,e,n,i,r,o){this.id=t,this.shortstyle=e,this.family=n,this.fallback=i,this.weight=r,this.style=o}function f(t){this.fonts=[],this.docManager=t,this._cssRuleQueue=[],this._fontLoadQueue=[]}function _(t,e){this.pages=[],this.loaded=!1,this.fonts={},this.numFonts=0,this.fontLoader=e,this.groupNum=t||0}function g(t){for(var e in this._defaultParams)this._defaultParams.hasOwnProperty(e)&&(this[e]=t[e]||this._defaultParams[e]);for(var n=0;n<this._requiredParams.length;n++){var i=this._requiredParams[n];if(!this[i])throw"Missing required Page param: "+i}if(!this.contentUrl&&!this.innerPageElem)throw"Must initialize a page with either a contentUrl or innerPageElem element";if(this.containerElem.boundToPageObj===!0)throw"Container Elem is already bound to a page.  We shouldn't get here";this.containerElem.boundToPageObj=!0,this._targetWidth=null,this._innerPageVisible=!!this.innerPageElem,this._imagesTurnedOn=!1,this.boundingRect=null,this.isVisible=!1,this.displayDirty=!0,this.displayOn=null,this.loadHasStarted=!!this.innerPageElem}function m(){this.initEventHelper(),this.viewRect=null,this.enabled=!1;var t=this;this._scrollCallback=function(){t._eventHandler("scroll")},this._resizeCallback=function(){t._eventHandler("resize")}}function v(){}function b(e,n,i){"undefined"==typeof t&&"undefined"!=typeof scribd&&x.setJQuery(scribd.jQuery),t("html, body").animate({scrollTop:t(e).offset().top},{queue:!1,duration:n,easing:"linear",complete:i})}function y(){this._name="book",this.currentPageId=null;var t=this;this._fullscreenResizedCallback=function(e){t._fullscreenResized(e)}}function w(){this._name="slideshow",this.currentPageId=null;var t=this;this._fullscreenResizedCallback=function(e){t._fullscreenResized(e)}}function k(){this._name="scroll";var t=this;this._verticalPositionChangeCallback=function(){t.checkAndUpdateVisiblePages()},this._fullscreenResizedCallback=function(){t._fullscreenResized()},this._afterGotoPage=function(){t.documentManager.setIsScrolling(!1),t.isScrolling||(t.documentManager.visiblePagesChanged(),t._scrollEffect&&delete t._scrollEffect)}}function x(e,n,i){this.options=i||{},this.options.extrasWidth=this.options.extrasWidth||s,this.defaultViewMode=e||"scroll",this.mobile=n||!1,t&&(this.view_manager_deferred=t.Deferred()),this.initEventHelper(),this.pages={},this._pageWidths=null,this._fontLoader=new f(this),this.viewManagers={scroll:new k,slideshow:new w,book:new y},this.viewportManager=new m,this._currentFontAggregatorHostIdx=0,this.visiblePages=[],this.firstVisiblePage=null,this.lastVisiblePage=null,this.currentFontGroup=new _(0,this._fontLoader),this.isScrolling=!1,this._scrollingCount=0}function S(t,e,n){return Math.min(n,Math.max(e,t))}function C(t){return Math.floor(100*t)/100}var T={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(t){var e,n,i,r,o,s,a,c="",l=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<t.length;)r=this._keyStr.indexOf(t.charAt(l++)),o=this._keyStr.indexOf(t.charAt(l++)),s=this._keyStr.indexOf(t.charAt(l++)),a=this._keyStr.indexOf(t.charAt(l++)),e=r<<2|o>>4,n=(15&o)<<4|s>>2,i=(3&s)<<6|a,c+=String.fromCharCode(e),64!=s&&(c+=String.fromCharCode(n)),64!=a&&(c+=String.fromCharCode(i));return c=T._utf8_decode(c)},_utf8_decode:function(t){for(var e="",n=0,i=0,r=0;n<t.length;)i=t.charCodeAt(n),128>i?(e+=String.fromCharCode(i),n++):i>191&&224>i?(r=t.charCodeAt(n+1),e+=String.fromCharCode((31&i)<<6|63&r),n+=2):(r=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&i)<<12|(63&r)<<6|63&c3),n+=3);return e}};d.prototype.initEventHelper=function(){this.eventListenerEnabled=!0,this.eventListeners={};for(var t=0;t<this.possibleEvents.length;t++)this.eventListeners[this.possibleEvents[t]]={}},d.prototype.addEvent=function(t,e){if(!this.eventListeners[t])throw t+" is not a valid type of event";this.eventListeners[t].next_uid||(this.eventListeners[t].next_uid=1),e._event_listener_uid||(e._event_listener_uid=this.eventListeners[t].next_uid,this.eventListeners[t].next_uid++),this.eventListeners[t][e._event_listener_uid]=e},d.prototype.removeEvent=function(t,e){delete this.eventListeners[t][e._event_listener_uid]},d.prototype.fireEvent=function(t){function e(t){t.apply(o,i)}if(this.eventListenerEnabled){var n=this.eventListeners[t],i=[];if(arguments.length>1){i[arguments.length-2]=null;for(var r=1;r<arguments.length;r++)i[r-1]=arguments[r]}var o=this;for(var s in n)"next_uid"!=s&&n.hasOwnProperty(s)&&e(n[s])}};var E="font_preload_bed",$=function(){return document.styleSheets[0]&&!document.styleSheets[0].insertRule},M=function(t){return t%1==0},P=function(t,e){if($()){var n=t.innerHTML;t.href=e,t.innerHTML!=n&&(t.innerHTML=n)}else t.href=e},j=function(){var t=navigator.userAgent.toLowerCase();return t.search("android 2.2")>-1}(),D=function(){var t=navigator.userAgent.toLowerCase();return t.search("mobile")>-1&&t.search("safari")>-1&&!j}(),A=navigator.userAgent.indexOf("AppleWebKit/")>-1;e=function(){return $()?a:D?c:c}(),$()&&(i=5,n=2),j&&(i=1,n=1),p.prototype.eotCssRule=function(t){var e="src: url("+t+this.family+".eot); font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+e+"}"},p.prototype.ttfCssRule=function(t){var e="src: url("+t+this.family+".ttf) format('truetype'); font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+e+"}"},p.prototype.svgCssRule=function(t){var e="src: url("+t+"#"+this.family+") format('svg'); font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+e+"}"},p.prototype.createPreloadElem=function(){return"<span style='font-family: "+this.family+"'>scribd.</span> "},f.prototype._makeNewStyleBlock=function(){var t=document.createElement("style");window.createPopup||t.appendChild(document.createTextNode(""));var e=document.getElementsByTagName("head")[0];return e.appendChild(t),t},f.prototype._insertCssRule=function(t){this._cssRuleQueue.push(t)},f.prototype._flushCssRuleQueue=function(t){if(this._cssRuleQueue.length>0){var e=t&&document.getElementById(t)||this._makeNewStyleBlock(),n=this._cssRuleQueue.join("\n");$()?e.styleSheet.cssText=n:window.createPopup?e.innerHTML=n:e.appendChild(document.createTextNode(n)),this._cssRuleQueue=[]}},f.prototype.getFontAggregatorHostForFonts=function(t){for(var n=[],i=0;i<t.length;i++)n.push(t[i].shortstyle+t[i].id);n.sort();var r=this.docManager.nextFontAggregatorHost()+"/"+this.docManager.assetPrefix+"/"+n.join(",")+"/"+u+"/";switch(e){case a:break;case c:j||(r+="ttfs.css");break;case l:r+="fonts.svg"}return r},f.prototype._addTTFRules=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];this._insertCssRule(i.ttfCssRule(e))}},f.prototype._addSVGRules=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];this._insertCssRule(i.svgCssRule(e))}},f.prototype._addEOTRules=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];this._insertCssRule(i.eotCssRule(e))}},f.prototype._nextPreloadId=function(){this._preloadId||(this._preloadId=0);var t="preload_bed"+this._preloadId;return this._preloadId+=1,t},f.prototype._addCSSWebkit=function(t,e){function n(){{var t=document.createElement("div");i._nextPreloadId()}t.innerHTML=s;var n=document.getElementById(E),o=window.setInterval(function(){r.contentDocument.styleSheets.length>0&&(window.clearInterval(o),r.contentDocument.body.getBoundingClientRect(),n.appendChild(t),window.setTimeout(function(){r.contentDocument.body.getBoundingClientRect(),i._addCSSLink(e)},500))},0)}var i=this,r=document.createElement("iframe"),o=this._nextPreloadId();r.id=o;for(var s="",a=0;a<t.length;a++){var c=t[a];s+=c.createPreloadElem()}this._makeNewStyleBlock();r.addEventListener("load",function(){n()},!1),r.style.display="none",document.body.appendChild(r),r.contentDocument.body.innerHTML=s;var l=r.contentDocument.createElement("link");l.href=e,l.rel="stylesheet",l.type="text/css",l.media="screen";var u=r.contentDocument.getElementsByTagName("head")[0];u.appendChild(l)},f.prototype._addCSSLink=function(t){var e=document.createElement("link");e.href=t,e.rel="stylesheet",e.type="text/css";var n=document.getElementsByTagName("head")[0];n.appendChild(e)},f.prototype.flushFontQueue=function(){if(0!==this._fontLoadQueue.length&&"rasterize"!=this.docManager.displayType){var t=this._fontLoadQueue;this._fontLoadQueue=[];var n=this.getFontAggregatorHostForFonts(t);switch(e){case a:this._addEOTRules(t,n);break;case c:j?this._addTTFRules(t,n):A?this._addCSSWebkit(t,n):this._addCSSLink(n);break;case l:this._addSVGRules(t,n)}this._flushCssRuleQueue()}},f.prototype.addFontToQueue=function(t){var e=this.fonts[t];e._loadQueued||(e._loadQueued=!0,this._fontLoadQueue.push(e))},f.prototype.addFont=function(t,e,n,i,r,o){var s=new p(t,e,n,i,r,o);this.fonts[t]=s},f.prototype.setNumFonts=function(t){for(var e=0;t>e;e++)this.fonts[e]=new p(e,"","ff"+e,"sans-serif","normal","normal")},f.prototype._initHidersCSS=function(){for(var t=[],e=0;e<this.fonts.length;e++)t.push("."+this.fonts[e].family);this._insertCssRule(t.join(", ")+" {display: none;}\n")},f.prototype._initFamilyCSS=function(){for(var t=0;t<this.fonts.length;t++){var e=this.fonts[t].family,n=this.fonts[t].fallback,i=this.fonts[t].weight,r=this.fonts[t].style,o="div."+e+" span";"undefined"!=typeof scribd&&"undefined"!=typeof scribd.embed_div_id&&(o="#"+scribd.embed_div_id+" "+o),this._insertCssRule($()?o+" {font-family: "+e+" !important;\n}":o+" {font-family: "+e+", "+n+"; font-weight: "+i+"; font-style: "+r+";\n}")}},f.prototype.initStyles=function(){if("rasterize"!=this.docManager.displayType){switch(this._initFamilyCSS(),e){case a:break;case c:j||this._initHidersCSS();break;case l:}this._flushCssRuleQueue("preload_styler")}},f.prototype.setupTestElements=function(){if(e==c&&!A&&"rasterize"!=this.docManager.displayType){for(var t="",n=0;n<this.fonts.length;n++){var i=this.fonts[n];t+=i.createPreloadElem()}var r=document.getElementById(E);r.innerHTML=t,document.body.appendChild(r),this._insertCssRule("#"+E+" span {display: block; visibility: hidden}"),this._flushCssRuleQueue()}},_.prototype.addPage=function(t){for(var e=0;e<t.fonts.length;e++){var n=t.fonts[e];void 0===this.fonts[n]&&(this.fonts[n]=!0,this.numFonts+=1)}this.pages.push(t)},_.prototype.isFull=function(){var t=this.pages.length,n=this.groupNum,r=this.numFonts;return e==a?this.hasLoaded||r>50||r>=20&&(0===n&&t>=i+3||t>=15):e==l||j?this.hasLoaded||r>=5&&t>=i:this.hasLoaded||r>100||r>=20&&(0===n&&t>=i+3||t>=100)},_.prototype.load=function(t){function e(){for(var t in n.fonts)n.fonts.hasOwnProperty(t)&&n.fontLoader.addFontToQueue(t);n.fontLoader.flushFontQueue()}if(!this.hasLoaded){this.hasLoaded=!0;var n=this;t?window.setTimeout(function(){e()},t):e()}},_.prototype.newNextGroup=function(){return new _(this.groupNum+1,this.fontLoader)};var O=1,N=2,I=3,z=4,L=function(){return void 0!==document.documentElement.style.WebkitTransform?O:void 0!==document.documentElement.style.MozTransform?N:void 0!==document.documentElement.style.OTransform?z:I}();g.prototype._defaultParams={containerElem:null,innerPageElem:null,contentUrl:null,origWidth:null,origHeight:null,fonts:null,docManager:null,pageNum:null},g.prototype._requiredParams=["origWidth","origHeight","fonts","docManager","containerElem","pageNum"],g.prototype._updateBoundingRect=function(){var t,e,n,i;if(this.containerElem.getBoundingClientRect&&this.docManager.viewportManager.viewRect){var r=this.containerElem.getBoundingClientRect(),o=this.docManager.viewportManager.viewRect;e=r.left+o.left,t=r.top+o.top,n=r.right-r.left,i=r.bottom-r.top,this.boundingRect={left:e,top:t,bottom:t+i,right:e+n,width:n,height:i}}else t=this.containerElem.offsetTop,e=this.containerElem.offsetLeft,n=this.containerElem.offsetWidth,i=this.containerElem.offsetHeight,this.boundingRect={left:e,top:t,bottom:t+i,right:e+n,width:n,height:i}},g.prototype._setContainerContents=function(t){var e=/<noscript *><img[^<>]*\/><\/noscript *>/g,n=document.createElement("div");n.innerHTML=t.replace(e,""),this.containerElem.appendChild(n);this.innerPageElem=this.containerElem.lastChild,this.turnOnLinks(),this.turnOnImages(),this.fixSVGFonts(),this.displayDirty=!0,this.displayOn?this.display():this.hide()},g.prototype.fixSVGFonts=function(){if(this._svgFontsFixed)throw"Already fixed the svg fonts";if(this.innerPageElem){if(D){var t=function(e){if(e.nodeType==document.TEXT_NODE){var n=e.textContent.search(/[  \n][^ \n ]/);n>=0&&t(e.splitText(n+1))}else for(var i=e.childNodes,r=0;r<i.length;r++)t(i[r])},e=function(t){for(var n=t.childNodes,i=0;i<n.length;i++){var r=n[i];if(r.nodeType==document.ELEMENT_NODE)e(r);else{var o=n[i+1];o&&"#text"==o.nodeName&&t.insertBefore(document.createElement("span"),o)}}};t(this.innerPageElem),e(this.innerPageElem)}this._svgFontsFixed=!0}},g.prototype.imagePageContent=function(t){return str="<img src='"+t+"'></img>"},g.prototype.load=function(){if(this.currentlyLoading=!0,this.loadHasStarted=!0,this.innerPageElem)throw"We already have loaded this page, but it looks like you called loadPage again";this.loadFonts();var e="page"+this.pageNum+"_callback";if(window[e])try{delete window[e]}catch(n){window[e]=void 0}if("rasterize"==this.docManager.displayType)return delete this.currentlyLoading,void this._setContainerContents(this.imagePageContent(this.contentUrl));var i=document.createElement("script"),r=this;window[e]=function(n){document.body.removeChild(i);var o=n[0];delete r.currentlyLoading,r._setContainerContents(o),"undefined"!=typeof t&&t("#"+r.containerElem.id).hasClass("blurred_page")&&r.docManager.doDynamicBlurring(r.containerElem.id),r.docManager.fireEvent("pageLoaded",r.containerElem);try{delete window[e]}catch(s){window[e]=void 0}},i.src=this.contentUrl,i.type="text/javascript",i.charset="UTF-8",document.body.appendChild(i)},g.prototype.remove=function(){if(this.innerPageElem){var t=this.innerPageElem.parentNode;t.removeChild(this.innerPageElem),delete this.innerPageElem,delete this.currentLoading,delete this.loadHasStarted,this._linksTurnedOn=!1,this._imagesTurnedOn=!1,this._svgFontsFixed=!1}},g.prototype.display=function(t,e){if((!this.displayOn||this.displayDirty)&&(this.displayOn=!0,!this.currentlyLoading)){if(!this.innerPageElem)return this.loadHasStarted?void 0:t?void this.load():void 0;this.displayDirty=!1,e||(this._linksTurnedOn||this.turnOnLinks(),this._imagesTurnedOn||this.turnOnImages(),this._svgFontsFixed||this.fixSVGFonts()),this.loadFonts(),this._innerPageVisible||(this.containerElem.className=this.containerElem.className.replace(/placeholder|not_visible/g,""),this._innerPageVisible=!0,e||(this._fitContentsToWidth(),this.innerPageElem.style.display="block"))}},g.prototype.hide=function(){(this.displayOn||this.displayDirty)&&(this.displayOn=!1,this.innerPageElem&&(this.displayDirty=!1,this.containerElem.className=this.containerElem.className+" not_visible",this._innerPageVisible=!1,this.innerPageElem.style.display="none"))},g.prototype.setLoadFontGroup=function(t){t.addPage(this),this.loadFontGroup=t},g.prototype.loadFonts=function(){this.loadFontGroup.load()};var F=!!(document.all&&/msie 6./i.test(navigator.appVersion)&&window.ActiveXObject);return g.prototype._setZoomScale=function(t){var e=this.innerPageElem;switch(L){case O:e.style.WebkitTransform="scale("+t+")",e.style.WebkitTransformOrigin="top left";break;case N:e.style.MozTransform="scale("+t+")",e.style.MozTransformOrigin="top left";break;case z:e.style.OTransform="scale("+t+")",e.style.OTransformOrigin="top left";break;case I:if(e.originalZoom||(e.originalZoom="normal"==e.currentStyle.zoom?1:parseFloat(e.currentStyle.zoom)/100,F&&!this.docManager._isEmbed&&(e.originalZoom*=1.35)),e.style.zoom=e.originalZoom*t*100+"%",F){var n=this.innerPageElem;setTimeout(function(){n.style.marginLeft=""===n.style.marginLeft?0:""},500)}break;default:throw"Unknown scale method "+L}},g.prototype._fitContentsToWidth=function(){if(this._targetWidth&&this.innerPageElem&&this._innerPageVisible){var t=this._targetWidth/this.origWidth;this._setZoomScale(t),this._targetWidth=null}},g.prototype.setWidth=function(t){var e=Math.ceil(t/this.origWidth*this.origHeight);this.containerElem.style.width=t+"px",this.containerElem.style.height=e+"px",this._targetWidth=t,this._fitContentsToWidth()},g.prototype.setBounds=function(t,e){this.origWidth/this.origHeight>t/e?e=Math.ceil(t/this.origWidth*this.origHeight):t=Math.ceil(e/this.origHeight*this.origWidth),this.containerElem.style.width=t+"px",this.containerElem.style.height=e+"px",this._targetWidth=t,this._fitContentsToWidth()},g.prototype.turnOnImages=function(){if(!this.innerPageElem)throw"Can't turn on images for a page that's not loaded";if(this._imagesTurnedOn)throw"Images have already been turned on for this document";this._imagesTurnedOn=!0;for(var t=this.innerPageElem.getElementsByTagName("img"),e=0;e<t.length;e++){var n=t[e];if(n.className.toLowerCase().search("absimg")>-1&&!n.src){var i=this.docManager.subImageSrc(n.getAttribute("orig"));this.docManager.enablePNGHack?(n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"', sizingMethod='scale')",n.src=r):n.src=i,n.removeAttribute("orig"),n.style.display="block"}}},g.prototype.turnOnLinks=function(){if(!this.innerPageElem)throw"Can't turn on links for a page that's not loaded";if(this._linksTurnedOn)throw"Links have already been turned on for this document";this._linksTurnedOn=!0;for(var t=this.docManager,e=function(e){return function(){t.gotoPage(e.substring(4))}},n=this.innerPageElem.getElementsByTagName("a"),i=0;i<n.length;i++){var r=n[i];if(r.className.toLowerCase().search("ll")>-1&&!r.href){var o=r.getAttribute("orig");if(o){var s=T.decode(o).replace(/^j[\W]*a[\W]*v[\W]*a[\W]*s[\W]*c[\W]*r[\W]*i[\W]*p[\W]*t[\W]*:|^f[\W]*i[\W]*l[\W]*e[\W]*:/gi,"");s.search(/^page/)>-1?r.onclick=e(s):(s.search(/^mailto:/)>=0||s.search(/^(http|ftp)/)<0&&(s="http://"+s),r.target="_blank",P(r,s),r.rel="nofollow")}}}},h(m,["vertical","horizontal","either","resize"]),m.prototype._makeViewRect=function(){var t=document.documentElement,e=window.scrollY||window.pageYOffset||t.scrollTop,n=window.scrollX||window.pageXOffset||t.scrollLeft,i=window.innerWidth||t.clientWidth,r=window.innerHeight||t.clientHeight,o=n+i,s=e+r;return{top:e,left:n,right:o,bottom:s,width:i,height:r}},m.prototype._updateViewRect=function(){var t=this.viewRect;this.viewRect=this._makeViewRect();var e=!t||t.left!=this.viewRect.left||t.width!=this.viewRect.width,n=!t||t.top!=this.viewRect.top||t.height!=this.viewRect.height;return{xChanged:e,yChanged:n}},m.prototype._eventHandler=function(t){var e=this._updateViewRect();"resize"!=t&&"both"!=t||!e.xChanged&&!e.yChanged||this.fireEvent("resize",this.viewRect),(e.xChanged||e.yChanged)&&this.fireEvent("either",this.viewRect),e.xChanged&&this.fireEvent("horizontal",this.viewRect),e.yChanged&&this.fireEvent("vertical",this.viewRect)},m.prototype.enable=function(){if(this.enabled)throw"ViewportManager has already been enabled";this.enabled=!0,this.container=window,this._eventHandler("both"),window.addEventListener?(window.addEventListener("resize",this._resizeCallback,!1),window.document.addEventListener("scroll",this._scrollCallback,!1)):window.attachEvent&&(window.attachEvent("onresize",this._resizeCallback),window.attachEvent("onscroll",this._scrollCallback))},m.prototype.disable=function(){if(!this.enabled)throw"ViewportManager has already been disabled";this.enabled=!1,this.container.removeEventListener?(window.removeEventListener("resize",this._resizeCallback,!1),this.container.removeEventListener("scroll",this._scrollCallback,!1)):window.detatchEvent&&(window.detatchEvent("onresize",this._resizeCallback),this.container.detatchEvent("onscroll",this._scrollCallback))},v.prototype.name=function(){return this._name},v.prototype.register=function(t,e){if(this.registered)throw"This ViewManager is already registered";this.registered=!0,this.documentManager=t,this.viewportManager=e,this._currentPageWidth=defaultViewWidth,this._currentZoomMultiplier=1,this._updatePageWidths();var n=this.documentManager.firstVisiblePage;this._register(t,e),n&&this.documentManager.gotoPage(n.pageNum,{pretty:!1}),t.view_manager_deferred&&t.view_manager_deferred.resolve(t)},v.prototype._zoomedPageWidth=function(){return this._currentPageWidth*this._currentZoomMultiplier},v.prototype._updatePageWidths=function(){this.documentManager.setPageWidths(this._zoomedPageWidth())},v.prototype.isTopPageInView=function(){return!0},v.prototype._register=function(){},v.prototype.unregister=function(){if(!this.registered)throw"This ViewManager is already unregistered";this.isFullscreen&&this.exitFullscreen(),this._checkBodyWidth(),this._unregister(),this.registered=!1,delete this.documentManager,delete this.viewportManager},v.prototype._unregister=function(){},v.prototype._pagingStep=function(){return 1},v.prototype.gotoPage=function(t,e){if(!this.registered)throw"ViewManager must be registerd to call gotoPage";this._gotoPage(t,e)},v.prototype._gotoPage=function(){},v.prototype._fireHideExtras=function(){this.documentManager._fireHideExtras(),this._extrasHidden=!0},v.prototype._fireShowExtras=function(){this.documentManager._fireShowExtras(),this._extrasHidden=!1},v.prototype.enterFullscreen=function(){if(this.isFullscreen)throw"Fullscreen is already set";this._checkBodyWidth(),this.viewportManager.addEvent("resize",this._fullscreenResizedCallback),this._fireHideExtras(),this.resetZoom(),this._enterFullscreen(),this._fullscreenResized(this.viewportManager.viewRect),this._currentPageWidth=this.viewportManager.viewRect.width,this.isFullscreen=!0;var t=this.documentManager.firstVisiblePage;t&&this.documentManager.gotoPage(t.pageNum,{pretty:!1}),this.documentManager._fireEnteredFullscreen()},v.prototype.exitFullscreen=function(){if(!this.isFullscreen)throw"Fullscreen is not set";this.viewportManager.removeEvent("resize",this._fullscreenResizedCallback),this._fireShowExtras(),this.resetZoom(),this._exitFullscreen(),this.isFullscreen=!1;var t=this.documentManager.firstVisiblePage;t&&this.documentManager.gotoPage(t.pageNum,{pretty:!1}),this.documentManager._fireExitedFullscreen()},v.prototype._viewBarWidth=function(){return this._extrasHidden?0:this.documentManager.options.extrasWidth},v.prototype._enterFullscreen=function(){},v.prototype._exitFullscreen=function(){},v.prototype._fullscreenResized=function(){},v.prototype._scrollWithZoom=function(t,e){window.scrollTo(0,t.top*e)},v.prototype.zoom=function(t){var e=this.viewportManager.viewRect;e&&(this._currentZoomMultiplier*=t,this._checkBodyWidth(),this._updatePageWidths(),this.documentManager.setIsScrolling(!0),this._scrollWithZoom(e,t),this._zoomed(),this.documentManager.setIsScrolling(!1),this.documentManager._fireZoomed(t))},v.prototype._zoomed=function(){},v.prototype.resetZoom=function(){this._currentZoomMultiplier=1,this._checkBodyWidth(),this._updatePageWidths(),this._zoomed()},v.prototype._checkBodyWidth=function(){var t=document.documentElement.clientWidth,e=this._zoomedPageWidth()+this._viewBarWidth()+10;globalHeader=document.getElementById("global_header"),e>t?(document.body.style.width=e+"px",globalHeader&&(globalHeader.style.width=t+"px")):(document.body.style.width="100%",globalHeader&&(globalHeader.style.width="100%"))},y.prototype=new v,y.prototype._register=function(){this._prepareDisplay()},y.prototype._unregister=function(){for(var e in this.documentManager.pages)if(this.documentManager.pages.hasOwnProperty(e)){var n=this.documentManager.pages[e];t(n.containerElem).removeClass("book_view"),n.containerElem.style.display=""}},y.prototype._prepareDisplay=function(){for(var e in this.documentManager.pages)if(this.documentManager.pages.hasOwnProperty(e)){var n=this.documentManager.pages[e];t(n.containerElem).addClass("book_view"),n.containerElem.style.display="none",n.hide()}this.documentManager.setPageMissingModulesVisible(!1),this.documentManager.gotoPage(this.documentManager.currentPageNum()||1)},y.prototype._zoomed=function(){this.documentManager.pages[this.currentPageId]},y.prototype._updatePageWidths=function(){this.documentManager.setPageWidths(this._zoomedPageWidth()/2)},y.prototype._pagingStep=function(){return 2},y.prototype._showPage=function(t){var e=this.documentManager.pages[t];e&&(e.isVisible=!0,e.display(!0),e.containerElem.style.display="")},y.prototype._hidePage=function(t){var e=this.documentManager.pages[t];e&&(e.isVisible=!1,e.containerElem.style.display="none",e.hide())},y.prototype._gotoPage=function(t){t=parseInt(t,10),t%2==1&&(t-=1);var e=null,n=null;"number"==typeof this.currentPageId&&(this._hidePage(this.currentPageId),this._hidePage(this.currentPageId+1)),e=this.documentManager.pages[t],n=this.documentManager.pages[t+1],(e||n)&&(this.currentPageId=t,this.isFullscreen&&this._setPageBounds(this.viewportManager.viewRect),this._showPage(t),this._showPage(t+1),this.documentManager.visiblePagesChanged())},y.prototype._setWidth=function(t){this._currentPageWidth=t,this.documentManager.setPageWidths(t)},y.prototype._fullscreenResized=function(t){this._setWidth(t.width-o)},y.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentPageWidth||defaultViewWidth,b(this.documentManager.pages[this.currentPageId].containerElem,300)},y.prototype._exitFullscreen=function(){this._setWidth(defaultViewWidth),this._checkBodyWidth()},w.prototype=new v,w.prototype._register=function(){this._prepareDisplay();var t=document.getElementById("scroll_preventer");t&&(t.style.overflow="hidden",t.style.height="100%")},w.prototype._unregister=function(){var t=document.getElementById("scroll_preventer");t&&(t.style.overflow="visible",t.style.height="auto")},w.prototype._prepareDisplay=function(){for(var t in this.documentManager.pages)if(this.documentManager.pages.hasOwnProperty(t)){var e=this.documentManager.pages[t];e.containerElem.style.display="none",e.hide()}this.documentManager.setPageMissingModulesVisible(!1),this.documentManager.gotoPage(this.documentManager.currentPageNum()||1)},w.prototype._setPageBounds=function(t){var e=this.documentManager.pages[this.currentPageId];e&&e.setBounds(t.width,t.height)},w.prototype._gotoPage=function(t){if(this.documentManager.pages.hasOwnProperty(t)){var e;this.currentPageId&&(e=this.documentManager.pages[this.currentPageId],e&&(e.isVisible=!1,e.containerElem.style.display="none",e.hide())),this.currentPageId=t,e=this.documentManager.pages[t],this.isFullscreen&&this._setPageBounds(this.viewportManager.viewRect),e.isVisible=!0,e.display(!0),e.containerElem.style.display="",e._updateBoundingRect(),this.documentManager.visiblePagesChanged()}},w.prototype._setWidth=function(t){this._currentPageWidth=t,this.documentManager.setPageWidths(t)},w.prototype._fullscreenResized=function(t){this._setPageBounds(t)},w.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentPageWidth||defaultViewWidth,b(this.documentManager.pages[this.currentPageId].containerElem,300)},w.prototype._exitFullscreen=function(){this._setWidth(defaultViewWidth),this._checkBodyWidth()},k.prototype=new v,k.prototype._updateInViewport=function(t){var e=this.viewportManager.viewRect,n=t.boundingRect,i=t.isVisible;return t.isVisible=e&&n?n.left<e.right&&n.right>e.left&&n.top<e.bottom&&n.bottom>e.top:!1,this.adjacentVisiblePages=2,i!=t.isVisible},k.prototype.checkAndUpdateVisiblePages=function(){var t=!1;for(var e in this.pages)if(this.pages.hasOwnProperty(e)){var n=this.pages[e],i=this._updateInViewport(n);t=t||i}t?this.documentManager.visiblePagesChanged():this.documentManager.scheduleLogPageView(),this._updateDisplayOnPages()},k.prototype._updateDisplayOnPages=function(){if(this.documentManager.firstVisiblePage&&this.documentManager.lastVisiblePage){var t=this.documentManager.firstVisiblePage.pageNum-this.adjacentVisiblePages,e=this.documentManager.lastVisiblePage.pageNum+this.adjacentVisiblePages;for(var n in this.pages)if(this.pages.hasOwnProperty(n)){var i=this.pages[n];i&&(i.pageNum>=t&&i.pageNum<=e?i.display():(i.hide(),this.documentManager.fireEvent("pageHide",i)))}}},k.prototype._zoomed=function(){this.checkAndUpdateVisiblePages()},k.prototype._register=function(t){this.pages=t.pages,this.viewportManager.addEvent("vertical",this._verticalPositionChangeCallback);for(var e in this.pages)if(this.pages.hasOwnProperty(e)){var n=this.documentManager.pages[e];n.containerElem.style.display=""}this.documentManager.setPageMissingModulesVisible(!0),this.documentManager._updatePageBoundingRects(),this.checkAndUpdateVisiblePages()},k.prototype.isTopPageInView=function(){var t=this.documentManager.firstVisiblePage;return t?this.documentManager._expectedFirstPageNum>t.pageNum?!0:t.boundingRect.top+5>=this.viewportManager.viewRect.top:!0},k.prototype._unregister=function(){this.viewportManager.removeEvent("vertical",this._verticalPositionChangeCallback),delete this.pages},k.prototype._gotoPage=function(e,n){if("undefined"==typeof t&&"undefined"!=typeof scribd&&x.setJQuery(scribd.jQuery),this.pages.hasOwnProperty(e)){var i=this.documentManager.pages[e];this.documentManager.setIsScrolling(!0);var r="undefined"!=typeof t&&"undefined"!=typeof t.scrollTo;if(n.pretty&&r){var o=i.boundingRect;if(n.frac){var s=i.boundingRect.top+Math.floor(i.boundingRect.height*n.frac);o=t.extend({},i.boundingRect,{top:s})}n.offset&&(o.top-=n.offset),t.scrollTo(o,{duration:600,onAfter:this._afterGotoPage})}else i._updateBoundingRect(),scrollTo(i.boundingRect.left,i.boundingRect.top-(n.offset||0)),this._afterGotoPage();return i.pageNum}},k.prototype._gotoNextPage=function(){this.documentManager.firstVisiblePage&&this.documentManager.gotoPage(this.documentManager.firstVisiblePage.pageNum+1,{direction:1})},k.prototype._gotoPreviousPage=function(){this.documentManager.firstVisiblePage&&this.documentManager.gotoPage(this.documentManager.firstVisiblePage.pageNum-1,{direction:-1})},k.prototype._setWidth=function(t){var e=this.pagePosition();this._currentPageWidth=t,this._updatePageWidths(),this._checkBodyWidth(),this.restorePosition(e)},k.prototype._fullscreenResized=function(){this._setWidth((window.innerWidth||document.documentElement.clientWidth)-o)},k.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentWidth||defaultViewWidth},k.prototype._exitFullscreen=function(){this._setWidth(this._previousPageWidth)},k.prototype.pagePosition=function(){var e=this.documentManager.currentPageNum()||1,n=t("#outer_page_"+e),i=0;return n.length&&(i=(t(window).scrollTop()-n.offset().top)/n.height()),[e,i]},k.prototype.restorePosition=function(e){var n=t(this.pages[e[0]].containerElem);this._gotoPage(e[0],{offset:-Math.floor(e[1]*n.height())})},k.prototype.zoom=function(t){var e=this.viewportManager.viewRect;if(e){var n=this.pagePosition();this._currentZoomMultiplier*=t,this._checkBodyWidth(),this._updatePageWidths(),this.restorePosition(n),this._zoomed(),this.documentManager._fireZoomed(t)}},h(x,["expectedFirstPageChanged","viewmodeChanged","enteredFullscreen","exitedFullscreen","hideExtras","showExtras","zoomed","pageHide","pageLoaded","allPagesAdded","pageView","viewmodeInitialized"]),x.prototype._fireZoomed=function(t){this.fireEvent("zoomed",t)},x.prototype.nextFontAggregatorHost=function(){return this._currentFontAggregatorHostIdx=(this._currentFontAggregatorHostIdx+1)%this.fontAggregatorHosts.length,this.fontAggregatorHosts[this._currentFontAggregatorHostIdx]},x.prototype._fireHideExtras=function(){this.fireEvent("hideExtras")},x.prototype._fireShowExtras=function(){this.fireEvent("showExtras")},x.prototype.currentPageNum=function(){return this._expectedFirstPageNum},x.prototype.setupTestElements=function(){this._fontLoader.setupTestElements()},x.prototype.pageCount=function(){if(this.hasOwnProperty("_pageCount"))return this._pageCount;var t=0;for(var e in this.pages)this.pages.hasOwnProperty(e)&&t++;return this._pageCount=t,this._pageCount},x.prototype.setupPaidDocument=function(t,e){this.allowedPages=t,this.originalPageCount=e,this._allowedPagesHash=[],this._maximumAllowedPage=Math.max.apply(null,this.allowedPages),this._minimumAllowedPage=Math.min.apply(null,this.allowedPages),this._isPaidDocument=!0,this._pageMissingElements=[];for(var n=0;n<t.length;n++)this._allowedPagesHash[t[n]]=!0,(n>0&&t[n]>t[n-1]+1||0===n&&1!=t[n])&&this._pageMissingElements.push("page_missing_explanation_"+t[n].toString());
this._maximumAllowedPage!=this.originalPageCount&&this._pageMissingElements.push("page_missing_explanation_"+(this.originalPageCount+1).toString())},x.prototype.minimumPageNumber=function(){return"book"==this.viewMode()?0:1},x.prototype.maximumPageNumber=function(){return this.allowedPages?this.originalPageCount:this.pageCount()},x.prototype.getClosestPageNumber=function(t,e){if(!this.allowedPages)return t;if(this._allowedPagesHash[t])return t;if(t>=this._maximumAllowedPage)return this._maximumAllowedPage;if(t<=this._minimumAllowedPage)return this._minimumAllowedPage;for(var n=1;n<=this.originalPageCount;n++){if(0>=e&&this._allowedPagesHash[t-n]===!0)return t-n;if(e>=0&&t+n<this.originalPageCount&&this._allowedPagesHash[t+n]===!0)return t+n}},x.prototype.setPageMissingModulesVisible=function(e){if("undefined"==typeof t&&"undefined"!=typeof scribd&&x.setJQuery(scribd.jQuery),this._isPaidDocument)for(var n=0;n<this._pageMissingElements.length;n++){var i=t(this._pageMissingElements[n]);i&&(e?i.show():i.hide())}},x.prototype.getNextAvailablePage=function(t){return getClosestPageNumber(t,1)},x.prototype.getPreviousAvailablePage=function(t){return getClosestPageNumber(t,-1)},x.prototype.flushFontQueue=function(){this._fontLoader.flushFontQueue()},x.prototype.visiblePagesChanged=function(){var t=[];for(var e in this.pages)if(this.pages.hasOwnProperty(e)){var n=this.pages[e];n.isVisible&&t.push(n)}if(t.length){t.sort(function(t,e){return t.pageNum<e.pageNum?-1:1}),this.visiblePages=t;var i=this.firstVisiblePage;this.firstVisiblePage=t.length>0?t[0]:null,this.lastVisiblePage=t.length>0?t[t.length-1]:null,this.isScrolling||(this._loadAdjacentFonts(),this._loadAdjacentPages()),(this.firstVisiblePage===i||this.firstVisiblePage&&i)&&this.firstVisiblePage.pageNum==i.pageNum||!this.isScrolling&&this.firstVisiblePage&&this._updateExpectedFirstPage(this.firstVisiblePage.pageNum),this.scheduleLogPageView()}},x.prototype.boundingRatioForPage=function(t){var e=this.viewportManager.viewRect,n=t.boundingRect,i=n.bottom-n.top,r=n.right-n.left;return{left:(e.left-n.left)/r,right:(e.right-n.right)/r+1,top:S((e.top-n.top)/i+t.pageNum,t.pageNum,t.pageNum+1),bottom:S((e.bottom-n.bottom)/i+t.pageNum+1,t.pageNum,t.pageNum+1)}},x.prototype.scheduleLogPageView=function(){this.logPageViewTimout&&window.clearTimeout(this.logPageViewTimout);var t=this;this.logPageViewTimout=window.setTimeout(function(){t.logPageView(),t.logPageViewTimout=null},1e3)},x.prototype.getVisibleBBox=function(){var t={};if(this.firstVisiblePage){var e=this.boundingRatioForPage(this.firstVisiblePage);t.left=e.left,t.right=e.right,t.top=e.top}if(this.lastVisiblePage){var n=this.boundingRatioForPage(this.lastVisiblePage);t.bottom=n.bottom}return t},x.prototype.logPageView=function(){var t=this.getVisibleBBox();for(var e in t)t.hasOwnProperty(e)&&(t[e]=C(t[e]));var n=window.$rat;if(n){var i;i="2"==window.RAT_API_VERSION?[[t.left,t.top],[t.right,t.bottom]]:"("+t.left+" "+t.top+") ("+t.right+" "+t.bottom+")",n("fourgen.viewchange",i)}return this.fireEvent("pageView"),t},x.prototype._updateExpectedFirstPage=function(t){this._expectedFirstPageNum=t,this.fireEvent("expectedFirstPageChanged",this._expectedFirstPageNum)},x.prototype._loadAdjacentFonts=function(){if(this.firstVisiblePage&&this.lastVisiblePage)for(var t=this.firstVisiblePage.pageNum-i,e=this.lastVisiblePage.pageNum+i,n=t;e>=n;n++){var r=this.pages[n];r&&r.loadFonts()}},x.prototype._loadAdjacentPages=function(){if(this.firstVisiblePage&&this.lastVisiblePage){for(var t=this.firstVisiblePage.pageNum-n,e=this.lastVisiblePage.pageNum+n,i=t;e>=i;i++){var r=this.pages[i];r&&!r.loadHasStarted&&(r.load(),this.mobile&&r.setWidth(this._pageWidths))}this.mobile&&this._removeUnusedPages()}},x.prototype._removeUnusedPages=function(){for(var t=this.firstVisiblePage.pageNum-n,e=this.lastVisiblePage.pageNum+n,i=this.pages,r=n+1;i[r];)(t>r||r>e)&&i[r].remove(),r++},x.prototype._updatePageBoundingRects=function(){for(var t in this.pages)this.pages.hasOwnProperty(t)&&this.pages[t]._updateBoundingRect()},x.prototype.removeInsteadOfBlurring=function(){return/iPhone|iPod|iPad|Android|BlackBerry/.test(navigator.userAgent)?!0:"undefined"==typeof Scribd||"undefined"==typeof t?!0:!1},x.prototype.addPage=function(t){if(!t.blur||!this.removeInsteadOfBlurring()){if(void 0===t.pageNum)throw"must have pageNum param";t.docManager=this;var e=new g(t);return this.pages[t.pageNum]=e,this._pageWidths&&e.setWidth(this._pageWidths),this.currentFontGroup.isFull()&&(this.currentFontGroup=this.currentFontGroup.newNextGroup()),e.setLoadFontGroup(this.currentFontGroup),e}t.containerElem.parentNode.removeChild(t.containerElem)},x.prototype.setIsScrolling=function(t){t?this._scrollingCount+=1:this._scrollingCount-=1,this._scrollingCount<0&&(this._scrollingCount=0),this.isScrolling=0===this._scrollingCount?!1:!0},x.prototype.setViewManager=function(t,e){if(this._currentViewManager)this._setViewManager(t),"function"==typeof e&&e();else{var n=this;this.addEvent("viewmodeInitialized",function(){n.setViewManager(t,e)})}},x.prototype._setViewManager=function(t,e){e||this._currentViewManager.unregister();var n=this._currentViewManager;this._currentViewManager=this.viewManagers[t],this._currentViewManager.register(this,this.viewportManager),this.fireEvent("viewmodeChanged",this.viewMode(),n?n.name():null)},x.prototype.setInitialViewManager=function(t){if(this._currentViewManager)throw"This should be called before any view manager exists";this._setViewManager(t,!0),this.fireEvent("viewmodeInitialized",this.viewMode(),null)},x.prototype.setDefaultWidth=function(t){this._currentViewManager._currentPageWidth=t,this._currentViewManager._currentZoomMultiplier=1,this._currentViewManager._updatePageWidths()},x.prototype.subImageSrc=function(t){var e,n=0;for(e=0;e<t.length;e++)n+=t.charCodeAt(e);var i=this._imageDomainSubstitutionList[n%this._imageDomainSubstitutionList.length];return t.replace(this._imageDomainSubstitutionFrom,i)},x.prototype.allPagesAdded=function(){if(this._allPagesAddedCalled)throw"can only call allPagesAdded once";this.viewportManager.enable(),this._updatePageBoundingRects(),this.setInitialViewManager(this.defaultViewMode),this.fireEvent("allPagesAdded")},x.prototype.setEmbeddedDoc=function(t){this._isEmbed="True"===t},x.prototype.setPageWidths=function(t){this._pageWidths=t;for(var e in this.pages)this.pages.hasOwnProperty(e)&&this.pages[e].setWidth(this._pageWidths);this._updatePageBoundingRects()},x.prototype.addFont=function(t,e,n,i,r,o){this._fontLoader.addFont(t,e,n,i,r,o)},x.prototype.setNumFonts=function(t){this._fontLoader.setNumFonts(t)},x.prototype.initStyles=function(){this._fontLoader.initStyles()},x.prototype.gotoPage=function(t,e){var n=!M(t),i=null;if(n&&(i=+(t%1).toFixed(2),t=Math.floor(t)),!(t<this.minimumPageNumber()||t>this.maximumPageNumber())){e||(e={}),void 0===e.pretty&&(e.pretty=!0),n&&void 0==e.frac&&(e.frac=i);var r=e.direction||0,o=this.pages[t];void 0===o&&this._isPaidDocument&&(t=this.getClosestPageNumber(t,r),o=this.pages[t]),this.mobile&&this.pages[t]&&this.pages[t].setWidth(this._pageWidths),this._updateExpectedFirstPage(t),this._currentViewManager.gotoPage(this._expectedFirstPageNum,e)}},x.prototype.gotoPreviousPage=function(){var t=this._currentViewManager._pagingStep();this._currentViewManager.isTopPageInView()?this.gotoPage(this._expectedFirstPageNum-t,{direction:-1}):this.gotoPage(this._expectedFirstPageNum,{direction:-1})},x.prototype.gotoNextPage=function(){var t=this._currentViewManager._pagingStep();this.gotoPage(this._expectedFirstPageNum+t,{direction:1})},x.prototype.enterFullscreen=function(){this._currentViewManager.enterFullscreen()},x.prototype.exitFullscreen=function(){this._currentViewManager.exitFullscreen()},x.prototype.isFullscreen=function(){return this._currentViewManager.isFullscreen},x.prototype._fireEnteredFullscreen=function(){this.fireEvent("enteredFullscreen")},x.prototype._fireExitedFullscreen=function(){this.fireEvent("exitedFullscreen")},x.prototype.viewMode=function(){return this._currentViewManager?this._currentViewManager.name():null},x.prototype.zoom=function(t){this._currentViewManager.zoom(t)},x.prototype.resetZoom=function(){this._currentViewManager.resetZoom()},x.prototype.setImageDomainSubstitution=function(t,e){this._imageDomainSubstitutionFrom=t,this._imageDomainSubstitutionList=e},x.prototype.disableViewManagerResizeWidth=function(){v.prototype._checkBodyWidth=function(){}},x.prototype.disable=function(){this.disabled||(this.disabled=!0,this.viewportManager.disable())},x.prototype.doDynamicBlurring=function(e){var n,i,r;this.removeInsteadOfBlurring()||(n=t("#"+e),n.on("dragstart, selectstart, contextmenu",function(t){t.preventDefault()}),n.find("*").andSelf().attr("unselectable","on"),r=Modernizr&&Modernizr.textshadow&&t.browser&&(t.browser.webkit&&!t.browser.safari||t.browser.mozilla||t.browser.opera)&&!(t.browser.mozilla===!0&&parseFloat(t.browser.version)<4&&parseFloat(t.browser.version)>=3),t.browser||console.log("Hi there, it seems as though you've upgraded jQuery and browser detection is no longer working in 4gen.js"),t(document).ready(function(){i=t("#grab_blur_promo_here").contents().clone().appendTo("#"+e).css("zIndex",8).show(),i.find(".gap").html("Page "+e.split("_").pop()+" is not shown in this preview."),r||i.find(".page-blur-promo-overlay").height("100%").width("100%").css("zIndex",7).show()}),r&&(n.find(".text_layer").css({color:"transparent","text-shadow":"0px 0px 70px black"}),n.find(".image_layer img").each(function(){var e=this;t(e).imagesLoaded(function(){e.height>250&&e.width>250&&t(e).css({opacity:.04})})})))},x.setJQuery=function(e){t=e},x.ScrollViewManager=k,x.SlideViewManager=w,x.BookViewManager=y,x}();window.DocumentManager=d},void 0===window.DocumentManager&&init_4gen();


/* public/javascripts/jquery.mousewheel.js @ 1425075658 */
/*! Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.1.3
 *
 * Requires: 1.2.2+
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var r,o=e||window.event,s=[].slice.call(arguments,1),a=0,c=0,l=0,u=0,d=0;return e=t.event.fix(o),e.type="mousewheel",o.wheelDelta&&(a=o.wheelDelta),o.detail&&(a=-1*o.detail),o.deltaY&&(l=-1*o.deltaY,a=l),o.deltaX&&(c=o.deltaX,a=-1*c),void 0!==o.wheelDeltaY&&(l=o.wheelDeltaY),void 0!==o.wheelDeltaX&&(c=-1*o.wheelDeltaX),u=Math.abs(a),(!n||n>u)&&(n=u),d=Math.max(Math.abs(l),Math.abs(c)),(!i||i>d)&&(i=d),r=a>0?"floor":"ceil",a=Math[r](a/n),c=Math[r](c/i),l=Math[r](l/i),s.unshift(e,a,c,l),(t.event.dispatch||t.event.handle).apply(this,s)}var n,i,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(t.event.fixHooks)for(var s=r.length;s;)t.event.fixHooks[r[--s]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=o.length;t;)this.addEventListener(o[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=o.length;t;)this.removeEventListener(o[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})});


/* public/javascripts/jquery.nanoscroller.js @ 1425075658 */
/*! nanoScrollerJS - v0.7.2
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2013 James Florentino; Licensed MIT */
!function(t,e,n){"use strict";var i,r,o,s,a,c,l,u,d,h,p,f,_,g,m,v,b,y,w,k,x;k={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null},v="scrollbar",m="scroll",u="mousedown",d="mousemove",p="mousewheel",h="mouseup",g="resize",a="drag",y="up",_="panedown",o="DOMMouseScroll",s="down",w="wheel",c="keydown",l="keyup",b="touchmove",i="Microsoft Internet Explorer"===e.navigator.appName&&/msie 7./i.test(e.navigator.appVersion)&&e.ActiveXObject,r=null,x=function(){var t,e,i;return t=n.createElement("div"),e=t.style,e.position="absolute",e.width="100px",e.height="100px",e.overflow=m,e.top="-9999px",n.body.appendChild(t),i=t.offsetWidth-t.clientWidth,n.body.removeChild(t),i},f=function(){function c(i,o){this.el=i,this.options=o,r||(r=x()),this.$el=t(this.el),this.doc=t(n),this.win=t(e),this.$content=this.$el.children("."+o.contentClass),this.$content.attr("tabindex",0),this.content=this.$content[0],this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return c.prototype.preventScrolling=function(t,e){if(this.isActive)if(t.type===o)(e===s&&t.originalEvent.detail>0||e===y&&t.originalEvent.detail<0)&&t.preventDefault();else if(t.type===p){if(!t.originalEvent||!t.originalEvent.wheelDelta)return;(e===s&&t.originalEvent.wheelDelta<0||e===y&&t.originalEvent.wheelDelta>0)&&t.preventDefault()}},c.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},c.prototype.updateScrollValues=function(){var t;t=this.content,this.maxScrollTop=t.scrollHeight-t.clientHeight,this.contentScrollTop=t.scrollTop,this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},c.prototype.createEvents=function(){var t=this;this.events={down:function(e){return t.isBeingDragged=!0,t.offsetY=e.pageY-t.slider.offset().top,t.pane.addClass("active"),t.doc.bind(d,t.events[a]).bind(h,t.events[y]),!1},drag:function(e){return t.sliderY=e.pageY-t.$el.offset().top-t.offsetY,t.scroll(),t.updateScrollValues(),t.contentScrollTop>=t.maxScrollTop?t.$el.trigger("scrollend"):0===t.contentScrollTop&&t.$el.trigger("scrolltop"),!1},up:function(){return t.isBeingDragged=!1,t.pane.removeClass("active"),t.doc.unbind(d,t.events[a]).unbind(h,t.events[y]),!1},resize:function(){t.reset()},panedown:function(e){return t.sliderY=(e.offsetY||e.originalEvent.layerY)-.5*t.sliderHeight,t.scroll(),t.events.down(e),!1},scroll:function(e){t.isBeingDragged||(t.updateScrollValues(),t.iOSNativeScrolling||(t.sliderY=t.sliderTop,t.slider.css({top:t.sliderTop})),null!=e&&(t.contentScrollTop>=t.maxScrollTop?(t.options.preventPageScrolling&&t.preventScrolling(e,s),t.$el.trigger("scrollend")):0===t.contentScrollTop&&(t.options.preventPageScrolling&&t.preventScrolling(e,y),t.$el.trigger("scrolltop"))))},wheel:function(e){return null!=e?(t.sliderY+=-e.wheelDeltaY||-e.delta,t.scroll(),!1):void 0}}},c.prototype.addEvents=function(){var t;this.removeEvents(),t=this.events,this.options.disableResize||this.win.bind(g,t[g]),this.iOSNativeScrolling||(this.slider.bind(u,t[s]),this.pane.bind(u,t[_]).bind(""+p+" "+o,t[w])),this.$content.bind(""+m+" "+p+" "+o+" "+b,t[m])},c.prototype.removeEvents=function(){var t;t=this.events,this.win.unbind(g,t[g]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+m+" "+p+" "+o+" "+b,t[m])},c.prototype.generate=function(){var t,e,n,i,o;return n=this.options,i=n.paneClass,o=n.sliderClass,t=n.contentClass,this.$el.find(""+i).length||this.$el.find(""+o).length||this.$el.append('<div class="'+i+'"><div class="'+o+'" /></div>'),this.pane=this.$el.children("."+i),this.slider=this.pane.find("."+o),r&&(e="rtl"===this.$el.css("direction")?{left:-r}:{right:-r},this.$el.addClass("has-scrollbar")),null!=e&&this.$content.css(e),this},c.prototype.restore=function(){this.stopped=!1,this.pane.show(),this.addEvents()},c.prototype.reset=function(){var t,e,n,o,s,a,c,l,u;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),t=this.content,n=t.style,o=n.overflowY,i&&this.$content.css({height:this.$content.height()}),e=t.scrollHeight+r,a=this.pane.outerHeight(),l=parseInt(this.pane.css("top"),10),s=parseInt(this.pane.css("bottom"),10),c=a+l+s,u=Math.round(c/e*c),u<this.options.sliderMinHeight?u=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&u>this.options.sliderMaxHeight&&(u=this.options.sliderMaxHeight),o===m&&n.overflowX!==m&&(u+=r),this.maxSliderTop=c-u,this.contentHeight=e,this.paneHeight=a,this.paneOuterHeight=c,this.sliderHeight=u,this.slider.height(u),this.events.scroll(),this.pane.show(),this.isActive=!0,t.scrollHeight===t.clientHeight||this.pane.outerHeight(!0)>=t.scrollHeight&&o!==m?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===t.scrollHeight&&o===m?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),this)},c.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop((this.paneHeight-this.contentHeight+r)*this.sliderY/this.maxSliderTop*-1),this.iOSNativeScrolling||this.slider.css({top:this.sliderY}),this):void 0},c.prototype.scrollBottom=function(t){return this.isActive?(this.reset(),this.$content.scrollTop(this.contentHeight-this.$content.height()-t).trigger(p),this):void 0},c.prototype.scrollTop=function(t){return this.isActive?(this.reset(),this.$content.scrollTop(+t).trigger(p),this):void 0},c.prototype.scrollTo=function(e){return this.isActive?(this.reset(),this.scrollTop(t(e).get(0).offsetTop),this):void 0},c.prototype.stop=function(){return this.stopped=!0,this.removeEvents(),this.pane.hide(),this},c.prototype.flash=function(){var t=this;if(this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout(function(){t.pane.removeClass("flashed")},this.options.flashDelay),this},c}(),t.fn.nanoScroller=function(e){return this.each(function(){var n,i;if((i=this.nanoscroller)||(n=t.extend({},k,e),this.nanoscroller=i=new f(this,n)),e&&"object"==typeof e){if(t.extend(i.options,e),e.scrollBottom)return i.scrollBottom(e.scrollBottom);if(e.scrollTop)return i.scrollTop(e.scrollTop);if(e.scrollTo)return i.scrollTo(e.scrollTo);if("bottom"===e.scroll)return i.scrollBottom(0);if("top"===e.scroll)return i.scrollTop(0);if(e.scroll&&e.scroll instanceof t)return i.scrollTo(e.scroll);if(e.stop)return i.stop();if(e.flash)return i.flash()}return i.reset()})}}(jQuery,window,document);


/* public/javascripts/storage.js @ 1425075658 */
window.localStorage&&window.sessionStorage||function(){var t=function(t){function e(t,e,n){var i,r;n?(i=new Date,i.setTime(i.getTime()+24*n*60*60*1e3),r="; expires="+i.toGMTString()):r="",document.cookie=t+"="+e+r+"; path=/"}function n(t){var e,n,i=t+"=",r=document.cookie.split(";");for(e=0;e<r.length;e++){for(n=r[e];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(i))return n.substring(i.length,n.length)}return null}function i(n){n=JSON.stringify(n),"session"==t?window.name=n:e("localStorage",n,365)}function r(){"session"==t?window.name="":e("localStorage","",365)}function o(){var e="session"==t?window.name:n("localStorage");return e?JSON.parse(e):{}}function s(){var t=0;for(var e in a)a.hasOwnProperty(e)&&(t+=1);return t}var a=o();return{clear:function(){a={},r(),this.length=s()},getItem:function(t){return t=encodeURIComponent(t),void 0===a[t]?null:a[t]},key:function(t){var e=0;for(var n in a){if(e==t)return decodeURIComponent(n);e++}return null},removeItem:function(t){t=encodeURIComponent(t),delete a[t],i(a),this.length=s()},setItem:function(t,e){t=encodeURIComponent(t),a[t]=String(e),i(a),this.length=s()},length:0}};window.localStorage||(window.localStorage=new t("local")),window.sessionStorage||(window.sessionStorage=new t("session"))}();


/* public/javascripts/modernizr.custom.12353.js @ 1425075658 */
window.Modernizr=function(t,e,n){function i(t){v.cssText=t}function r(t,e){return typeof t===e}function o(t,e){return!!~(""+t).indexOf(e)}function s(t,e){for(var i in t){var r=t[i];if(!o(r,"-")&&v[r]!==n)return"pfx"==e?r:!0}return!1}function a(t,e,i){for(var o in t){var s=e[t[o]];if(s!==n)return i===!1?t[o]:r(s,"function")?s.bind(i||e):s}return!1}function c(t,e,n){var i=t.charAt(0).toUpperCase()+t.slice(1),o=(t+" "+w.join(i+" ")+i).split(" ");return r(e,"string")||r(e,"undefined")?s(o,e):(o=(t+" "+k.join(i+" ")+i).split(" "),a(o,e,n))}var l,u,d,h="2.8.2",p={},f=!0,_=e.documentElement,g="modernizr",m=e.createElement(g),v=m.style,b=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),y="Webkit Moz O ms",w=y.split(" "),k=y.toLowerCase().split(" "),x={},S=[],C=S.slice,T=function(t,n,i,r){var o,s,a,c,l=e.createElement("div"),u=e.body,d=u||e.createElement("body");if(parseInt(i,10))for(;i--;)a=e.createElement("div"),a.id=r?r[i]:g+(i+1),l.appendChild(a);return o=["&#173;",'<style id="s',g,'">',t,"</style>"].join(""),l.id=g,(u?l:d).innerHTML+=o,d.appendChild(l),u||(d.style.background="",d.style.overflow="hidden",c=_.style.overflow,_.style.overflow="hidden",_.appendChild(d)),s=n(l,t),u?l.parentNode.removeChild(l):(d.parentNode.removeChild(d),_.style.overflow=c),!!s},E={}.hasOwnProperty;d=r(E,"undefined")||r(E.call,"undefined")?function(t,e){return e in t&&r(t.constructor.prototype[e],"undefined")}:function(t,e){return E.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var n=C.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=e.prototype;var o=new r,s=e.apply(o,n.concat(C.call(arguments)));return Object(s)===s?s:o}return e.apply(t,n.concat(C.call(arguments)))};return i}),x.textshadow=function(){return""===e.createElement("div").style.textShadow},x.csstransforms=function(){return!!c("transform")},x.csstransforms3d=function(){var t=!!c("perspective");return t&&"webkitPerspective"in _.style&&T("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(e){t=9===e.offsetLeft&&3===e.offsetHeight}),t};for(var $ in x)d(x,$)&&(u=$.toLowerCase(),p[u]=x[$](),S.push((p[u]?"":"no-")+u));return p.addTest=function(t,e){if("object"==typeof t)for(var i in t)d(t,i)&&p.addTest(i,t[i]);else{if(t=t.toLowerCase(),p[t]!==n)return p;e="function"==typeof e?e():e,"undefined"!=typeof f&&f&&(_.className+=" "+(e?"":"no-")+t),p[t]=e}return p},i(""),m=l=null,function(t,e){function n(t,e){var n=t.createElement("p"),i=t.getElementsByTagName("head")[0]||t.documentElement;return n.innerHTML="x<style>"+e+"</style>",i.insertBefore(n.lastChild,i.firstChild)}function i(){var t=v.elements;return"string"==typeof t?t.split(" "):t}function r(t){var e=m[t[_]];return e||(e={},g++,t[_]=g,m[g]=e),e}function o(t,n,i){if(n||(n=e),u)return n.createElement(t);i||(i=r(n));var o;return o=i.cache[t]?i.cache[t].cloneNode():f.test(t)?(i.cache[t]=i.createElem(t)).cloneNode():i.createElem(t),!o.canHaveChildren||p.test(t)||o.tagUrn?o:i.frag.appendChild(o)}function s(t,n){if(t||(t=e),u)return t.createDocumentFragment();n=n||r(t);for(var o=n.frag.cloneNode(),s=0,a=i(),c=a.length;c>s;s++)o.createElement(a[s]);return o}function a(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(n){return v.shivMethods?o(n,t,e):e.createElem(n)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+i().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(v,e.frag)}function c(t){t||(t=e);var i=r(t);return v.shivCSS&&!l&&!i.hasCSS&&(i.hasCSS=!!n(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||a(t,i),t}var l,u,d="3.7.0",h=t.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,_="_html5shiv",g=0,m={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",l="hidden"in t,u=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(n){l=!0,u=!0}}();var v={elements:h.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:d,shivCSS:h.shivCSS!==!1,supportsUnknownElements:u,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:c,createElement:o,createDocumentFragment:s};t.html5=v,c(e)}(this,e),p._version=h,p._prefixes=b,p._domPrefixes=k,p._cssomPrefixes=w,p.testProp=function(t){return s([t])},p.testAllProps=c,p.testStyles=T,p.prefixed=function(t,e,n){return e?c(t,e,n):c(t,"pfx")},_.className=_.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+S.join(" "):""),p}(this,this.document),function(t,e,n){function i(t){return"[object Function]"==g.call(t)}function r(t){return"string"==typeof t}function o(){}function s(t){return!t||"loaded"==t||"complete"==t||"uninitialized"==t}function a(){var t=m.shift();v=1,t?t.t?f(function(){("c"==t.t?h.injectCss:h.injectJs)(t.s,0,t.a,t.x,t.e,1)},0):(t(),a()):v=0}function c(t,n,i,r,o,c,l){function u(e){if(!p&&s(d.readyState)&&(b.r=p=1,!v&&a(),d.onload=d.onreadystatechange=null,e)){"img"!=t&&f(function(){w.removeChild(d)},50);for(var i in T[n])T[n].hasOwnProperty(i)&&T[n][i].onload()}}var l=l||h.errorTimeout,d=e.createElement(t),p=0,g=0,b={t:i,s:n,e:o,a:c,x:l};1===T[n]&&(g=1,T[n]=[]),"object"==t?d.data=n:(d.src=n,d.type=t),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){u.call(this,g)},m.splice(r,0,b),"img"!=t&&(g||2===T[n]?(w.insertBefore(d,y?null:_),f(u,l)):T[n].push(d))}function l(t,e,n,i,o){return v=0,e=e||"j",r(t)?c("c"==e?x:k,t,e,this.i++,n,i,o):(m.splice(this.i++,0,t),1==m.length&&a()),this}function u(){var t=h;return t.loader={load:l,i:0},t}var d,h,p=e.documentElement,f=t.setTimeout,_=e.getElementsByTagName("script")[0],g={}.toString,m=[],v=0,b="MozAppearance"in p.style,y=b&&!!e.createRange().compareNode,w=y?p:_.parentNode,p=t.opera&&"[object Opera]"==g.call(t.opera),p=!!e.attachEvent&&!p,k=b?"object":p?"script":"img",x=p?"script":k,S=Array.isArray||function(t){return"[object Array]"==g.call(t)},C=[],T={},E={timeout:function(t,e){return e.length&&(t.timeout=e[0]),t}};h=function(t){function e(t){var e,n,i,t=t.split("!"),r=C.length,o=t.pop(),s=t.length,o={url:o,origUrl:o,prefixes:t};for(n=0;s>n;n++)i=t[n].split("="),(e=E[i.shift()])&&(o=e(o,i));for(n=0;r>n;n++)o=C[n](o);return o}function s(t,r,o,s,a){var c=e(t),l=c.autoCallback;c.url.split(".").pop().split("?").shift(),c.bypass||(r&&(r=i(r)?r:r[t]||r[s]||r[t.split("/").pop().split("?")[0]]),c.instead?c.instead(t,r,o,s,a):(T[c.url]?c.noexec=!0:T[c.url]=1,o.load(c.url,c.forceCSS||!c.forceJS&&"css"==c.url.split(".").pop().split("?").shift()?"c":n,c.noexec,c.attrs,c.timeout),(i(r)||i(l))&&o.load(function(){u(),r&&r(c.origUrl,a,s),l&&l(c.origUrl,a,s),T[c.url]=2})))}function a(t,e){function n(t,n){if(t){if(r(t))n||(d=function(){var t=[].slice.call(arguments);h.apply(this,t),p()}),s(t,d,e,0,l);else if(Object(t)===t)for(c in a=function(){var e,n=0;for(e in t)t.hasOwnProperty(e)&&n++;return n}(),t)t.hasOwnProperty(c)&&(!n&&!--a&&(i(d)?d=function(){var t=[].slice.call(arguments);h.apply(this,t),p()}:d[c]=function(t){return function(){var e=[].slice.call(arguments);t&&t.apply(this,e),p()}}(h[c])),s(t[c],d,e,c,l))}else!n&&p()}var a,c,l=!!t.test,u=t.load||t.both,d=t.callback||o,h=d,p=t.complete||o;n(l?t.yep:t.nope,!!u),u&&n(u)}var c,l,d=this.yepnope.loader;if(r(t))s(t,0,d,0);else if(S(t))for(c=0;c<t.length;c++)l=t[c],r(l)?s(l,0,d,0):S(l)?h(l):Object(l)===l&&a(l,d);else Object(t)===t&&a(t,d)},h.addPrefix=function(t,e){E[t]=e},h.addFilter=function(t){C.push(t)},h.errorTimeout=1e4,null==e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",d=function(){e.removeEventListener("DOMContentLoaded",d,0),e.readyState="complete"},0)),t.yepnope=u(),t.yepnope.executeStack=a,t.yepnope.injectJs=function(t,n,i,r,c,l){var u,d,p=e.createElement("script"),r=r||h.errorTimeout;p.src=t;for(d in i)p.setAttribute(d,i[d]);n=l?a:n||o,p.onreadystatechange=p.onload=function(){!u&&s(p.readyState)&&(u=1,n(),p.onload=p.onreadystatechange=null)},f(function(){u||(u=1,n(1))},r),c?p.onload():_.parentNode.insertBefore(p,_)},t.yepnope.injectCss=function(t,n,i,r,s,c){var l,r=e.createElement("link"),n=c?a:n||o;r.href=t,r.rel="stylesheet",r.type="text/css";for(l in i)r.setAttribute(l,i[l]);s||(_.parentNode.insertBefore(r,_),f(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};


/* public/javascripts/imagesloaded.pkgd.js @ 1425075658 */
!function(t){"use strict";function e(){}function n(t,e){if(r)return e.indexOf(t);for(var n=e.length;n--;)if(e[n]===t)return n;return-1}var i=e.prototype,r=Array.prototype.indexOf?!0:!1;i._getEvents=function(){return this._events||(this._events={})},i.getListeners=function(t){var e,n,i=this._getEvents();if("object"==typeof t){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},i.addListener=function(t,e){var i,r=this.getListenersAsObject(t);for(i in r)r.hasOwnProperty(i)&&-1===n(e,r[i])&&r[i].push(e);return this},i.on=i.addListener,i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,e){var i,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&(i=n(e,o[r]),-1!==i&&o[r].splice(i,1));return this},i.off=i.removeListener,i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,r,o=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)o.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?o.call(this,i,r):s.call(this,i,r));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if("object"===n)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.emitEvent=function(t,e){var n,i,r,o=this.getListenersAsObject(t);for(i in o)if(o.hasOwnProperty(i))for(n=o[i].length;n--;)r=e?o[i][n].apply(null,e):o[i][n](),r===!0&&this.removeListener(t,o[i][n]);return this},i.trigger=i.emitEvent,i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},"function"==typeof define&&define.amd?define(function(){return e}):t.EventEmitter=e}(this),function(t){"use strict";var e=document.documentElement,n=function(){};e.addEventListener?n=function(t,e,n){t.addEventListener(e,n,!1)}:e.attachEvent&&(n=function(e,n,i){e[n+i]=i.handleEvent?function(){var e=t.event;e.target=e.target||e.srcElement,i.handleEvent.call(i,e)}:function(){var n=t.event;n.target=n.target||n.srcElement,i.call(e,n)},e.attachEvent("on"+n,e[n+i])});var i=function(){};e.removeEventListener?i=function(t,e,n){t.removeEventListener(e,n,!1)}:e.detachEvent&&(i=function(t,e,n){t.detachEvent("on"+e,t[e+n]);try{delete t[e+n]}catch(i){t[e+n]=void 0}});var r={bind:n,unbind:i};"function"==typeof define&&define.amd?define(r):t.eventie=r}(this),function(t){"use strict";function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t){return"[object Array]"===c.call(t)}function i(t){var e=[];if(n(t))e=t;else if("number"==typeof t.length)for(var i=0,r=t.length;r>i;i++)e.push(t[i]);else e.push(t);return e}function r(t,n){function r(t,n,s){if(!(this instanceof r))return new r(t,n);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=i(t),this.options=e({},this.options),"function"==typeof n?s=n:e(this.options,n),s&&this.on("always",s),this.getImages(),o&&(this.jqDeferred=new o.Deferred);var a=this;setTimeout(function(){a.check()})}function c(t){this.img=t}r.prototype=new t,r.prototype.options={},r.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var n=this.elements[t];"IMG"===n.nodeName&&this.addImage(n);for(var i=n.querySelectorAll("img"),r=0,o=i.length;o>r;r++){var s=i[r];this.addImage(s)}}},r.prototype.addImage=function(t){var e=new c(t);this.images.push(e)},r.prototype.check=function(){function t(t,r){return e.options.debug&&a&&s.log("confirm",t,r),e.progress(t),n++,n===i&&e.complete(),!0}var e=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,!i)return void this.complete();for(var r=0;i>r;r++){var o=this.images[r];o.on("confirm",t),o.check()}},r.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emit("progress",this,t),this.jqDeferred&&this.jqDeferred.notify(this,t)},r.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emit(t,this),this.emit("always",this),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},o&&(o.fn.imagesLoaded=function(t,e){var n=new r(this,t,e);return n.jqDeferred.promise(o(this))});var l={};return c.prototype=new t,c.prototype.check=function(){var t=l[this.img.src];if(t)return void this.useCached(t);if(l[this.img.src]=this,this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var e=this.proxyImage=new Image;n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.img.src},c.prototype.useCached=function(t){if(t.isConfirmed)this.confirm(t.isLoaded,"cached was confirmed");else{var e=this;t.on("confirm",function(t){return e.confirm(t.isLoaded,"cache emitted confirmed"),!0})}},c.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},c.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},c.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindProxyEvents()},c.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindProxyEvents()},c.prototype.unbindProxyEvents=function(){n.unbind(this.proxyImage,"load",this),n.unbind(this.proxyImage,"error",this)},r}var o=t.jQuery,s=t.console,a="undefined"!=typeof s,c=Object.prototype.toString;"function"==typeof define&&define.amd?define(["eventEmitter","eventie"],r):t.imagesLoaded=r(t.EventEmitter,t.eventie)}(window);


/* public/javascripts/backbone/backbone-relational.js @ 1425075658 */
!function(){"use strict";var t,e,n;"undefined"==typeof window?(t=require("underscore"),e=require("backbone"),n=module.exports=e):(t=window._,e=window.Backbone,n=window),e.Relational={showWarnings:!0},e.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");this._permitsUsed++},release:function(){if(0===this._permitsUsed)throw new Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(t){if(this._permitsUsed>t)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=t}},e.BlockingQueue=function(){this._queue=[]},t.extend(e.BlockingQueue.prototype,e.Semaphore,{_queue:null,add:function(t){this.isBlocked()?this._queue.push(t):t()},process:function(){for(;this._queue&&this._queue.length;)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),e.Relational.eventQueue=new e.BlockingQueue,e.Store=function(){this._collections=[],this._reverseRelations=[],this._subModels=[],this._modelScopes=[n]},t.extend(e.Store.prototype,e.Events,{addModelScope:function(t){this._modelScopes.push(t)},addSubModels:function(t,e){this._subModels.push({superModelType:e,subModels:t})},setupSuperModel:function(e){t.find(this._subModels,function(n){return t.find(n.subModels,function(t,i){var r=this.getObjectByName(t);return e===r?(n.superModelType._subModels[i]=e,e._superModel=n.superModelType,e._subModelTypeValue=i,e._subModelTypeAttribute=n.superModelType.prototype.subModelTypeAttribute,!0):void 0},this)},this)},addReverseRelation:function(e){var n=t.any(this._reverseRelations,function(n){return t.all(e,function(t,e){return t===n[e]})});if(!n&&e.model&&e.type){this._reverseRelations.push(e);var i=function(e,n){e.prototype.relations||(e.prototype.relations=[]),e.prototype.relations.push(n),t.each(e._subModels,function(t){i(t,n)},this)};i(e.model,e),this.retroFitRelation(e)}},retroFitRelation:function(t){var e=this.getCollection(t.model);e.each(function(e){e instanceof t.model&&new t.type(e,t)},this)},getCollection:function(n){n instanceof e.RelationalModel&&(n=n.constructor);for(var i=n;i._superModel;)i=i._superModel;var r=t.detect(this._collections,function(t){return t.model===i});return r||(r=this._createCollection(i)),r},getObjectByName:function(e){var n=e.split("."),i=null;return t.find(this._modelScopes,function(e){return i=t.reduce(n,function(t,e){return t[e]},e),i&&i!==e?!0:void 0},this),i},_createCollection:function(t){var n;return t instanceof e.RelationalModel&&(t=t.constructor),t.prototype instanceof e.RelationalModel&&(n=new e.Collection,n.model=t,this._collections.push(n)),n},resolveIdForItem:function(n,i){var r=t.isString(i)||t.isNumber(i)?i:null;return null===r&&(i instanceof e.RelationalModel?r=i.id:t.isObject(i)&&(r=i[n.prototype.idAttribute])),r||0===r||(r=null),r},find:function(t,e){var n=this.resolveIdForItem(t,e),i=this.getCollection(t);if(i){var r=i.get(n);if(r instanceof t)return r}return null},register:function(t){var e=this.getCollection(t);if(e){if(e.get(t))throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!");var n=t.collection;e.add(t),t.bind("destroy",this.unregister,this),t.collection=n}},update:function(t){var e=this.getCollection(t);e._onModelEvent("change:"+t.idAttribute,t,e)},unregister:function(t){t.unbind("destroy",this.unregister);var e=this.getCollection(t);e&&e.remove(t)}}),e.Relational.store=new e.Store,e.Relation=function(n,i){return this.instance=n,i=t.isObject(i)?i:{},this.reverseRelation=t.defaults(i.reverseRelation||{},this.options.reverseRelation),this.reverseRelation.type=t.isString(this.reverseRelation.type)?e[this.reverseRelation.type]||e.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.model=i.model||this.instance.constructor,this.options=t.defaults(i,this.options,e.Relation.prototype.options),this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.relatedModel=this.options.relatedModel,t.isString(this.relatedModel)&&(this.relatedModel=e.Relational.store.getObjectByName(this.relatedModel)),this.checkPreconditions()?(n&&(this.keyContents=this.instance.get(this.keySource),this.key!==this.keySource&&this.instance.unset(this.keySource,{silent:!0}),this.instance._relations.push(this)),!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&e.Relational.store.addReverseRelation(t.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation)),t.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved"),void(n&&(this.initialize(),e.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection),e.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved)))):!1},e.Relation.extend=e.Model.extend,t.extend(e.Relation.prototype,e.Events,e.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(t,e,n){var i=this;t.queue(function(){i.tryAddRelated(t,n)})},_relatedModelRemoved:function(t,e,n){this.removeRelated(t,n)},_modelRemovedFromCollection:function(t){t===this.instance&&this.destroy()},checkPreconditions:function(){var n=this.instance,i=this.key,r=this.model,o=this.relatedModel,s=e.Relational.showWarnings&&"undefined"!=typeof console;if(!r||!i||!o)return s&&console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,r,i,o),!1;if(!(r.prototype instanceof e.RelationalModel))return s&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",this,n),!1;if(!(o.prototype instanceof e.RelationalModel))return s&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,o),!1;if(this instanceof e.HasMany&&this.reverseRelation.type===e.HasMany)return s&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(n&&n._relations.length){var a=t.any(n._relations,function(t){var e=this.reverseRelation.key&&t.reverseRelation.key;return t.relatedModel===o&&t.key===i&&(!e||this.reverseRelation.key===t.reverseRelation.key)},this);if(a)return s&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,n,i,o,this.reverseRelation.key),!1}return!0},setRelated:function(e,n){this.related=e,this.instance.acquire(),this.instance.set(this.key,e,t.defaults(n||{},{silent:!0})),this.instance.release()},_isReverseRelation:function(t){return t.instance instanceof this.relatedModel&&this.reverseRelation.key===t.key&&this.key===t.reverseRelation.key?!0:!1},getReverseRelations:function(e){var n=[],i=t.isUndefined(e)?this.related&&(this.related.models||[this.related]):[e];return t.each(i,function(e){t.each(e.getRelations(),function(t){this._isReverseRelation(t)&&n.push(t)},this)},this),n},sanitizeOptions:function(e){return e=e?t.clone(e):{},e.silent&&(e.silentChange=!0,delete e.silent),e},unsanitizeOptions:function(e){return e=e?t.clone(e):{},e.silentChange&&(e.silent=!0,delete e.silentChange),e},destroy:function(){e.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection),e.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",this._relatedModelRemoved),t.each(this.getReverseRelations(),function(t){t.removeRelated(this.instance)},this)}}),e.HasOne=e.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){t.bindAll(this,"onChange"),this.instance.bind("relational:change:"+this.key,this.onChange);var e=this.findRelated({silent:!0});this.setRelated(e),t.each(this.getReverseRelations(),function(t){t.addRelated(this.instance)},this)},findRelated:function(){var t=this.keyContents,e=null;return t instanceof this.relatedModel?e=t:(t||0===t)&&(e=this.relatedModel.findOrCreate(t,{create:this.options.createModels})),e},onChange:function(n,i,r){if(!this.isLocked()){this.acquire(),r=this.sanitizeOptions(r);var o=t.isUndefined(r._related),s=o?this.related:r._related;if(o)if(this.keyContents=i,i instanceof this.relatedModel)this.related=i;else if(i){var a=this.findRelated(r);this.setRelated(a)}else this.setRelated(null);if(s&&this.related!==s&&t.each(this.getReverseRelations(s),function(t){t.removeRelated(this.instance,r)},this),t.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,r)},this),!r.silentChange&&this.related!==s){var c=this;e.Relational.eventQueue.add(function(){c.instance.trigger("update:"+c.key,c.instance,c.related,r)})}this.release()}},tryAddRelated:function(n,i){if(!this.related){i=this.sanitizeOptions(i);var r=this.keyContents;if(r||0===r){var o=e.Relational.store.resolveIdForItem(this.relatedModel,r);t.isNull(o)||n.id!==o||this.addRelated(n,i)}}},addRelated:function(t){if(t!==this.related){var e=this.related||null;this.setRelated(t),this.onChange(this.instance,t,{_related:e})}},removeRelated:function(t){if(this.related&&t===this.related){var e=this.related||null;this.setRelated(null),this.onChange(this.instance,t,{_related:e})}}}),e.HasMany=e.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:e.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(){if(t.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset"),this.instance.bind("relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,t.isString(this.collectionType)&&(this.collectionType=e.Relational.store.getObjectByName(this.collectionType)),!this.collectionType.prototype instanceof e.Collection)throw new Error("collectionType must inherit from Backbone.Collection");this.setRelated(this.keyContents instanceof e.Collection?this._prepareCollection(this.keyContents):this._prepareCollection()),this.findRelated({silent:!0})},_getCollectionOptions:function(){return t.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions},_prepareCollection:function(t){if(this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset),t&&t instanceof e.Collection||(t=new this.collectionType([],this._getCollectionOptions())),t.model=this.relatedModel,this.options.collectionKey){var n=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;t[n]&&t[n]!==this.instance?e.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,n,this.options.collectionKey):n&&(t[n]=this.instance)}return t.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset),t},findRelated:function(n){if(this.keyContents){var i=[];this.keyContents instanceof e.Collection?i=this.keyContents.models:(this.keyContents=t.isArray(this.keyContents)?this.keyContents:[this.keyContents],t.each(this.keyContents,function(t){var e=null;t instanceof this.relatedModel?e=t:(t||0===t)&&(e=this.relatedModel.findOrCreate(t,{create:this.options.createModels})),!e||this.related.getByCid(e)||this.related.get(e)||i.push(e)},this)),i.length&&(n=this.unsanitizeOptions(n),this.related.add(i,n))}},onChange:function(n,i,r){if(r=this.sanitizeOptions(r),this.keyContents=i,t.each(this.getReverseRelations(),function(t){t.removeRelated(this.instance,r)},this),i instanceof e.Collection)this._prepareCollection(i),this.related=i;else{var o;this.related instanceof e.Collection?(o=this.related,o.remove(o.models)):o=this._prepareCollection(),this.setRelated(o),this.findRelated(r)}t.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,r)},this);var s=this;e.Relational.eventQueue.add(function(){!r.silentChange&&s.instance.trigger("update:"+s.key,s.instance,s.related,r)})},tryAddRelated:function(n,i){if(i=this.sanitizeOptions(i),!this.related.getByCid(n)&&!this.related.get(n)){var r=t.any(this.keyContents,function(i){var r=e.Relational.store.resolveIdForItem(this.relatedModel,i);return!t.isNull(r)&&r===n.id},this);r&&this.related.add(n,i)}},handleAddition:function(n,i,r){if(n instanceof e.Model){r=this.sanitizeOptions(r),t.each(this.getReverseRelations(n),function(t){t.addRelated(this.instance,r)},this);var o=this;e.Relational.eventQueue.add(function(){!r.silentChange&&o.instance.trigger("add:"+o.key,n,o.related,r)})}},handleRemoval:function(n,i,r){if(n instanceof e.Model){r=this.sanitizeOptions(r),t.each(this.getReverseRelations(n),function(t){t.removeRelated(this.instance,r)},this);var o=this;e.Relational.eventQueue.add(function(){!r.silentChange&&o.instance.trigger("remove:"+o.key,n,o.related,r)})}},handleReset:function(t,n){n=this.sanitizeOptions(n);var i=this;e.Relational.eventQueue.add(function(){!n.silentChange&&i.instance.trigger("reset:"+i.key,i.related,n)})},addRelated:function(t,e){var n=this;e=this.unsanitizeOptions(e),t.queue(function(){!n.related||n.related.getByCid(t)||n.related.get(t)||n.related.add(t,e)})},removeRelated:function(t,e){e=this.unsanitizeOptions(e),(this.related.getByCid(t)||this.related.get(t))&&this.related.remove(t,e)}}),e.RelationalModel=e.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(n,i){var r=this;if(i&&i.collection){this._deferProcessing=!0;var o=function(t){t===r&&(r._deferProcessing=!1,r.processQueue(),i.collection.unbind("relational:add",o))};i.collection.bind("relational:add",o),t.defer(function(){o(r)})}this._queue=new e.BlockingQueue,this._queue.block(),e.Relational.eventQueue.block(),e.Model.apply(this,arguments),e.Relational.eventQueue.unblock()},trigger:function(t){if(t.length>5&&"change"===t.substr(0,6)){var n=this,i=arguments;e.Relational.eventQueue.add(function(){e.Model.prototype.trigger.apply(n,i)})}else e.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire(),this._relations=[],t.each(this.relations,function(n){var i=t.isString(n.type)?e[n.type]||e.Relational.store.getObjectByName(n.type):n.type;i&&i.prototype instanceof e.Relation?new i(this,n):e.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; missing or invalid type!",n)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(e){this._isInitialized&&!this.isLocked()&&t.each(this._relations,function(t){var n=this.attributes[t.keySource]||this.attributes[t.key];t.related!==n&&this.trigger("relational:change:"+t.key,this,n,e||{})},this)},queue:function(t){this._queue.add(t)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(e){return t.detect(this._relations,function(t){return t.key===e?!0:void 0},this)},getRelations:function(){return this._relations},fetchRelated:function(n,i,r){i||(i={});var o,s=[],a=this.getRelation(n),c=a&&a.keyContents,l=c&&t.select(t.isArray(c)?c:[c],function(n){var i=e.Relational.store.resolveIdForItem(a.relatedModel,n);return!t.isNull(i)&&(r||!e.Relational.store.find(a.relatedModel,i))},this);if(l&&l.length){var u=t.map(l,function(e){var n;if(t.isObject(e))n=a.relatedModel.build(e);else{var i={};i[a.relatedModel.prototype.idAttribute]=e,n=a.relatedModel.build(i)}return n},this);if(a.related instanceof e.Collection&&t.isFunction(a.related.url)&&(o=a.related.url(u)),o&&o!==a.related.url()){var d=t.defaults({error:function(){var e=arguments;t.each(u,function(t){t.trigger("destroy",t,t.collection,i),i.error&&i.error.apply(t,e)})},url:o},i,{add:!0});s=[a.related.fetch(d)]}else s=t.map(u,function(e){var n=t.defaults({error:function(){e.trigger("destroy",e,e.collection,i),i.error&&i.error.apply(e,arguments)}},i);return e.fetch(n)},this)}return s},set:function(n,i,r){e.Relational.eventQueue.block();var o;t.isObject(n)||null==n?(o=n,r=i):(o={},o[n]=i);var s=e.Model.prototype.set.apply(this,arguments);return this._isInitialized||this.isLocked()?o&&this.idAttribute in o&&e.Relational.store.update(this):(this.constructor.initializeModelHierarchy(),e.Relational.store.register(this),this.initializeRelations()),o&&this.updateRelations(r),e.Relational.eventQueue.unblock(),s},unset:function(t,n){e.Relational.eventQueue.block();var i=e.Model.prototype.unset.apply(this,arguments);return this.updateRelations(n),e.Relational.eventQueue.unblock(),i},clear:function(t){e.Relational.eventQueue.block();var n=e.Model.prototype.clear.apply(this,arguments);return this.updateRelations(t),e.Relational.eventQueue.unblock(),n},change:function(){var t=this,n=arguments;e.Relational.eventQueue.add(function(){e.Model.prototype.change.apply(t,n)})},clone:function(){var e=t.clone(this.attributes);return t.isUndefined(e[this.idAttribute])||(e[this.idAttribute]=null),t.each(this.getRelations(),function(t){delete e[t.key]}),new this.constructor(e)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var n=e.Model.prototype.toJSON.call(this);return!this.constructor._superModel||this.constructor._subModelTypeAttribute in n||(n[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),t.each(this._relations,function(i){var r=n[i.key];if(i.options.includeInJSON===!0)n[i.keyDestination]=r&&t.isFunction(r.toJSON)?r.toJSON():null;else if(t.isString(i.options.includeInJSON))n[i.keyDestination]=r instanceof e.Collection?r.pluck(i.options.includeInJSON):r instanceof e.Model?r.get(i.options.includeInJSON):null;else if(t.isArray(i.options.includeInJSON))if(r instanceof e.Collection){var o=[];r.each(function(e){var n={};t.each(i.options.includeInJSON,function(t){n[t]=e.get(t)}),o.push(n)}),n[i.keyDestination]=o}else if(r instanceof e.Model){var o={};t.each(i.options.includeInJSON,function(t){o[t]=r.get(t)}),n[i.keyDestination]=o}else n[i.keyDestination]=null;else delete n[i.key];i.keyDestination!==i.key&&delete n[i.key]}),this.release(),n}},{setup:function(){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?e.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,t.each(this.prototype.relations,function(n){if(n.model||(n.model=this),n.reverseRelation&&n.model===this){var i=!0;if(t.isString(n.relatedModel)){var r=e.Relational.store.getObjectByName(n.relatedModel);i=r&&r.prototype instanceof e.RelationalModel}var o=t.isString(n.type)?e[n.type]||e.Relational.store.getObjectByName(n.type):n.type;i&&o&&o.prototype instanceof e.Relation&&new o(null,n)}},this),this},build:function(t,e){var n=this;if(this.initializeModelHierarchy(),this._subModels&&this.prototype.subModelTypeAttribute in t){var i=t[this.prototype.subModelTypeAttribute],r=this._subModels[i];r&&(n=r)}return new n(t,e)},initializeModelHierarchy:function(){if(t.isUndefined(this._superModel)||t.isNull(this._superModel))if(e.Relational.store.setupSuperModel(this),this._superModel){if(this._superModel.prototype.relations){var n=t.any(this.prototype.relations,function(t){return t.model&&t.model!==this},this);n||(this.prototype.relations=this._superModel.prototype.relations.concat(this.prototype.relations))}}else this._superModel=!1;this.prototype.subModelTypes&&t.keys(this.prototype.subModelTypes).length!==t.keys(this._subModels).length&&t.each(this.prototype.subModelTypes,function(t){var n=e.Relational.store.getObjectByName(t);n&&n.initializeModelHierarchy()})},findOrCreate:function(n,i){var r=e.Relational.store.find(this,n);return t.isObject(n)&&(r?r.set(r.parse?r.parse(n):n,i):(!i||i&&i.create!==!1)&&(r=this.build(n,i))),r}}),t.extend(e.RelationalModel.prototype,e.Semaphore),e.Collection.prototype.__prepareModel=e.Collection.prototype._prepareModel,e.Collection.prototype._prepareModel=function(t,n){if(n||(n={}),t instanceof e.Model)t.collection||(t.collection=this);else{var i=t;n.collection=this,t="undefined"!=typeof this.model.findOrCreate?this.model.findOrCreate(i,n):new this.model(i,n),t._validate(t.attributes,n)||(t=!1)}return t};var i=e.Collection.prototype.__add=e.Collection.prototype.add;e.Collection.prototype.add=function(n,r){r||(r={}),t.isArray(n)||(n=[n]);var o=[];return t.each(n,function(t){t instanceof e.Model||(t=e.Collection.prototype._prepareModel.call(this,t,r)),t instanceof e.Model&&!this.get(t)&&!this.getByCid(t)&&o.push(t)},this),o.length&&(i.call(this,o,r),t.each(o,function(t){this.trigger("relational:add",t,this,r)},this)),this};var r=e.Collection.prototype.__remove=e.Collection.prototype.remove;e.Collection.prototype.remove=function(n,i){return i||(i={}),n=t.isArray(n)?n.slice(0):[n],t.each(n,function(t){t=this.getByCid(t)||this.get(t),t instanceof e.Model&&(r.call(this,t,i),this.trigger("relational:remove",t,this,i))},this),this};var o=e.Collection.prototype.__reset=e.Collection.prototype.reset;e.Collection.prototype.reset=function(t,e){return o.call(this,t,e),this.trigger("relational:reset",this,e),this};var s=e.Collection.prototype.__sort=e.Collection.prototype.sort;e.Collection.prototype.sort=function(t){return s.call(this,t),this.trigger("relational:reset",this,t),this};var a=e.Collection.prototype.__trigger=e.Collection.prototype.trigger;e.Collection.prototype.trigger=function(n){if("add"===n||"remove"===n||"reset"===n){var i=this,r=arguments;"add"===n&&(r=t.toArray(r),t.isObject(r[3])&&(r[3]=t.clone(r[3]))),e.Relational.eventQueue.add(function(){a.apply(i,r)})}else a.apply(this,arguments);return this},e.RelationalModel.extend=function(){var t=e.Model.extend.apply(this,arguments);return t.setup(this),t};var c=e.Collection.prototype.fetch;e.Collection.prototype.fetch=function(e){e||(e={}),t.defaults(e,{add:!0}),e.reset&&this.reset();var n=this,i=c.call(this,e);return i.done(function(){e.silent||n.trigger("fetch",n,e)}),i}}();


/* public/javascripts/backbone/backbone-subset.js @ 1425075658 */
!function(){function t(t,e){return _.difference(_.union(t,e),_.intersection(t,e))}var e={};Backbone.Subset=function(t,e){var n;if(e=e||{},e.parent&&(this.parent=e.parent),!(n=_.result(this,"parent")))throw new Error("Can't create a subset without a parent collection");this.model=n.model,this.comparator=this.comparator||e.comparator||n.comparator,this.liveupdate_keys=this.liveupdate_keys||e.liveupdate_keys||"none",_.bindAll(this,"_onModelEvent","_unbindModelEvents","_proxyAdd","_proxyReset","_proxyRemove","_proxyChange"),n.bind("add",this._proxyAdd),n.bind("remove",this._proxyRemove),n.bind("reset",this._proxyReset),n.bind("all",this._proxyChange),this.beforeInitialize&&this.beforeInitialize.apply(this,arguments),e.no_reset?this._resetSubset({silent:!0}):(this._reset(),this.reset(t||n.models,{silent:!0})),this.initialize.apply(this,arguments)},e.exclusiveSubset=function(){return!1},e.reset=function(e,n){var i,r=_.result(this,"parent"),o=_.clone(r.models),s=this.pluck("id");return e=e||[],e=_.isArray(e)?e:[e],n=n||{},o=_.reject(o,function(t){return _.include(s,t.id)}),_.each(e,function(t){o.push(t)}),i=t(s,_.pluck(e,"id")),r.reset(o,_.extend({silent:!0},n)),this.exclusiveSubset()?r.trigger("reset",this,_.extend({model_ids:i,exclusive_collection:this},n)):r.trigger("reset",this,_.extend({model_ids:i},n)),this},e.recalculate=function(t){t=t||{};var e,n=this;return e=_.result(this,"parent").reduce(function(t,e){return n._updateModelMembership(e,{silent:!0})||t},!1),e&&!t.silent&&this.trigger("reset",this,t),this},e._resetSubset=function(t){return t=t||{},this.each(this._unbindModelEvents),this._reset(),_.result(this,"parent").each(function(t){this._addToSubset(t,{silent:!0})},this),t.silent||this.trigger("reset",this,t),this},e.add=function(t,e){return this.exclusiveSubset()&&(e=_.extend(e,{exclusive_collection:this})),_.result(this,"parent").add(t,e)},e._addToSubset=function(t,e){return this.sieve(t)?Backbone.Collection.prototype.add.call(this,t,e):void 0},e.remove=function(t,e){return this.exclusiveSubset()&&(e=_.extend(e,{exclusive_collection:this})),_.result(this,"parent").remove(t,e)},e._removeFromSubset=function(t,e){return Backbone.Collection.prototype.remove.call(this,t,e)},e._prepareModel=function(t,e){var n=_.result(this,"parent");if(t instanceof Backbone.Model)t.collection||(t.collection=n);else{var i=t;t=new this.model(i,{collection:n}),t.validate&&!t._performValidation(t.attributes,e)&&(t=!1)}return t=this.sieve(t)?t:!1},e._proxyAdd=function(t,e,n){n=n||{},n.exclusive_collection&&n.exclusive_collection!==this||e!==this&&this.sieve(t)&&!n.noproxy&&this._addToSubset(t,n)},e._proxyRemove=function(t,e,n){n=n||{},n.exclusive_collection&&n.exclusive_collection!==this||e!==this&&this.sieve(t)&&!n.noproxy&&this._removeFromSubset(t,n)},e._proxyChange=function(t,e,n){n!==this&&"change"===t&&"all"===this.liveupdate_keys?this._updateModelMembership(e):"change:"===t.slice(0,7)&&_.isArray(this.liveupdate_keys)&&_.include(this.liveupdate_keys,t.slice(7))&&this._updateModelMembership(e)},e._proxyReset=function(t,e){function n(){return _.filter(e.model_ids,function(t){var e=i.parent().get(t)||i.get(t);return e&&i.sieve(e)})}e=e||{};var i=this;e.exclusive_collection&&e.exclusive_collection!==this||e&&e.noproxy||e.model_ids&&this!==t&&!n().length||this._resetSubset(_.extend(_.clone(e),{proxied:!0}))},e._updateModelMembership=function(t,e){var n=!t.id,i=this._byCid[t.cid]||n&&this._byId[t.id];if(this.sieve(t)){if(!i)return this._addToSubset(t,e),!0}else if(i)return this._removeFromSubset(t,e),!0;return!1},e._unbindModelEvents=function(t){t.unbind("all",this._onModelEvent)},_.extend(Backbone.Subset.prototype,Backbone.Collection.prototype,e),Backbone.Subset.extend=Backbone.Collection.extend}();


/* public/javascripts/jquery.transify.js @ 1425075658 */
// COPYRIGHT JOREN RAPINI 2010
!function(t){t.fn.untransify=function(){return this.each(function(){var e=t(this);e.data("transify_prev")&&(oldCSS={zIndex:e.data("transify_prev").zIndex,background:e.data("transify_prev").background,border:e.data("transify_prev").border},e.css(oldCSS),e.children(".transify").remove())}),this}}(jQuery),function(t){t.fn.transify=function(e){var n={opacityOrig:.5,fadeSpeed:600},i=t.extend({},n,e);return this.each(function(){var e=t(this);e.append('<div class="transify"></div>');var n=e.find(".transify");n.css({backgroundColor:e.css("backgroundColor"),backgroundImage:e.css("backgroundImage"),backgroundRepeat:e.css("backgroundRepeat"),borderTopColor:e.css("borderTopColor"),borderTopWidth:e.css("borderTopWidth"),borderTopStyle:e.css("borderTopStyle"),borderRightColor:e.css("borderRightColor"),borderRightWidth:e.css("borderRightWidth"),borderRightStyle:e.css("borderRightStyle"),borderBottomColor:e.css("borderBottomColor"),borderBottomWidth:e.css("borderBottomWidth"),borderBottomStyle:e.css("borderBottomStyle"),borderLeftColor:e.css("borderLeftColor"),borderLeftWidth:e.css("borderLeftWidth"),borderLeftStyle:e.css("borderLeftStyle"),position:"absolute",top:0,left:0,zIndex:-1,width:e.width()+parseInt(e.css("padding-left"),10)+parseInt(e.css("padding-right"),10),height:e.height()+parseInt(e.css("padding-top"),10)+parseInt(e.css("padding-bottom"),10),opacity:i.opacityOrig}),i.percentWidth&&n.css("width",i.percentWidth),e.data("transify_prev",{zIndex:e.css("zIndex"),background:e.css("background"),border:e.css("border")}),e.css({zIndex:4,background:"none",border:"none"}),i.opacityNew&&e.hover(function(){n.stop().animate({opacity:i.opacityNew},i.fadeSpeed)},function(){n.stop().animate({opacity:i.opacityOrig},i.fadeSpeed)})}),this}}(jQuery);


/* public/javascripts/jquery.nearest.js @ 1425075658 */
!function(t,e){function n(e,n,r){e||(e="div");var o,s,a=t(n.container),c=a.offset()||{left:0,top:0},l=[c.left+a.width(),c.top+a.height()],u={x:0,y:1,w:0,h:1};for(o in u)u.hasOwnProperty(o)&&(s=i.exec(n[o]),s&&(n[o]=l[u[o]]*s[1]/100));var d=t(e),h=[],p=!!n.furthest,f=!!n.checkHoriz,_=!!n.checkVert,g=p?0:1/0,m=parseFloat(n.x)||0,v=parseFloat(n.y)||0,b=parseFloat(m+n.w)||m,y=parseFloat(v+n.h)||v,w=n.tolerance||0,k=!!t.fn.each2,x=Math.min,S=Math.max;!n.includeSelf&&r&&(d=d.not(r)),0>w&&(w=0),d[k?"each2":"each"](function(e,n){var i,r,o,s,a=k?n:t(this),c=a.offset(),l=c.left,u=c.top,d=a.outerWidth(),C=a.outerHeight(),T=l+d,E=u+C,$=S(l,m),M=x(T,b),P=S(u,v),j=x(E,y),D=M>=$,A=j>=P;(f&&_||!f&&!_&&D&&A||f&&A||_&&D)&&(i=D?0:$-M,r=A?0:P-j,o=D||A?S(i,r):Math.sqrt(i*i+r*r),s=p?o>=g-w:g+w>=o,s&&(g=p?S(g,o):x(g,o),h.push({node:this,dist:o})))});var C,T,E,$,M=h.length,P=[];if(M)for(p?(C=g-w,T=g):(C=g,T=g+w),E=0;M>E;E++)$=h[E],$.dist>=C&&$.dist<=T&&P.push($.node);return P}var i=/^([\d.]+)%$/;t.each(["nearest","furthest","touching"],function(i,r){var o={x:0,y:0,w:0,h:0,tolerance:1,container:document,furthest:"furthest"==r,includeSelf:!1,checkHoriz:"touching"!=r,checkVert:"touching"!=r};t[r]=function(i,r,s){if(!i||i.x===e||i.y===e)return t([]);var a=t.extend({},o,i,s||{});return t(n(r,a))},t.fn[r]=function(e,i){var r;if(e&&t.isPlainObject(e))return r=t.extend({},o,e,i||{}),this.pushStack(n(this,r));var s=this.offset(),a={x:s.left,y:s.top,w:this.outerWidth(),h:this.outerHeight()};return r=t.extend({},o,a,i||{}),this.pushStack(n(e,r,this))}})}(jQuery);


/* public/javascripts/moment.js @ 1425075658 */
(function(t){function e(t,e){return function(n){return c(t.call(this,n),e)}}function n(t,e){return function(n){return this.lang().ordinal(t.call(this,n),e)}}function i(){}function r(t){b(t),s(this,t)}function o(t){var e=f(t),n=e.year||0,i=e.month||0,r=e.week||0,o=e.day||0,s=e.hour||0,a=e.minute||0,c=e.second||0,l=e.millisecond||0;this._milliseconds=+l+1e3*c+6e4*a+36e5*s,this._days=+o+7*r,this._months=+i+12*n,this._data={},this._bubble()}function s(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return e.hasOwnProperty("toString")&&(t.toString=e.toString),e.hasOwnProperty("valueOf")&&(t.valueOf=e.valueOf),t}function a(t){return 0>t?Math.ceil(t):Math.floor(t)}function c(t,e,n){for(var i=Math.abs(t)+"",r=t>=0;i.length<e;)i="0"+i;return(r?n?"+":"":"-")+i}function l(t,e,n,i){var r,o,s=e._milliseconds,a=e._days,c=e._months;s&&t._d.setTime(+t._d+s*n),(a||c)&&(r=t.minute(),o=t.hour()),a&&t.date(t.date()+a*n),c&&t.month(t.month()+c*n),s&&!i&&ne.updateOffset(t),(a||c)&&(t.minute(r),t.hour(o))}function u(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function h(t,e,n){var i,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),s=0;for(i=0;r>i;i++)(n&&t[i]!==e[i]||!n&&g(t[i])!==g(e[i]))&&s++;return s+o}function p(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=Be[t]||We[e]||e}return t}function f(t){var e,n,i={};for(n in t)t.hasOwnProperty(n)&&(e=p(n),e&&(i[e]=t[n]));return i}function _(e){var n,i;if(0===e.indexOf("week"))n=7,i="day";else{if(0!==e.indexOf("month"))return;n=12,i="month"}ne[e]=function(r,o){var s,a,c=ne.fn._lang[e],l=[];if("number"==typeof r&&(o=r,r=t),a=function(t){var e=ne().utc().set(i,t);return c.call(ne.fn._lang,e,r||"")},null!=o)return a(o);for(s=0;n>s;s++)l.push(a(s));return l}}function g(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=e>=0?Math.floor(e):Math.ceil(e)),n}function m(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function v(t){return y(t)?366:365}function y(t){return t%4===0&&t%100!==0||t%400===0}function b(t){var e;t._a&&-2===t._pf.overflow&&(e=t._a[ce]<0||t._a[ce]>11?ce:t._a[le]<1||t._a[le]>m(t._a[ae],t._a[ce])?le:t._a[ue]<0||t._a[ue]>23?ue:t._a[de]<0||t._a[de]>59?de:t._a[he]<0||t._a[he]>59?he:t._a[pe]<0||t._a[pe]>999?pe:-1,t._pf._overflowDayOfYear&&(ae>e||e>le)&&(e=le),t._pf.overflow=e)}function w(t){t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function k(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length)),t._isValid}function x(t){return t?t.toLowerCase().replace("_","-"):t}function S(t,e){return e._isUTC?ne(t).zone(e._offset||0):ne(t).local()}function C(t,e){return e.abbr=t,fe[t]||(fe[t]=new i),fe[t].set(e),fe[t]}function T(t){delete fe[t]}function E(t){var e,n,i,r,o=0,s=function(t){if(!fe[t]&&_e)try{require("./lang/"+t)}catch(e){}return fe[t]};if(!t)return ne.fn._lang;if(!u(t)){if(n=s(t))return n;t=[t]}for(;o<t.length;){for(r=x(t[o]).split("-"),e=r.length,i=x(t[o+1]),i=i?i.split("-"):null;e>0;){if(n=s(r.slice(0,e).join("-")))return n;if(i&&i.length>=e&&h(r,i,!0)>=e-1)break;e--}o++}return ne.fn._lang}function $(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function M(t){var e,n,i=t.match(ye);for(e=0,n=i.length;n>e;e++)i[e]=Ye[i[e]]?Ye[i[e]]:$(i[e]);return function(r){var o="";for(e=0;n>e;e++)o+=i[e]instanceof Function?i[e].call(r,t):i[e];return o}}function P(t,e){return t.isValid()?(e=D(e,t.lang()),Ue[e]||(Ue[e]=M(e)),Ue[e](t)):t.lang().invalidDate()}function D(t,e){function n(t){return e.longDateFormat(t)||t}var i=5;for(be.lastIndex=0;i>=0&&be.test(t);)t=t.replace(be,n),be.lastIndex=0,i-=1;return t}function j(t,e){var n,i=e._strict;switch(t){case"DDDD":return je;case"YYYY":case"GGGG":case"gggg":return i?Ae:xe;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?Oe:Se;case"S":if(i)return Pe;case"SS":if(i)return De;case"SSS":case"DDD":return i?je:ke;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Te;case"a":case"A":return E(e._l)._meridiemParse;case"X":return Me;case"Z":case"ZZ":return Ee;case"T":return $e;case"SSSS":return Ce;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?De:we;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return i?Pe:we;default:return n=new RegExp(F(L(t.replace("\\","")),"i"))}}function A(t){t=t||"";var e=t.match(Ee)||[],n=e[e.length-1]||[],i=(n+"").match(Le)||["-",0,0],r=+(60*i[1])+g(i[2]);return"+"===i[0]?-r:r}function O(t,e,n){var i,r=n._a;switch(t){case"M":case"MM":null!=e&&(r[ce]=g(e)-1);break;case"MMM":case"MMMM":i=E(n._l).monthsParse(e),null!=i?r[ce]=i:n._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(r[le]=g(e));break;case"DDD":case"DDDD":null!=e&&(n._dayOfYear=g(e));break;case"YY":r[ae]=g(e)+(g(e)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":r[ae]=g(e);break;case"a":case"A":n._isPm=E(n._l).isPM(e);break;case"H":case"HH":case"h":case"hh":r[ue]=g(e);break;case"m":case"mm":r[de]=g(e);break;case"s":case"ss":r[he]=g(e);break;case"S":case"SS":case"SSS":case"SSSS":r[pe]=g(1e3*("0."+e));break;case"X":n._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=A(e);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":t=t.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(n._w=n._w||{},n._w[t]=e)}}function N(t){var e,n,i,r,o,s,a,c,l,u,d=[];if(!t._d){for(i=R(t),t._w&&null==t._a[le]&&null==t._a[ce]&&(o=function(e){var n=parseInt(e,10);return e?e.length<3?n>68?1900+n:2e3+n:n:null==t._a[ae]?ne().weekYear():t._a[ae]},s=t._w,null!=s.GG||null!=s.W||null!=s.E?a=Q(o(s.GG),s.W||1,s.E,4,1):(c=E(t._l),l=null!=s.d?V(s.d,c):null!=s.e?parseInt(s.e,10)+c._week.dow:0,u=parseInt(s.w,10)||1,null!=s.d&&l<c._week.dow&&u++,a=Q(o(s.gg),u,l,c._week.doy,c._week.dow)),t._a[ae]=a.year,t._dayOfYear=a.dayOfYear),t._dayOfYear&&(r=null==t._a[ae]?i[ae]:t._a[ae],t._dayOfYear>v(r)&&(t._pf._overflowDayOfYear=!0),n=q(r,0,t._dayOfYear),t._a[ce]=n.getUTCMonth(),t._a[le]=n.getUTCDate()),e=0;3>e&&null==t._a[e];++e)t._a[e]=d[e]=i[e];for(;7>e;e++)t._a[e]=d[e]=null==t._a[e]?2===e?1:0:t._a[e];d[ue]+=g((t._tzm||0)/60),d[de]+=g((t._tzm||0)%60),t._d=(t._useUTC?q:U).apply(null,d)}}function I(t){var e;t._d||(e=f(t._i),t._a=[e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond],N(t))}function R(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function z(t){t._a=[],t._pf.empty=!0;var e,n,i,r,o,s=E(t._l),a=""+t._i,c=a.length,l=0;for(i=D(t._f,s).match(ye)||[],e=0;e<i.length;e++)r=i[e],n=(a.match(j(r,t))||[])[0],n&&(o=a.substr(0,a.indexOf(n)),o.length>0&&t._pf.unusedInput.push(o),a=a.slice(a.indexOf(n)+n.length),l+=n.length),Ye[r]?(n?t._pf.empty=!1:t._pf.unusedTokens.push(r),O(r,n,t)):t._strict&&!n&&t._pf.unusedTokens.push(r);t._pf.charsLeftOver=c-l,a.length>0&&t._pf.unusedInput.push(a),t._isPm&&t._a[ue]<12&&(t._a[ue]+=12),t._isPm===!1&&12===t._a[ue]&&(t._a[ue]=0),N(t),b(t)}function L(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,r){return e||n||i||r})}function F(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function H(t){var e,n,i,r,o;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(0/0));for(r=0;r<t._f.length;r++)o=0,e=s({},t),w(e),e._f=t._f[r],z(e),k(e)&&(o+=e._pf.charsLeftOver,o+=10*e._pf.unusedTokens.length,e._pf.score=o,(null==i||i>o)&&(i=o,n=e));s(t,n||e)}function B(t){var e,n=t._i,i=Ne.exec(n);if(i){for(t._pf.iso=!0,e=4;e>0;e--)if(i[e]){t._f=Re[e-1]+(i[6]||" ");break}for(e=0;4>e;e++)if(ze[e][1].exec(n)){t._f+=ze[e][0];break}n.match(Ee)&&(t._f+="Z"),z(t)}else t._d=new Date(n)}function W(e){var n=e._i,i=ge.exec(n);n===t?e._d=new Date:i?e._d=new Date(+i[1]):"string"==typeof n?B(e):u(n)?(e._a=n.slice(0),N(e)):d(n)?e._d=new Date(+n):"object"==typeof n?I(e):e._d=new Date(n)}function U(t,e,n,i,r,o,s){var a=new Date(t,e,n,i,r,o,s);return 1970>t&&a.setFullYear(t),a}function q(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function V(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function Y(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function G(t,e,n){var i=se(Math.abs(t)/1e3),r=se(i/60),o=se(r/60),s=se(o/24),a=se(s/365),c=45>i&&["s",i]||1===r&&["m"]||45>r&&["mm",r]||1===o&&["h"]||22>o&&["hh",o]||1===s&&["d"]||25>=s&&["dd",s]||45>=s&&["M"]||345>s&&["MM",se(s/30)]||1===a&&["y"]||["yy",a];return c[2]=e,c[3]=t>0,c[4]=n,Y.apply({},c)}function X(t,e,n){var i,r=n-e,o=n-t.day();return o>r&&(o-=7),r-7>o&&(o+=7),i=ne(t).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function Q(t,e,n,i,r){var o,s,a=new Date(c(t,6,!0)+"-01-01").getUTCDay();return n=null!=n?n:r,o=r-a+(a>i?7:0),s=7*(e-1)+(n-r)+o+1,{year:s>0?t:t-1,dayOfYear:s>0?s:v(t-1)+s}}function J(t){var e=t._i,n=t._f;return"undefined"==typeof t._pf&&w(t),null===e?ne.invalid({nullInput:!0}):("string"==typeof e&&(t._i=e=E().preparse(e)),ne.isMoment(e)?(t=s({},e),t._d=new Date(+e._d)):n?u(n)?H(t):z(t):W(t),new r(t))}function K(t,e){ne.fn[t]=ne.fn[t+"s"]=function(t){var n=this._isUTC?"UTC":"";return null!=t?(this._d["set"+n+e](t),ne.updateOffset(this),this):this._d["get"+n+e]()}}function Z(t){ne.duration.fn[t]=function(){return this._data[t]}}function te(t,e){ne.duration.fn["as"+t]=function(){return+this/e}}function ee(t){var e=!1,n=ne;"undefined"==typeof ender&&(t?(oe.moment=function(){return!e&&console&&console.warn&&(e=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),n.apply(null,arguments)},s(oe.moment,n)):oe.moment=ne)}for(var ne,ie,re="2.5.0",oe=this,se=Math.round,ae=0,ce=1,le=2,ue=3,de=4,he=5,pe=6,fe={},_e="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,ge=/^\/?Date\((\-?\d+)/i,me=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,ve=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,ye=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,be=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,we=/\d\d?/,ke=/\d{1,3}/,xe=/\d{1,4}/,Se=/[+\-]?\d{1,6}/,Ce=/\d+/,Te=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ee=/Z|[\+\-]\d\d:?\d\d/gi,$e=/T/i,Me=/[\+\-]?\d+(\.\d{1,3})?/,Pe=/\d/,De=/\d\d/,je=/\d{3}/,Ae=/\d{4}/,Oe=/[+\-]?\d{6}/,Ne=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ie="YYYY-MM-DDTHH:mm:ssZ",Re=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],ze=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Le=/([\+\-]|\d\d)/gi,Fe="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),He={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Be={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},We={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Ue={},qe="DDD w W M D d".split(" "),Ve="M D H h m s w W".split(" "),Ye={M:function(){return this.month()+1},MMM:function(t){return this.lang().monthsShort(this,t)},MMMM:function(t){return this.lang().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.lang().weekdaysMin(this,t)},ddd:function(t){return this.lang().weekdaysShort(this,t)},dddd:function(t){return this.lang().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return c(this.year()%100,2)},YYYY:function(){return c(this.year(),4)},YYYYY:function(){return c(this.year(),5)},YYYYYY:function(){var t=this.year(),e=t>=0?"+":"-";return e+c(Math.abs(t),6)},gg:function(){return c(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return c(this.weekYear(),5)},GG:function(){return c(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return c(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return g(this.milliseconds()/100)},SS:function(){return c(g(this.milliseconds()/10),2)},SSS:function(){return c(this.milliseconds(),3)},SSSS:function(){return c(this.milliseconds(),3)},Z:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+c(g(t/60),2)+":"+c(g(t)%60,2)},ZZ:function(){var t=-this.zone(),e="+";return 0>t&&(t=-t,e="-"),e+c(g(t/60),2)+c(g(t)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Ge=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];qe.length;)ie=qe.pop(),Ye[ie+"o"]=n(Ye[ie],ie);for(;Ve.length;)ie=Ve.pop(),Ye[ie+ie]=e(Ye[ie],2);for(Ye.DDDD=e(Ye.DDD,3),s(i.prototype,{set:function(t){var e,n;for(n in t)e=t[n],"function"==typeof e?this[n]=e:this["_"+n]=e},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t){var e,n,i;for(this._monthsParse||(this._monthsParse=[]),e=0;12>e;e++)if(this._monthsParse[e]||(n=ne.utc([2e3,e]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[e]=new RegExp(i.replace(".",""),"i")),this._monthsParse[e].test(t))return e},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(n=ne([2e3,1]).day(e),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[e]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e){var n=this._calendar[t];return"function"==typeof n?n.apply(e):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(t,e,n,i):r.replace(/%d/i,t)},pastFuture:function(t,e){var n=this._relativeTime[t>0?"future":"past"];return"function"==typeof n?n(e):n.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",preparse:function(t){return t},postformat:function(t){return t},week:function(t){return X(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),ne=function(e,n,i,r){return"boolean"==typeof i&&(r=i,i=t),J({_i:e,_f:n,_l:i,_strict:r,_isUTC:!1})},ne.utc=function(e,n,i,r){var o;return"boolean"==typeof i&&(r=i,i=t),o=J({_useUTC:!0,_isUTC:!0,_l:i,_i:e,_f:n,_strict:r}).utc()},ne.unix=function(t){return ne(1e3*t)},ne.duration=function(t,e){var n,i,r,s=t,a=null;return ne.isDuration(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(s={},e?s[e]=t:s.milliseconds=t):(a=me.exec(t))?(n="-"===a[1]?-1:1,s={y:0,d:g(a[le])*n,h:g(a[ue])*n,m:g(a[de])*n,s:g(a[he])*n,ms:g(a[pe])*n}):(a=ve.exec(t))&&(n="-"===a[1]?-1:1,r=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*n},s={y:r(a[2]),M:r(a[3]),d:r(a[4]),h:r(a[5]),m:r(a[6]),s:r(a[7]),w:r(a[8])}),i=new o(s),ne.isDuration(t)&&t.hasOwnProperty("_lang")&&(i._lang=t._lang),i},ne.version=re,ne.defaultFormat=Ie,ne.updateOffset=function(){},ne.lang=function(t,e){var n;return t?(e?C(x(t),e):null===e?(T(t),t="en"):fe[t]||E(t),n=ne.duration.fn._lang=ne.fn._lang=E(t),n._abbr):ne.fn._lang._abbr},ne.langData=function(t){return t&&t._lang&&t._lang._abbr&&(t=t._lang._abbr),E(t)},ne.isMoment=function(t){return t instanceof r},ne.isDuration=function(t){return t instanceof o},ie=Ge.length-1;ie>=0;--ie)_(Ge[ie]);for(ne.normalizeUnits=function(t){return p(t)},ne.invalid=function(t){var e=ne.utc(0/0);return null!=t?s(e._pf,t):e._pf.userInvalidated=!0,e},ne.parseZone=function(t){return ne(t).parseZone()},s(ne.fn=r.prototype,{clone:function(){return ne(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var t=ne(this).utc();return 0<t.year()&&t.year()<=9999?P(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):P(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return k(this)},isDSTShifted:function(){return this._a?this.isValid()&&h(this._a,(this._isUTC?ne.utc(this._a):ne(this._a)).toArray())>0:!1},parsingFlags:function(){return s({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(t){var e=P(this,t||ne.defaultFormat);return this.lang().postformat(e)},add:function(t,e){var n;return n="string"==typeof t?ne.duration(+e,t):ne.duration(t,e),l(this,n,1),this},subtract:function(t,e){var n;return n="string"==typeof t?ne.duration(+e,t):ne.duration(t,e),l(this,n,-1),this},diff:function(t,e,n){var i,r,o=S(t,this),s=6e4*(this.zone()-o.zone());return e=p(e),"year"===e||"month"===e?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-ne(this).startOf("month")-(o-ne(o).startOf("month")))/i,r-=6e4*(this.zone()-ne(this).startOf("month").zone()-(o.zone()-ne(o).startOf("month").zone()))/i,"year"===e&&(r/=12)):(i=this-o,r="second"===e?i/1e3:"minute"===e?i/6e4:"hour"===e?i/36e5:"day"===e?(i-s)/864e5:"week"===e?(i-s)/6048e5:i),n?r:a(r)},from:function(t,e){return ne.duration(this.diff(t)).lang(this.lang()._abbr).humanize(!e)},fromNow:function(t){return this.from(ne(),t)},calendar:function(){var t=S(ne(),this).startOf("day"),e=this.diff(t,"days",!0),n=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){return y(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=V(t,this.lang()),this.add({d:t-e})):e},month:function(t){var e,n=this._isUTC?"UTC":"";return null!=t?"string"==typeof t&&(t=this.lang().monthsParse(t),"number"!=typeof t)?this:(e=this.date(),this.date(1),this._d["set"+n+"Month"](t),this.date(Math.min(e,this.daysInMonth())),ne.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(t){switch(t=p(t)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),this},endOf:function(t){return t=p(t),this.startOf(t).add("isoWeek"===t?"week":t,1).subtract("ms",1)},isAfter:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)>+ne(t).startOf(e)},isBefore:function(t,e){return e="undefined"!=typeof e?e:"millisecond",+this.clone().startOf(e)<+ne(t).startOf(e)},isSame:function(t,e){return e=e||"ms",+this.clone().startOf(e)===+S(t,this).startOf(e)},min:function(t){return t=ne.apply(null,arguments),this>t?this:t},max:function(t){return t=ne.apply(null,arguments),t>this?this:t},zone:function(t){var e=this._offset||0;return null==t?this._isUTC?e:this._d.getTimezoneOffset():("string"==typeof t&&(t=A(t)),Math.abs(t)<16&&(t=60*t),this._offset=t,this._isUTC=!0,e!==t&&l(this,ne.duration(e-t,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(t){return t=t?ne(t).zone():0,(this.zone()-t)%60===0},daysInMonth:function(){return m(this.year(),this.month())},dayOfYear:function(t){var e=se((ne(this).startOf("day")-ne(this).startOf("year"))/864e5)+1;return null==t?e:this.add("d",t-e)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(t){var e=X(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==t?e:this.add("y",t-e)},isoWeekYear:function(t){var e=X(this,1,4).year;return null==t?e:this.add("y",t-e)},week:function(t){var e=this.lang().week(this);return null==t?e:this.add("d",7*(t-e))},isoWeek:function(t){var e=X(this,1,4).week;return null==t?e:this.add("d",7*(t-e))},weekday:function(t){var e=(this.day()+7-this.lang()._week.dow)%7;return null==t?e:this.add("d",t-e)},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},get:function(t){return t=p(t),this[t]()},set:function(t,e){return t=p(t),"function"==typeof this[t]&&this[t](e),this},lang:function(e){return e===t?this._lang:(this._lang=E(e),this)}}),ie=0;ie<Fe.length;ie++)K(Fe[ie].toLowerCase().replace(/s$/,""),Fe[ie]);K("year","FullYear"),ne.fn.days=ne.fn.day,ne.fn.months=ne.fn.month,ne.fn.weeks=ne.fn.week,ne.fn.isoWeeks=ne.fn.isoWeek,ne.fn.toJSON=ne.fn.toISOString,s(ne.duration.fn=o.prototype,{_bubble:function(){var t,e,n,i,r=this._milliseconds,o=this._days,s=this._months,c=this._data;c.milliseconds=r%1e3,t=a(r/1e3),c.seconds=t%60,e=a(t/60),c.minutes=e%60,n=a(e/60),c.hours=n%24,o+=a(n/24),c.days=o%30,s+=a(o/30),c.months=s%12,i=a(s/12),c.years=i},weeks:function(){return a(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*g(this._months/12)},humanize:function(t){var e=+this,n=G(e,!t,this.lang());return t&&(n=this.lang().pastFuture(e,n)),this.lang().postformat(n)},add:function(t,e){var n=ne.duration(t,e);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(t,e){var n=ne.duration(t,e);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(t){return t=p(t),this[t.toLowerCase()+"s"]()},as:function(t){return t=p(t),this["as"+t.charAt(0).toUpperCase()+t.slice(1)+"s"]()},lang:ne.fn.lang,toIsoString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),r=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(n?n+"D":"")+(i||r||o?"T":"")+(i?i+"H":"")+(r?r+"M":"")+(o?o+"S":""):"P0D"}});for(ie in He)He.hasOwnProperty(ie)&&(te(ie,He[ie]),Z(ie.toLowerCase()));te("Weeks",6048e5),ne.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},ne.lang("en",{ordinal:function(t){var e=t%10,n=1===g(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),_e?(module.exports=ne,ee(!0)):"function"==typeof define&&define.amd?define("moment",function(e,n,i){return i.config&&i.config()&&i.config().noGlobal!==!0&&ee(i.config().noGlobal===t),ne}):ee()}).call(this);


/* :asset_packager_compatibility, 'config/asset_packages.yml' @ 1425075658 */
/* public/javascripts/jquery_global/sticky.coffee @ 1425075658 */
(function(){$.fn.sticky_container=function(t){var e,n,i,r,o,s,a,c,l,u,d,h,p,f,_,g,m=this;return null==t&&(t={}),l=this.offset(),g=$(window),c=null!=t.padding?t.padding:0,h=t.sticky_class||"stuck",o=t.bottom_class||"bottomed",d=t.sticky_callback,u=t.static_callback,n=t.before_stick,r=t.before_unstick,e=t.before_bottom,i=t.before_unbottom,t.unstick_after&&(_=$(t.unstick_after)),t.dont_override_elem&&(a=$(t.dont_override_elem)),p=!1,s=!1,f=function(){var t,f,v,y,b,w;return w=g.scrollTop(),b=w>l.top-c,_&&(b?(t=_.offset().top+_.height(),w+g.height()>t?(b=!1,s||("function"==typeof e&&e(m),s=!0,o&&m.addClass(o))):s&&("function"==typeof i&&i(m),s=!1,o&&m.removeClass(o))):s&&("function"==typeof i&&i(m),s=!1,o&&m.removeClass(o))),a&&b&&(y=a.offset().top,f=w+m.height()-y,f>0?m.css("top",-f+38):m.css("top",38)),v=!1,void(b?(p||("function"==typeof n&&n(m),m.addClass(h),p=!0,v=!0),"function"==typeof d&&d(m,v)):(p&&("function"==typeof r&&r(m),m.removeClass(h),p=!1,v=!0),"function"==typeof u&&u(m,v)))},this.on("Scribd:update_root",function(){return l=m.offset()}),this.on("Scribd:restick",f),g.on("scroll resize",f),this}}).call(this);


/* public/javascripts/newhome/sliding.coffee @ 1425075658 */
(function(){Scribd.UI||(Scribd.UI={}),Scribd.UI.PageDots=function(){function t(t,e){this.total_pages=t,this.per_page=null!=e?e:1,this.container=$(this.template).css({width:this.total_pages*this.dot_size*this.per_page+"px"}),this.fill=this.container.find(".fill"),this.current_page=1,this.update_fill()}return t.prototype.dot_size=12,t.prototype.template='<div class="page_picker">\n  <div class="fill"></div>\n  <div class="dots"></div>\n</div>',t.prototype.update_fill=function(){return this.fill.stop().animate({left:(this.current_page-1)*this.dot_size*this.per_page+"px",width:this.per_page*this.dot_size+"px"},"fast")},t.prototype.goto_page=function(t){return this.current_page=t,this.update_fill()},t.prototype.is_first=function(){return 1===this.current_page},t.prototype.is_last=function(){return this.current_page===this.total_pages},t}(),Scribd.UI.SlidingList=function(){function t(t){this.container=$(t),this.container.data("list",this),this.sliding=this.container.find(".sliding_content"),this.list_content=this.container.find(".list_content"),this.page=1,this.calculate_pages(),this.num_pages>1&&this.PageDots&&(this.dots=new this.PageDots(this.num_pages),this.container.find(".list_dots").append(this.dots.container)),this.goto_page(1)}return t.prototype.speed="fast",t.prototype.PageDots=Scribd.UI.PageDots,t.prototype.calculate_pages=function(){var t,e,n,i,r;for(this.calculate_height(),e=0,r=this.sliding.children(),n=0,i=r.length;i>n;n++)t=r[n],e+=$(t).outerWidth(!0);return this.sliding.width(e),this.page_width=this.sliding.parent().width(),this.num_pages=Math.ceil(e/this.page_width)},t.prototype.calculate_height=function(){return this.list_content.height(this.sliding.find(".document_cell:first").outerHeight(!0))},t.prototype.page_left=function(){return this.goto_page((this.page-2+this.num_pages)%this.num_pages+1)},t.prototype.page_right=function(){return this.goto_page(this.page%this.num_pages+1)},t.prototype.page_offset=function(t){return this.page_width*(t-1)},t.prototype.goto_page=function(t){var e,n;return e=Math.max(1,Math.min(this.num_pages,t)),this.sliding.animate({marginLeft:-this.page_offset(e)},this.speed),null!=(n=this.dots)&&n.goto_page(e),this.page=e,this.container.toggleClass("on_first_page",1===e).toggleClass("on_last_page",e===this.num_pages)},t}()}).call(this);


/* public/javascripts/reading_progress.coffee @ 1425075658 */
(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Scribd.ReadingProgress=function(){function t(t){var n,i,r,o=this;null==t&&(t={}),void 0===t.scroll_watch&&(t.scroll_watch=!0),void 0===t.notify_on_external_progress_change&&(t.notify_on_external_progress_change=!0),t.huge_jump=t.huge_jump||1,t.num_valid_scrolls_after_jump=t.num_valid_scrolls_after_jump||2,this.watch_scroll=t.scroll_watch,this.notify_on_external_progress_change=t.notify_on_external_progress_change,this.debounce_time=this.constructor.debounce_time,this.state_of_jump_huge_amount=!1,this.curr_times_scroll_after_big_jump=0,this.definition_of_huge_jump=t.huge_jump,this.num_times_to_scroll_after_big_jump=t.num_valid_scrolls_after_jump,this.progress_update_at=Date.now(),this.current_reading_progress=null!=(n=Scribd.current_doc)?n.reading_progress:void 0,this.encoded_device_id=t.device_id||(null!=(i=Scribd.current_doc)&&null!=(r=i.reading_history)?r.device_id:void 0),this.progress_check_interval=t.progress_check_interval||3e4,this.watch_scroll&&(this.scroll_jump_watcher=new e(this),this.setup_listeners()),this.notify_on_external_progress_change&&(this.external_progress_notifier=setInterval(function(){return o.notifiy_external_progress_change(null,o.progress_check_interval)},this.progress_check_interval))}var e;return e=function(){function t(t){this.reading_progress=t,this.starting_jump_point=null,this.ending_jump_point=null,this.watch_interval_id=null}return t.prototype.watch=function(){var t=this;return this.starting_jump_point=this.reading_progress.current_top_position(),this.watch_interval_id=setInterval(function(){return t.ending_jump_point=t.reading_progress.current_top_position()},100)},t.prototype.running_watch=function(){return null!==this.watch_interval_id},t.prototype.stop_watching=function(){return clearInterval(this.watch_interval_id),this.watch_interval_id=null},t.prototype.distance_jumped=function(){return Math.abs(this.ending_jump_point-this.starting_jump_point)},t}(),t.url="/reading-history/public/update_progress",t.debounce_time=Scribd.ServerOptions&&Scribd.ServerOptions.reading_history_scroll_timeout&&parseInt(Scribd.ServerOptions.reading_history_scroll_timeout),t.prototype.is_disabled=function(){var t;return!(null!=(t=Scribd.current_doc)?t.reading_history:void 0)||Scribd.named_current_user_sync().masked_admin||this.watch_scroll&&+this.debounce_time<=0},t.prototype.current_top_position=function(){var t;return t=docManager.getVisibleBBox(),t.top?t.top.toFixed(2):void 0},t.prototype.ping_reading_progress=function(t,e){var n,i,r=this;if(!this.is_disabled()&&t&&t>1.1&&t!==this.last_pinged_progress)return this.last_pinged_progress=t,n={reading_progress:t},void 0!==e&&(n.char_offset=e),i=Date.utcEpoch(),$.post(this.constructor.url,$.extend({},this.reading_history_ping_opts(),n),function(){return r.progress_update_at=Date.now(),r.current_reading_progress=[t,i,e,r.device_id()]},"json")},t.prototype.start_external_progress_notifier=function(){var t=this;return this.stop_external_progress_notifier(),this.external_progress_notifier=setInterval(function(){return t.notifiy_external_progress_change(null,t.progress_check_interval)},this.progress_check_interval)},t.prototype.stop_external_progress_notifier=function(){return this.external_progress_notifier&&clearInterval(this.external_progress_notifier),this.external_progress_notifier=null},t.prototype.notifiy_external_progress_change=function(t,e){var n=this;return null==e&&(e=2e5),this.is_disabled()?void 0:Date.now()-this.progress_update_at>e?$.get("/documents/"+Scribd.current_doc.id+"/progress").success(function(e){var i;if(e&&e.length>1){if(n.current_reading_progress){if(e[3]&&e[3]===n.encoded_device_id)return;if(n.current_reading_progress[2]&&e[2]&&n.current_reading_progress[2]>-1&&e[2]>-1){if(Math.abs(n.current_reading_progress[2]-e[2])<500)return}else if(Math.abs(n.current_reading_progress[0]-e[0])<1)return;return i=[{device_id:n.device_id(e[3]),device_name:n.device_name(e[3]),progress:e},{device_id:n.device_id(),device_name:n.device_name(),progress:n.current_reading_progress}],t&&t(i[0],i[1]),$(window).trigger("scribd.doc.external_progress_changed",i)}return i=[{device_id:n.device_id(e[3]),device_name:n.device_name(e[3]),progress:e},null],t&&t(i[0],i[1]),$(window).trigger("scribd.doc.external_progress_changed",i)}}):void 0},t.prototype.device_name=function(t){return null==t&&(t=this.encoded_device_id),t&&t.split("_")[0]},t.prototype.device_id=function(t){return null==t&&(t=this.encoded_device_id),t&&t.split("_")[1]},t.prototype.reading_history_ping_opts=function(){return Scribd.current_doc.reading_history},t.prototype.update_progress=function(){return this.ping_reading_progress(this.current_top_position())},t.prototype.setup_listeners=function(){var t=this;return $(document).on("scroll",function(){return t.scroll_jump_watcher.running_watch()||t.scroll_jump_watcher.watch(),t.scroll_watch()})},t.prototype.scroll_watch=_.debounce(function(){var t;return this.scroll_jump_watcher.stop_watching(),t=this.scroll_jump_watcher.distance_jumped()>this.definition_of_huge_jump,this.state_of_jump_huge_amount&&(this.curr_times_scroll_after_big_jump=t?0:this.curr_times_scroll_after_big_jump+1),this.state_of_jump_huge_amount&&!(this.curr_times_scroll_after_big_jump>=this.num_times_to_scroll_after_big_jump)||(this.state_of_jump_huge_amount=t,this.state_of_jump_huge_amount)?void 0:(this.curr_times_scroll_after_big_jump=0,this.update_progress())},t.debounce_time),t}(),Scribd.MobileReadingProgress=function(t){function n(t){this.doc_info=t}return e(n,t),n.prototype.is_disabled=function(){return Scribd.named_current_user_sync().masked_admin},n.prototype.reading_history_ping_opts=function(){return this.doc_info},n}(Scribd.ReadingProgress),Scribd.SectionizedReflowReadingProgress=function(t){function n(){n.__super__.constructor.apply(this,arguments),this.maxElement=null,this.prefix="buPe"}return e(n,t),n.prototype.get_top=function(t){var e;for(e=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetTop,t=t.offsetParent;return e},n.prototype.get_bottom=function(t){return this.add_bottom(t,this.get_top(t))},n.prototype.add_bottom=function(t,e){try{e+=t.offsetHeight}catch(n){}return e},n.prototype.get_max_element_index=function(){var t,e;if(null===this.maxElement){for(e=1024,t=0;0!==e;){for(;null!==document.getElementById(this.prefix+(e+t));)t+=e;e>>=1}this.maxElement=t}return this.maxElement},n.prototype.find_first_element_below=function(t){var e,n,i,r,o,s;for(s=0,o=this.get_max_element_index()+1,i=o>>1,r=o;i!==r;)e=document.getElementById(this.prefix+i),n=this.get_top(e),n>t?o=i:s=i,r=i,i=s+o>>1;return[e,i]},n.prototype.find_first_element_above=function(t){var e,n,i,r,o,s;for(s=0,o=this.get_max_element_index()+1,i=o>>1,r=o;i!==r;)e=document.getElementById(this.prefix+i),n=this.get_top(e),t>=n?s=i:o=i,r=i,i=s+o>>1;return[e,i]},n.prototype.derive_half_visible_ratio=function(t,e){var n,i,r;return i=this.get_top(t),r=this.get_bottom(t,i),n=(e-i)/(r-i)},n.prototype.current_top_position=function(){var t,e,n,i;return n=$(window).scrollTop(),i=this.find_first_element_below(n),t=i[0],e=i[1],e+=this.derive_half_visible_ratio(t,n)},n.prototype.store_rat_read=function(t,e){return window.$rat?window.$rat("epub_read",[t,e]):void 0},n.prototype.update_progress=function(){var t,e,n,i,r,o,s,a,c,l;return s=$(window).scrollTop(),a=s+window.innerHeight,c=this.find_first_element_below(s),t=c[0],r=c[1],l=this.find_first_element_above(a),e=l[0],o=l[1],n=this.derive_half_visible_ratio(t,s),i=this.derive_half_visible_ratio(e,a),r+=n,o+=i,isNaN(r)||isNaN(o)||0>n||n>1||0>i||i>1?void 0:(this.store_rat_read(r,o),this.ping_reading_progress(r),this.debug?(t.style.backgroundColor="#00ff00",null!==this.last_top&&this.last_top!==t&&(last_top.style.backgroundColor="#ffffff"),this.last_top=t,e.style.backgroundColor="#ff8080",null!==this.last_bottom&&this.last_bottom!==e&&(this.last_bottom.style.backgroundColor="#ffffff"),this.last_bottom=e):void 0)},n}(Scribd.ReadingProgress)}).call(this);


/* :files, 'public/javascripts/shared', ... @ (none) */


/* :files, 'app/views', ... @ (none) */


/* :files, 'app/views', ... @ 1425075610 */
/* app/views/shared/recommendation_tracking.coffee @ 1425075610 */
(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Scribd.RecommendationTracking=function(){function e(){throw"Scribd.RecommendationTracking is not instantiatable"}return e.Module=function(){function e(e,n){var i=this;this.opts=null!=n?n:{},this.ready=t(this.ready,this),this.container=$(e),this.opts.page_name&&this.opts.compilation_id?Scribd.RecommendationTracking.page_view_deferred(this.opts.compilation_id,this.opts.page_name).done(function(t){return i.ready(t,i.opts.page_name)}):this.container.on("scribd:setup_tracking",function(t,e,n,r){return i.ready(e,n,r)})}return e.prototype.setup_inview_tracking=function(){var t=this;return null==this.tracking?"undefined"!=typeof console&&null!==console?console.error("missing tracking"):void 0:(this.container.one("inview",function(){var e;return Scribd.RecommendationTracking.track_module_view(t.tracking.view_id,t.tracking.module_id,t.tracking.page_name,t.tracking.index),"function"==typeof(e=t.opts).on_in_view?e.on_in_view(t.tracking):void 0}),Scribd.RecommendationTracking.trigger_inview_check())},e.prototype.ready=function(t,e,n){var i,r;return i=this.opts.module_id||this.container.data("track_uuid"),this.tracking={page_name:e,view_id:t,module_id:i,index:n},"function"==typeof(r=this.opts).on_tracking&&r.on_tracking(this.tracking),this.setup_inview_tracking()},e}(),e.page_view_deferred=function(t,n){var i,r;return e._view_id_deferred||(e._view_id_deferred={}),r=""+t+" "+n,i=e._view_id_deferred[r],i||(i=$.Deferred(),e._view_id_deferred[r]=i,Scribd.RecommendationTracking.track_page_view(t,n,function(t){return i.resolve(t)})),i},e.track_page_view=function(t,e,n){return Scribd.logging_enabled&&console.debug("page view",arguments),$rat.root().withVid(function(i){var r,o,s,a;return s=new Math.seedrandom,o=function(){var t,e;for(e=[],r=t=1;16>=t;r=++t)e.push(Math.floor(16*s()).toString(16));return e}().join(""),a=""+i+o,$rat("page_view",{event_name:"page_view",view_id:a,compilation_id:t,page:e}),"function"==typeof n?n(a):void 0})},e.track_module_view=function(t,e,n,i){return Scribd.logging_enabled&&console.debug("module view",arguments),$rat("module_visibile",{event_name:"module_visible",view_id:t,module_id:e,widget:n,index:i})},e.track_obj_view=function(t,e,n,i,r,o){return null==o&&(o=null),Scribd.logging_enabled&&console.debug("obj view",arguments),$rat("recommendation_visibile",{event_name:"recommendation_visible",view_id:t,rec_id:e,rec_obj_id:n,rec_obj_type:i,index:r,module_id:o})},e.trigger_inview_check=function(){return this.trigger_inview_check=_.debounce(function(){return $.event.special.inview.run()},0),this.trigger_inview_check()},e}.call(this)}).call(this);


/* app/views/word/delete.coffee @ 1425075610 */
(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Scribd.Word||(Scribd.Word={}),Scribd.Word.Delete=function(t){function n(){n.__super__.constructor.apply(this,arguments),this.fit_to_width(),Scribd.hook_tooltips(this.container),this.container.find("[data-default_text]").placeholder_text(),new Scribd.UI.FilteredDocumentPage(this.container)}return e(n,t),n}(Scribd.UI.ObjectGrid)}).call(this);


/* app/views/read2/_seo_shared.coffee @ 1425075610 */
(function(){Scribd.SeoShared=function(){function t(){}return t.quote_duration=5e3,t.display_interval=moment.duration(1,"days"),t.setup_assignment=function(){var t,e;if(Scribd.eligible_for_seo_roadblock&&(document.referrer.match(/google|bing|yahoo/i)||window.location.hash.match(/\bscribd\b/))&&(t=new CookieJar({path:"/",expires:this.display_interval.asSeconds()}),!t.get("seo_ld")||(e=moment(t.get("seo_ld")),moment().isAfter(e.add(this.display_interval)))))return t.put("seo_ld",moment()),"promo"},t.setup_quotes=function(t){var e,n,i,r=this;return i=null,e=t.find(".single_quote"),(n=function(){return i=setTimeout(function(){var t;return t=e.filter(".fade_in").next(),e.removeClass("fade_in").addClass("fade_out"),t.length||(t=e.filter(":first")),t.removeClass("fade_out").addClass("fade_in"),n()},r.quote_duration)})()},t.setup_carousel=function(t){var e;return t=$(t),e=$("<div class='scroller'></div>"),e.append(t.children().detach()),t.append(e)},t}()}).call(this);


/* app/views/read2/store/buy_doc_manager.coffee @ 1425075610 */
(function(){Scribd.UI.BuyDocManager=function(){function t(t){this.buy_url=t}return t.prototype.track_event=Scribd.make_tracker("payments"),t.prototype.setup_buy_buttons=function(t){var e,n=this;return e=$(document),e.ready(function(){return Scribd.ServerOptions&&Scribd.ServerOptions.payments_store_disabled===!0?$(".missing_page_buy_button").hide():(Scribd.current_doc.show_archive_paywall?$(".missing_page_buy_link .btn_inner").text(t):$(".missing_page_buy_button").hide(),e.dispatch("click","paid",{missing_page_buy_button:Scribd.current_doc.is_pmp?n.get_premium_callback("missing_page_signup"):Scribd.current_doc.can_purchase?n.get_buy_callback("button:click"):Scribd.current_doc.view_restricted?n.get_archive_callback("missing_page_signup"):void 0}))})},t.prototype.setup_missing_page_title=function(t){var e;return e=$(document),e.ready(function(){return Scribd.current_doc.is_pmp||Scribd.current_doc.can_purchase||Scribd.current_doc.show_archive_paywall?$(".missing_page_number_title").text(t):void 0})},t.prototype.get_buy_callback=function(t){var e=this;return function(){var n;return n=function(){return e.track_event("newdoc/store","buy_now"+t),window.location.href=e.buy_url},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(n):n(),!1}},t.prototype.get_subscription_callback=function(t,e){var n=this;return function(){var i,r,o;return i={context:Scribd.current_doc.signup_context,page:"read",action:t,platform:"web",logged_in:!!Scribd.logged_in},i=encodeURIComponent(JSON.stringify(i)),r="doc="+Scribd.current_doc.id+"&metadata="+i,o=function(){return n.track_event("newdoc",""+Scribd.current_doc.signup_context+":missing_page_button:click"),window.location.href=e+"?"+r},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(o):Scribd.Lightbox.remote_open("join_today_lb","https://www.scribd.com/archive/login?"+r,Scribd.toolbar_params(),Scribd.JoinTodayLightbox),!1}},t.prototype.get_premium_callback=function(t){return this.get_subscription_callback(t,"/archive/pmp_checkout")},t.prototype.get_archive_callback=function(t){return this.get_subscription_callback(t,"/archive/plans")},t}()}).call(this);


/* :class_inlines, 'app/views', ... @ 1425075610 */
/* app/views/shared/reading_progress_notification_lightbox.coffee @ 1425075610 */
(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Scribd.ReadingProgressNotificationLightbox=function(t){function n(){var t=this;n.__super__.constructor.apply(this,arguments),this.template=_.template($("#reading_progress_notificaton_template").html()),this.message={},this.messageContainer=this.container.find(".message"),this.container.find(".ok_btn").on("click",function(){return t.container.trigger("scribd.ui.reading_progress_notification_lighbox.ok",[t.progress]),t.close()}),this.container.find(".no_btn").on("click",function(){return t.container.trigger("scribd.ui.reading_progress_notification_lighbox.cancel",[t.progress]),t.close()})}return e(n,t),n.prototype.show=function(){return n.__super__.show.apply(this,arguments)},n.prototype.redraw=function(){return this.messageContainer.html(this.template(this.message)),this.set_position(),this},n.prototype.setMessage=function(t){var e,n,i,r,o,s,a;return e=t.current_page,o=t.other_page,r=t.new_progress,i=function(){switch(r.device_name){case"a":return"your Android device";case"kf":return"your Kindle Fire";case"iphone":return"your iPhone";case"ipad":return"your iPad";case"c":case"ff":case"ie":case"o":case"s":return"another browser";default:return"another device"}}(),s=moment.utc(1e3*r.progress[1]),n=moment().utc().diff(s,"days"),a=0>=n?"earlier today":1>=n?"yesterday":7>=n?"last "+s.format("dddd"):13>=n?"a week ago":""+n+" days ago",this.message={current_page:e,other_page:o,device_name:i,time:a},this},n.prototype.setProgress=function(t){return this.progress=t,this},n}(Scribd.Lightbox)}).call(this);


/* app/views/shared/my_library_reading_states.coffee @ 1425075610 */
(function(){Scribd.Shared.MyLibraryReadingStates=function(){function t(t,e){var n=this;this.container=t,this.opts=null!=e?e:{},this.default_opts(),this.container=$(this.container),Scribd.Shared.MyLibraryReadingStates.instance=this,this.opts.masked_admin||(this.initial_state=this.opts.current_state,this.current_state=this.initial_state,_.defer(function(){return n.opts.currently_reading_active&&n.init_currently_reading_timer(),n.opts.finished_active&&!n.opts.is_preview&&n.opts.is_comic?n.init_end_of_reading_listener():void 0}))}return t.prototype.THRESHOLDS={book:18e4,audiobook:1,comic:18e4,"default":18e4},t.prototype.default_opts=function(){return this.opts=_.extend({current_state:0,finished_state:-1,reading_state:-2,flash_duration:5e3,currently_reading_active:!0,finished_active:!0},this.opts)},t.prototype.state_name=function(){switch(this.current_state){case this.opts.reading_state:return"currently_reading";case this.opts.finished_state:return"finished";default:return this.current_state}},t.prototype.init_currently_reading_timer=function(){var t,e=this;return t=this.THRESHOLDS.hasOwnProperty(this.opts.document_type)?this.THRESHOLDS[this.opts.document_type]:this.THRESHOLDS["default"],this.timer=setTimeout(function(){return Scribd.Epub?$(document.body).one("scribd:epub_progress",function(){return null==e.opts.current_state&&e.show_flash_template("currently_reading_flash"),e.add_to_currently_reading_state()}):e.opts.is_audiobook?e.add_to_currently_reading_state():$(window).one("scroll",function(){return e.add_to_currently_reading_state()})},t)},t.prototype.init_end_of_reading_listener=function(){var t,e=this;return t=function(){return e.finished||e.opts.current_state===e.opts.finished_state?void 0:(e.add_to_finished_state(),e.show_flash_template("finished_reading_flash"))},Scribd.epub_book_page&&Scribd.epub_book_page.reflow.register_end_of_content_callback(function(e){return e?t():void 0}),Scribd.epub_doc_page?Scribd.epub_doc_page.reflow.register_end_of_content_callback(function(e){return e?t():void 0}):void 0},t.prototype.add_to_currently_reading_state=function(){return Scribd.Bookmarks.update_bookmarks_states({document_ids:[this.opts.document_id],state:this.opts.reading_state}),this.container.trigger("scribd:state_changed",this.state_name())},t.prototype.add_to_finished_state=function(){return this.finished=!0,Scribd.Bookmarks.update_bookmarks_states({document_ids:[this.opts.document_id],state:this.opts.finished_state}),this.container.trigger("scribd:state_changed",this.state_name())},t.prototype.revert_state=function(){var t=this;return Scribd.Bookmarks.update_bookmarks_states({document_ids:[this.opts.document_id],state:this.opts.current_state,complete:function(){return flasher.dismiss(),t.finished=t.opts.current_state===t.opts.finished_state,t.container.trigger("scribd:state_changed",t.state_name())}})},t.prototype.remove_bookmark=function(){var t=this;return Scribd.Bookmarks.remove_bookmark(this.opts.document_id,{complete:function(){return t.container.trigger("scribd:bookmark_removed"),flasher.dismiss()}})},t.prototype.show_flash_template=function(t,e){var n,i;return null==e&&(e={}),i=_.template($("#tpl_"+t).html()),n=i(e),this.show_flash(n)},t.prototype.show_flash=function(t,e){var n,i,r=this;return null==e&&(e="info"),n=$(".flash_container"),i=new Scribd.Flasher(n,{raw:!0,duration:this.opts.flash_duration}),i.show(e,t),n.dispatch("click",{remove_bookmark:function(){return null!=r.opts.current_state?r.revert_state():r.remove_bookmark()}})},t}()}).call(this);


/* app/views/shared/carousels/carousel.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Scribd.UI.Carousel=function(){function e(t,e){var n,i,r,o,s,a,c=this;this.container=t,this.opts=null!=e?e:{},Scribd.UI.Carousel.carousels.push(this),this.container=$(this.container).data("carousel",this),this.images_loaded=!this.container.data("lazy_images"),this.container.hasClass("cache_widget")&&(this.container=this.container.find(".carousel_widget")),this.carousel=this.container.find(".carousel"),this.scrolling=this.carousel.find(".carousel_scrolling"),this.container.delegate_tracking("click",this.opts.page||"carousel"),n=this.check_items_inview,this.check_items_inview=_.debounce(function(){return n.apply(c)},500),this.container.on("scribd:reshape_carousel",function(){return c.reshape()}),new Scribd.RecommendationTracking.Module(this.container,{on_tracking:function(t){return c.tracking=t,c.set_view_id()},on_in_view:function(){return c.check_items_inview()}}),this.setup_events(),this.setup_scrollbar(),this.setup_flags(),this.setup_paddles(),this.reshape(),this.images_loaded||(s=this.container.offset().top,a=$(window),i=!1,o=function(){return a.scrollTop()+a.height()>s?(i=!0,c.show_visible_images(),a.off("scroll resize",o)):void 0},r=function(){return i?c.show_visible_images():void 0},a.on("resize",_.debounce(r,100)),a.on("scroll resize",o),_.defer(o))}return e.prototype.anim_speed=200,e.prototype.easing="ease_in_out_cubic",e.prototype.images_loaded=!1,e.prototype.setup_paddles=function(){var t=this;return this.container.on("mouseenter",function(){var e,n,i,r;for(r=Scribd.UI.Carousel.carousels,n=0,i=r.length;i>n;n++)e=r[n],e.show_paddles(!1);return t.show_paddles(!0)})},e.prototype.setup_events=function(){var t=this;if(!this.opts.disable_click)return this.container.dispatch("click",{carousel_prev:function(){return t.on_interact(),t.scroll_items(-t.cells_to_scroll())},carousel_next:function(){return t.on_interact(),t.scroll_items(t.cells_to_scroll())}})},e.prototype.setup_scrollbar=function(){var e,n,i=this;return this.scrollbar=this.container.find(".carousel_scrollbar"),e=this.scrollbar.find(".carousel_scrollbar_thumb"),n=_.debounce(function(t,e,n){return i.container.toggleClass("on_first_page",0===t),i.container.toggleClass("on_last_page",t+e===n)},100),this.update_scrollbar=function(){var t,r,o;return t=i.scroll_width(),o=i.scrolling.width(),r=i.scrolling.scrollLeft(),n(r,o,t),e.css({left:""+Math.floor(r/t*o)+"px",right:""+(o-Math.floor((r+o)/t*o))+"px"})},this.scrolling.on("scroll",function(){return i.on_interact(),i.update_scrollbar(),i.check_items_inview()}),this.update_scrollbar(),t(e,{start:function(){return i.container.addClass("dragging")},stop:function(){return i.container.removeClass("dragging")},move:function(t){var e;return e=i.scroll_width()/i.scrolling.width(),i.scrolling.scrollLeft(i.scrolling.scrollLeft()+t*e)}})},e.prototype.scroll_items=function(t){var e,n,i,r,o;return o=this.cell_width(),0===o||this.scrolling.is(":animated")||(e=this.scrolling.scrollLeft(),i=Math.floor(e/o+.1)*o+t*o,n=this.scroll_width()-this.scrolling.width(),i=Math.max(0,Math.min(i,n)),15>n-i&&(i=n),15>i&&(i=0),e===i)?void 0:(r=Math.floor(this.anim_speed*Math.abs((e-i)/o)),this.scrolling.animate({scrollLeft:i},{duration:r,easing:"smoothstep"}))},e.prototype.cells_to_scroll=function(){var t;return t=this.carousel.width()/this.cell_width(),1.5>=t?1:Math.ceil(t/2+1)},e.prototype.cell_width=function(){return this.carousel.find(".object_cell:first").outerWidth(!0)},e.prototype.scroll_width=function(){var t;return(null!=(t=this.scrolling[0])?t.scrollWidth:void 0)||0},e.prototype.reshape=function(){var t,e;return t=this.scroll_width(),e=this.scrolling.width(),this.container.toggleClass("has_no_scrolling",5>t-e),"function"==typeof this.update_scrollbar?this.update_scrollbar():void 0},e.prototype.show_visible_images=function(){var t,e,n,i,r,o;if(!this.images_loaded){for(t=this.scrolling.width(),r=this.carousel.find("[data-thumb_url]"),o=[],n=0,i=r.length;i>n&&(e=r[n],e=$(e),e.position().left<t);n++)o.push(this.show_image($(e)));return o}},e.prototype.show_all_images=function(){var t,e,n,i,r;if(!this.images_loaded){for(this.images_loaded=!0,i=this.carousel.find("[data-thumb_url]"),r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(this.show_image($(t)));return r}},e.prototype.setup_flags=function(){var t,e,n,i,r,o;for(r=this.container.find(".document_cell.has_flag"),o=[],n=0,i=r.length;i>n;n++)e=r[n],t=$(e).find(".flag"),o.push(t.data("text")?t.text(t.data("text")):void 0);return o},e.prototype.show_image=function(t){var e,n;return e=t.find(".thumb"),e.length||(e=t),(n=e.data("thumb_url"))?(e.removeData("thumb_url"),window.location.hash.match(/\bdebug_images\b/)?(e.css({backgroundColor:"red"}),setTimeout(function(){return e.css({backgroundImage:"url('"+n+"')"})},500)):e.css({backgroundImage:"url('"+n+"')"})):void 0},e.prototype.show_paddles=function(t){return null==t&&(t=!0),this.container.toggleClass("ui_visible",!!t)},e.prototype.on_interact=function(){return this.on_interact=function(){},this.show_all_images(),Scribd.track_event(this.opts.page||"carousel","click","carousel:first_carousel_click")},e.prototype.set_view_id=function(){var t,e,n,i,r,o,s,a,c,l;if(!(null!=(a=this.tracking)?a.view_id:void 0))throw"missing tracking.view_id";for(i=this.container.data("rats_value_extra"),c=this.container.find(".document_cell"),l=[],o=0,s=c.length;s>o;o++)t=c[o],n=$(t).data("track_rats_value"),n&&(n.view_id=this.tracking.view_id,l.push(i?function(){var t;t=[];for(e in i)r=i[e],t.push(n[e]=r);return t}():void 0));return l},e.prototype.check_items_inview=function(){var t,e,n,i,r,o,s,a,c,l,u;if(null!=this.tracking){for(s=50,o=this.scrolling.width(),u=this.container.find(".document_cell .thumb"),n=c=0,l=u.length;l>c;n=++c)e=u[n],e=$(e),e.is(".visibility_tracked")||(r=e.position().left,a=e.width(),i=r+s>=0&&o>=r+a-s,i&&(t=e.closest(".document_cell").data(),Scribd.RecommendationTracking.track_obj_view(this.tracking.view_id,t.track_uuid,t.object_id,t.object_type,t.module_id),e.addClass("visibility_tracked")));return null}},e}(),Scribd.UI.Carousel.carousels=[],t=function(t,e){var n,i,r,o,s,a,c,l;return null==e&&(e={}),l="ontouchstart"in document,n=$(document.body),s=$("html"),a=0,c=0,o=function(){return n.removeClass("dragging"),t.removeClass("dragging"),s.off("mousemove touchmove",i),"function"==typeof e.stop?e.stop():void 0},i=function(t,n,i){var r,o;return r=n-a,o=i-c,a+=r,c+=o,"function"==typeof e.move?e.move(r,o):void 0},r=function(i,r,o){return n.is(".dragging")||("function"==typeof e.skip_drag?e.skip_drag(i):0)?void 0:(n.addClass("dragging"),t.addClass("dragging"),a=r,c=o,"function"==typeof e.start&&e.start(),!0)},l?t.on("touchstart",function(t){var e,n,a;return a=t.originalEvent.targetTouches[0],e=a.pageX,n=a.pageY,r(t,e,n)?(s.one("touchend",o),i=function(t){return function(i){var r;return r=i.originalEvent.targetTouches[0],e=r.pageX,n=r.pageY,t(i,e,n)}}(i),s.on("touchmove",i),!1):void 0}):t.on("mousedown",function(t){return r(t,t.pageX,t.pageY)?(s.one("mouseup",o),i=function(t){return function(e){return t(e,e.pageX,e.pageY)}}(i),s.on("mousemove",i)):void 0})},Scribd.UI.SquareCarousel=function(t){function n(t,i){this.container=t,this.opts=null!=i?i:{},this.center_contents=e(this.center_contents,this),n.__super__.constructor.apply(this,arguments),this.center_contents()}return i(n,t),n.prototype.center_contents=function(){var t,e,n,i,r,o,s,a,c;for(a=this.container.find(".content_layer .centered"),c=[],o=0,s=a.length;s>o;o++)t=a[o],t=$(t),n=t.closest(".content_layer"),i=n.height(),e=t.outerHeight(),r=Math.floor((i-e)/2),c.push(t.css("marginTop",""+r+"px"));return c},n}(Scribd.UI.Carousel)}).call(this);


/* app/views/login/_archive_login_lightbox.coffee @ 1425075610 */
(function(){Scribd.ArchiveLoginLightbox=function(){function t(t){var e=this;this.set_page(),$(t).on("click","a.skip_login",function(){return Scribd.track_event("login_lightbox","click",""+e.page+":login_lightbox:skip_login")})}return t.prototype.set_page=function(){var t;return this.page=window.location.pathname.split("/")[1],this.page||(this.page="home"),null!=(null!=(t=Scribd.current_doc)?t.signup_context:void 0)?this.page=""+this.page+"_"+Scribd.current_doc.signup_context:void 0},t}()}).call(this);


/* app/views/read2/show.coffee @ 1425075610 */
(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Scribd.Books=function(){function t(){}return t.get_buy_manager=function(){var t,e,n,i;if(Scribd.current_doc.buy_url)return this.buy_manager?this.buy_manager:(i=Scribd.current_doc,t=i.buy_url,e=i.missing_page_label,n=i.missing_page_title,this.buy_manager=new Scribd.UI.BuyDocManager(t),this.buy_manager.setup_buy_buttons(e),this.buy_manager.setup_missing_page_title(n),this.buy_manager)},t}(),Scribd.BaseReadPage=function(){function t(){}return t.prototype.setup_buy=function(){var t,e,n,i;if(Scribd.current_doc.buy_url)return i=Scribd.current_doc,t=i.buy_url,e=i.missing_page_label,n=i.missing_page_title,this.buy_manager=new Scribd.UI.BuyDocManager(t),this.buy_manager.setup_buy_buttons(e),this.buy_manager.setup_missing_page_title(n)},t.prototype.setup_events=function(){return $(document.body).on("scribd:show_notes",function(){return Scribd.ReadPage.overlay_panel.toggle(),Scribd.ReadPage.activity_list.container.find(".picker_item[data-value='notes']").click()})},t.prototype.toggle_reading_mode=function(t){return this._to_hide||(this._to_hide=$("#doc_toolbar ")),this._to_show||(this._to_show=this.container.find("#reading_mode_bar")),!this.container.is(":visible")||this._to_hide.is(":animated")||t===!0&&this.in_reading_mode||t===!1&&!this.in_reading_mode||!this.in_reading_mode&&!this.reading_mode_allowed()?void 0:(this.in_reading_mode=!this.in_reading_mode,this._to_hide.fadeToggle(!this.in_reading_mode),this._to_show.fadeToggle(this.in_reading_mode),$(".doc_banner").toggleClass("collapsed",this.in_reading_mode),$(document.body).toggleClass("reading_mode",this.in_reading_mode))},t.prototype.setup_overlay=function(){var t=this;return this.container.on("scribd:overlay_panel_show",function(){return t.toggle_reading_mode(!1),t.container.addClass("overlay_open")}),this.container.on("scribd:overlay_panel_hide",function(){return t.container.removeClass("overlay_open")})},t.prototype.tracking_name=function(){return""+(this.page_category||"read2")+":"+(this.page_name||"unknown")},t.prototype.send_tracking=function(){return this.opts.pmp_data&&"function"==typeof $rat&&$rat("pmp_read",this.opts.pmp_data),"function"==typeof $rat&&$rat("doc_view_mode",{value:"doc_view_mode",doc_id:Scribd.current_doc.id}),"undefined"!=typeof $rat&&null!==$rat&&$rat.root().flushEvents(),Scribd.track_event(this.page_category||"read2","hit",this.page_name||"hit",Scribd.named_current_user_sync()&&1||0),this.opts.pingback_url?this._send_pingback(this.opts.pingback_url.join("")):void 0},t.prototype._send_pingback=function(t){var e,n;if("undefined"!=typeof navigator&&null!==navigator&&null!=(n=navigator.userAgent)?!n.match(/Google (Web|Instant) Preview/):!0)return e={},document.referrer&&(e.referer=document.referrer),$.ajax({type:"POST",url:t,data:e,skip_csrf:!0})},t.prototype.fetch_data=function(){var t;return t=$(document.body),$.get(this.opts.data_url).done(function(e){return t.toggleClass("buy_disabled",!!e.disabled_store_sale&&Scribd.current_doc.is_paid),t.toggleClass("pmp_disabled",!!e.disabled_pmp_sale&&Scribd.current_doc.is_pmp),(Scribd.current_doc.is_pmp&&!e.disabled_pmp_sale||Scribd.current_doc.is_paid&&!e.disabled_store_sale)&&t.toggleClass("action_button_shown",!0),Scribd.current_doc.is_pmp&&!e.disabled_pmp_sale&&Scribd.current_doc.is_paid&&!e.disabled_store_sale&&t.toggleClass("buy_hidden",!0),e.disabled_store_sale&&t.trigger("scribd:buy_disabled",[e]),e.disabled_pmp_sale?t.trigger("scribd:pmp_disabled",[e]):void 0})},t.prototype.setup_print_handler=function(){var t,e,n;if(Scribd.current_doc.downloadable_for_premium_users)return t=function(t){return Scribd.track_event("newdoc","print","handle:"+t),Scribd.Lightbox.remote_open("print_dialog","/read/print_dialog",Scribd.toolbar_params())},"function"==typeof window.matchMedia&&window.matchMedia("print").addListener(_.debounce(function(){return t("match_media")},3e3,!0)),n=window.onbeforeprint,window.onbeforeprint=function(){return t("on_before_print"),"function"==typeof n&&n(),!1},e=navigator.platform.match(/Mac/),$(document).keydown(function(n){return n.keyCode==="P".charCodeAt(0)&&(e&&n.metaKey||!e&&n.ctrlKey)?(t("keydown"),!1):void 0})},t}(),Scribd.ReadPage=function(e){function i(e,n){var i;this.opts=n,this.setup_ads=t(this.setup_ads,this),this.container=$(e),this.doc_container=this.container.find("#doc_container"),this.fetch_data(),this.setup_footer(),this.setup_reading_mode(),this.setup_responsive(),this.setup_width(),this.setup_sticky_download(),this.setup_reading_progress(),this.setup_events(),this.setup_buy(),this.setup_print_handler(),this.setup_seo_roadblock(),this.disable_check_body_width(),this.send_tracking(),this.setup_ads(),i=$.parseQuery(window.location.hash.replace(/^#/,"")),(this.opts.enter_fullscreen||i.fullscreen)&&_.defer(function(){var t;return null!=(t=Scribd.ReadPage.toolbar)?t.goto_read_mode("full",!0):void 0}),"#download"===window.location.hash&&_.defer(function(){var t,e;return null!=(e=Scribd.ReadPage.toolbar)&&"function"==typeof(t=e.actions).download_btn?t.download_btn():void 0})}return n(i,e),i.early_initialize=function(){var t;return t=$(window).width()-340,$("<style>#doc_container { width: "+t+"px; }</style>").appendTo($("head")),DocumentManager?DocumentManager.ScrollViewManager.prototype._checkBodyWidth=function(){}:void 0},i.prototype.in_reading_mode=!1,i.prototype.exit_reading_mode_threshold=100,i.prototype.page_name="pdf",i.prototype.setup_ads=function(){var t,e=this;return this.opts.disable_ads?void $(function(){return $("body").addClass("ads_disabled").trigger("scribd:ads_disabled")}):(null!=(t=Scribd.Ads)&&t.load(),"undefined"!=typeof docManager&&null!==docManager&&docManager.addEvent("expectedFirstPageChanged",function(t){return e.check_between_page_ad(t)}),this.check_between_page_ad(1))},i.prototype.check_between_page_ad=function(t){var e;return this._checked_ad||(this._checked_ad={}),this._checked_ad[t]?void 0:(this._checked_ad[t]=!0,e=$("#between_page_ads_"+t),e.length&&e.height()>0?e.addClass("is_filled"):void 0)},i.prototype.disable_check_body_width=function(){},i.prototype.setup_reading_progress=function(){var t,e,n,i=this;return new Scribd.ReadingProgress,t=(null!=(e=window.location.hash.match(/\bpage=(\d+)/))?e[1]:void 0)||(null!=(n=Scribd.current_doc.reading_progress)?n[0]:void 0),t&&+t>1&&docManager.view_manager_deferred.then(function(){return docManager.gotoPage(+t)}),$("#reading_progress_notification_lightbox").on("scribd.ui.reading_progress_notification_lighbox.ok",function(t,e){return docManager.gotoPage(+e[0])}),$("#reading_progress_notification_lightbox").on("scribd.ui.reading_progress_notification_lighbox.cancel",function(){return i.ignore_progress_notification=!0}),$(window).on("scribd.doc.external_progress_changed",function(t,e){var n,r;if(!(i.ignore_progress_notification||Scribd.read_page!==i||(r=Math.floor(e.progress[0]),docManager.currentPageNum()===r||0>=r)))return n={current_page:docManager.currentPageNum(),other_page:r,new_progress:e},Scribd.ReadingProgressNotificationLightbox.open("reading_progress_notification_lightbox").setMessage(n).setProgress(e.progress).redraw()})},i.prototype.setup_sticky_download=function(){var t,e,n,i,r;if(this.container.find(".toolbar_download_panel").length)return i=$("#doc_sidebar"),r=$(window),e=i.outerHeight()+i.offset().top,t=!1,n=function(){if(r.scrollTop()>e){if(t)return;return t=!0,Scribd.ReadPage.toolbar.toggle_panel("download",!0)}if(t)return t=!1,Scribd.ReadPage.toolbar.toggle_panel("download",!1)},r.on("scroll",n),n()},i.prototype.setup_reading_mode=function(){var t,e=this;return $(document.body).on("click",function(t){var n;if(1===t.which&&!(t.clientY<=e.exit_reading_mode_threshold||(n=$(t.target),n.closest(".doc_toolbar, #global_header, a, .doc_sidebar, .doc_banner, input, textarea").length)))return e.toggle_reading_mode()}),t=$(window),t.on("scroll",function(){return e.in_reading_mode&&!e.reading_mode_allowed()?e.toggle_reading_mode():void 0}),t.on("mousemove",function(t){return e.in_reading_mode&&t.clientY<e.exit_reading_mode_threshold?e.toggle_reading_mode():void 0}),this.reading_mode_bar=$("#reading_mode_bar"),this.container.on("scribd:toggle_panel",function(t,n,i){return"find"===n&&i&&e.in_reading_mode?e.toggle_reading_mode(!1):void 0}),"undefined"!=typeof docManager&&null!==docManager?docManager.addEvent("expectedFirstPageChanged",function(t){return e.reading_mode_bar.find(".page_num").text(t)}):void 0},i.prototype.reading_mode_allowed=function(){var t,e,n,i;return i=$(window),e=$("body"),t=$("#document_activity"),n=this.container.find(".outer_page_container, #chunk"),this.reading_mode_allowed=function(){var t,r,o,s;return e.is(".overlay_open")?!1:(null!=(o=Scribd.ReadPage.toolbar)&&null!=(s=o.current_panel)?s.is(".toolbar_find_panel"):void 0)?!1:(r=i.scrollTop(),t=n.offset().top,r>t&&r+i.height()<t+n.height())},this.reading_mode_allowed()},i.prototype.toggle_sidebar=function(){return this.container.toggleClass("sidebar_hidden"),this.update_page_width()},i.prototype.update_page_width=function(){var t,e,n,i,r,o,s,a,c;return c=$(window),o=300,r=81,a=1,e=41,s=0,n=40,i=728,t=$(document.body),this.update_page_width=function(){var t,l,u,d,h,p;return d=c.width(),h=d-(o+n),h=Math.max(i,h),this.container.is(".w1111")?(l=a,t=s):(l=r,t=e),u=this.container.is(".sidebar_hidden")?(t=s,d):h,"undefined"!=typeof docManager&&null!==docManager&&null!=(p=docManager._currentViewManager)&&p._setWidth(u-t-l),this.doc_container.width(u-t).trigger("scribd:reshape",[h,u])},this.update_page_width()},i.prototype.setup_width=function(){var t,e=this;return t=_.debounce(function(){return e.update_page_width()},20),$(window).on("resize",t),this.update_page_width()},i.prototype.setup_footer=function(){return this.footer_documents=this.container.find(".footer_documents")},i.prototype.setup_responsive=function(){var t,e,n,i,r,o=this;return i=[1111],t=[function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)n=i[t],r.push("w"+n);return r}()].join(" "),r=$(window),e=function(){var e,n,s,a;for(o.container.removeClass(t),a=[],n=0,s=i.length;s>n;n++){if(e=i[n],r.width()<e){o.container.addClass("w"+e);break}a.push(void 0)}return a},$(window).on("resize",e),e()},i.prototype.show_seo_footer=function(){var t;return $(".banner_spacer").hide(),t=$("#tpl_seo_banner_spacer"),$(t.html()).replaceAll(t).show()},i.prototype.setup_seo_roadblock=function(){var t=this;if(Scribd.SeoShared.setup_assignment())return setTimeout(function(){var e;return e=Scribd.Lightbox.open("seo_roadblock_lb",Scribd.SeoLightbox),e.container.on("Scribd:lightbox:closed",function(){return t.show_seo_footer()})},1e3)},i}(Scribd.BaseReadPage)}).call(this);


/* app/views/read2/_toolbar.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};t=Scribd.make_tracker("read2:toolbar"),Scribd.Toolbar=function(){function n(t){this.setup_mode_toggle=e(this.setup_mode_toggle,this),this.container=$(t),this.height=this.container.height(),this.setup_notification(),this.extra_height=this.container.is(".has_notification")?this.container.find(".toolbar_notification").outerHeight():0,this.setup_events(),this.setup_popups(),this.setup_sidebar_buttons(),this.setup_tooltips(),this.setup_hotkeys(),this.setup_mode_toggle(),this.setup_panels(),this.setup_docmanager(),this.setup_misc()}return n.prototype.actions_cls=function(){return Scribd.ToolbarActions},n.prototype.notification_version=1,n.prototype.setup_mode_toggle=function(){var e,n=this;return e=this.container.find(".read_mode_toggle .toggle_btn"),this.container.on("click",".read_mode_toggle .toggle_btn",function(i){var r;return r=$(i.currentTarget),r.is(".active")?!1:(t("click","toggle_read_mode"),n.goto_read_mode(r.data("name"))&&(e.removeClass("active"),r.addClass("active")),!1)})},n.prototype.goto_read_mode=function(t,e){if(null==e&&(e=!1),e)return this.container.find(".read_mode_btn[data-name="+t+"]").trigger("click");switch(t){case"full":if(Scribd.read_page.container.is(".sidebar_hidden"))return;Scribd.read_page.toggle_sidebar(),docManager.resetZoom(),this.update_zoomers({max_zoom:!0,mode_picker:!0});break;case"standard":if(!Scribd.read_page.container.is(".sidebar_hidden"))return;this.update_zoomers({max_zoom:!1,mode_picker:!0}),Scribd.read_page.toggle_sidebar()}return!0},n.prototype.set_mode_value=function(t){return this.container.find(".read_mode_toggle .toggle_btn").removeClass("active").filter("[data-name='"+t+"']").addClass("active")},n.prototype.setup_misc=function(){var t=this;return $(document.body).on("scribd:buy_disabled",function(){var e;return e=t.container.find(".primary_action_btn").filter(".premium_signup_btn, .buy_doc_btn").remove()}),$(document.body).trigger("scribd:fix_icons",[this.container]),$(document.body).on("scribd:increment_activity_count",function(e,n){var i;return null==n&&(n=1),t.activity_flag||(t.activity_flag=t.container.find(".activity_flag")),(null!=(i=t.activity_flag.html())?i.match(/^\d+$/):void 0)?t.activity_flag.removeClass("has_none").html(parseInt(t.activity_flag.html(),10)+n):void 0})},n.prototype.setup_notification=function(){var e=this;return this.setup_welcome_notification(),this.container.on("click",".toolbar_notification .close_btn",function(){return t("click","hide_notification"),e.hide_notification()}),this.update_notification()},n.prototype.setup_welcome_notification=function(){var t=this;if(!this.container.is(".has_notification"))return Scribd.with_local_storage(function(e){var n;return n=parseInt(e.getItem("scribd:read_welcome"),10),n>=t.notification_version?void 0:(t.container.addClass("has_notification").find(".welcome_notification").show(),e.setItem("scribd:read_welcome",t.notification_version))})},n.prototype.setup_docmanager=function(){var t;return t=docManager.gotoPage,docManager.gotoPage=function(e,n){return t.call(docManager,e,$.extend({offset:110},n))}},n.prototype.setup_hotkeys=function(t){var e,n=this;return null==t&&(t=!0),e=navigator.platform.match(/Mac/),e&&this.container.addClass("osx"),$(window.document).keydown(function(i){if(t&&70===i.keyCode&&(e&&i.metaKey||!e&&i.ctrlKey))return n.actions.find_btn(n.container.find(".find_btn")),!1;if(!$(i.target).closest("input, textarea, select").length)return 73!==i.keyCode||i.ctrlKey||i.metaKey?void 0:(n.actions.info_btn(n.container.find(".info_btn")),!1)})},n.prototype.setup_panels=function(){var t=this;return this.container.on("scribd:update_panel",function(){var e,n;if(t.current_panel)return n=t.current_panel.height(),e=t.current_panel.addClass("disable_transition").css({height:""}).height(),t.current_panel.css({height:""+n+"px"}),_.defer(function(){return t.current_panel.removeClass("disable_transition"),$("#doc_sidebar").css({marginTop:""+e+"px"}),t.current_panel.css({height:""+e+"px"})})}),this.setup_find_panel()},n.prototype.setup_find_panel=function(){return new Scribd.ToolbarFindPanel(this.container.find(".toolbar_find_panel"),this)},n.prototype.setup_tooltips=function(){var t,e,n,i,r,o;if(!this.container.is(".show_labels")){for(o=this.container.find("span.icon"),i=0,r=o.length;r>i;i++)t=o[i],t=$(t),n=t.next("span").text(),n&&t.parent().attr("data-tooltip",n);return e=this.container.find(".doc_toolbar_inner"),Scribd.hook_tooltips(this.container,{position:function(t,n){var i,r,o,s;return r=t.position(),o=n.outerWidth(),s=t.outerWidth(),i=t.outerHeight(),n.css({left:r.left+Math.floor((s-o)/2),top:r.top+i+4+e.position().top})}})}},n.prototype.setup_popups=function(){var t=this;return this._popups||(this._popups=this.container.find(".toolbar_popups")),this._popups.on("click",".close_btn",function(){return t.close_popup()}),$(document.body).on("click",function(e){return $(e.target).closest(".toolbar_popup").length?void 0:t.close_popup()})},n.prototype.setup_sidebar_buttons=function(){var t,e,n=this;return t=$("#doc_container"),t.length?(e=function(e){var i;return n.sidebar_offset=e||t.outerWidth()-1,null!=(i=n.current_panel)?i.css({left:""+n.sidebar_offset+"px"}):void 0},e(),t.on("scribd:reshape",function(n,i){var r;return r=t.innerWidth()-t.width(),e(i+r)})):void 0},n.prototype.close_popup=function(t){var e;if(!t||t.is(this.current_popup))return null!=(e=this.current_popup)&&e.trigger("scribd:popup_close").data("btn").removeClass("popup_active"),this._popups.find(".toolbar_popup").removeClass("is_open"),this.current_popup=null},n.prototype.show_popup=function(t,e){var n,i,r,o;if(t=this.container.find(t),!t.length)throw"failed to find popup "+t.selector;return(n=this.current_popup)&&(this.close_popup(),n.data("btn").is(e))?void 0:(o=e.position(),r=t.width(),i=Math.floor(o.left+e.outerWidth()/2),i+r>$(window).width()?(t.addClass("align_right"),i-=r):t.removeClass("align_right"),t.data("btn",e).css({left:""+i+"px",top:""+(o.top+e.height()-8)+"px"}).addClass("is_open").appendTo(this._popup_drop),e.addClass("popup_active"),this.current_popup=t.trigger("scribd:popup_open",[e]),t)},n.prototype.toggle_panel=function(t,e){var n,i,r,o,s;return i=$("#doc_sidebar"),this._panels||(this._panels=this.container.find(".toolbar_panels").find(".toolbar_panel")),this._panel_buttons||(this._panel_buttons=this.container.find("[data-panel_name]")),o=this._panels.filter(".toolbar_"+t+"_panel"),n=this._panel_buttons.filter("[data-panel_name='"+t+"']"),r=o.is(".open"),e===!0&&r||e===!1&&!r?void 0:(this.container.trigger("scribd:toggle_panel",[t,!r]),r?(n.add(o).addClass("closing").removeClass("open"),this.current_panel=null,i.css({marginTop:""}),o.css({height:"0"}),!1):(this._panel_buttons.add(this._panels).removeClass("open"),n.add(o).addClass("open"),s=o.css({height:""}).height(),o.css({left:""+this.sidebar_offset+"px",top:""+this.height+"px",right:"0",height:"0"}),_.defer(function(){return i.css({marginTop:""+s+"px"}),o.css({height:""+s+"px"})}),this.current_panel=o,o))},n.prototype.setup_events=function(){var t;return t=this.actions_cls(),this.actions=new t(this.container,this),this.setup_pager(),this.container.stick_in_parent({parent:"body",offset_top:Scribd.Header.prototype.height})},n.prototype.setup_pager=function(){var t,e,n=this;return this.container.find(".pager .total_value").text(this.get_highest_page()),t=this.container.find(".pager .current_value"),e=function(e){var n;return null!=e&&t.val(e),n=t.val().length,t.width(18+8*Math.max(0,n-1))},docManager.addEvent("expectedFirstPageChanged",function(t){return n.current_page_num=t,e(t)}),t.on("keydown keyup",function(i){switch("keydown"===i.type&&i.keyCode){case 38:return n.move_page(-1),!1;case 40:return n.move_page(1),!1;case 13:navigator.userAgent.match(/msie/i)&&n.goto_page(+t.val())}return e()}),t.on("change",function(){return n.goto_page(+t.val())}),t.on("click",function(t){return t.target.select()}),docManager.firstVisiblePage?_.defer(function(){return n.current_page_num=docManager.firstVisiblePage.pageNum,e(n.current_page_num)}):void 0},n.prototype.goto_page=function(t){var e,n;return e=t>this.current_page_num?1:-1,n=docManager.getClosestPageNumber(t,e),docManager.gotoPage(n,{direction:e})},n.prototype.move_page=function(t){return this.goto_page(t+this.current_page_num)},n.prototype.get_highest_page=function(){var t,e,n;if(t=null!=(n=Scribd.current_doc)?n.page_count:void 0,!t){t=0;for(e in docManager.pages)t=Math.max(t,e)}return t},n.prototype.update_notification=function(){return $(document.body).toggleClass("has_read_notification",this.container.is(".has_notification"))},n.prototype.hide_notification=function(t){var e,n,i,r=this;return null==t&&(t=!0),this.container.is(".has_notification")?(e=200,this.container.removeClass("has_notification"),n=this.container.find(".toolbar_notification"),i=this.container.parent(),t?n.slideUp(function(){return r.container.trigger("sticky_kit:recalc")}):n.remove(),this.update_notification()):void 0},n.prototype.update_zoomers=function(t){var e;return this._zoom_in||(this._zoom_in=this.container.find(".zoom_in_btn")),this._zoom_out||(this._zoom_out=this.container.find(".zoom_out_btn")),null!=t.min_zoom&&(this._zoom_out.toggleClass("disabled",t.min_zoom),this.container.toggleClass("min_zoom",t.min_zoom)),null!=t.max_zoom&&(this._zoom_in.toggleClass("disabled",t.max_zoom),this.container.toggleClass("max_zoom",t.max_zoom)),t.mode_picker?void 0:(e=t.max_zoom?"full":"standard",this.set_mode_value(e))},n}(),Scribd.ToolbarActions=function(t){function e(t,n){var i=this;this._toolbar=n,e.__super__.constructor.call(this,t),$(document.body).on("scribd:overlay_panel_show",function(){return i.container.find(".info_btn").addClass("open"),i._toolbar.hide_notification()}),$(document.body).on("scribd:overlay_panel_hide",function(){return i.container.find(".info_btn").removeClass("open")})}return i(e,t),e.prototype.track_category="read2:toolbar",e.prototype.download_page="read",e.prototype.download_action="toolbar_download",e.prototype.buy_doc_btn=function(){return Scribd.read_page.buy_manager.get_buy_callback("toolbar")()},e.prototype.premium_signup_btn=function(){return Scribd.read_page.buy_manager.get_premium_callback("toolbar")()},e.prototype.info_btn=function(){return Scribd.ReadPage.overlay_panel.toggle()},e.prototype.find_object=function(){return{type:"document",id:Scribd.current_doc.id}},e.prototype.zoom_in_btn=function(){var t;if(t=docManager._currentViewManager._currentZoomMultiplier,this._toolbar.update_zoomers({min_zoom:!1}),t>=1){if(Scribd.read_page.container.is(".sidebar_hidden"))return;return Scribd.read_page.toggle_sidebar(),this._toolbar.update_zoomers({max_zoom:!0})}return this._toolbar.with_lock(function(){return docManager.zoom(1.25)})},e.prototype.zoom_out_btn=function(){return this._toolbar.update_zoomers({max_zoom:!1}),Scribd.read_page.container.is(".sidebar_hidden")?Scribd.read_page.toggle_sidebar():this._toolbar.with_lock(function(){var t;return docManager.zoom(.8),t=docManager._currentViewManager._currentZoomMultiplier,.2>t?this._toolbar.update_zoomers({min_zoom:!0}):void 0})},e.prototype.find_btn=function(){var t,e;return null!=(e=Scribd.ReadPage.overlay_panel)&&e.toggle(!1),t=this._toolbar.toggle_panel("find"),t?t.find(".find_input").focus():void 0},e.prototype.embed_btn=function(){return Scribd.Lightbox.remote_open("embed_dialog","https://www.scribd.com/read/embed_dialog",Scribd.toolbar_params())},e.prototype.share_btn=function(t){return this._toolbar.show_popup(".share_popup",t)},e.prototype.font_settings_btn=function(t){return this._toolbar.show_popup(".font_popup",t)},e.prototype.save_bookmark_btn=function(t){var n=this;return Scribd.with_login("save_for_later",function(){var i,r;return r=n._toolbar.container.find(".saved_popup"),i=t.data("labels"),t.hasClass("saved")?(n._toolbar.close_popup(r),t.data("tooltip",i.not_saved)):(n._toolbar.show_popup(r,t),t.data("tooltip",i.saved)),r.removeClass("success"),e.__super__.save_bookmark_btn.call(n,t,function(){return r.addClass("success")})})},e.prototype.readcast_btn=function(t){var e=this;return Scribd.with_login("like_document",function(){return e._toolbar.show_popup(e._toolbar.container.find(".readcaster_popup"),t)})},e}(Scribd.DocumentActions)}).call(this);


/* app/views/read2/popups/_commenting_popup.coffee @ 1425075610 */
(function(){Scribd.CommentingPopup=function(){function t(t){this.container=$(t),this.setup_comment_form()}return t.prototype.track_category="comment_popup",t.prototype.increment_activity=!0,t.prototype.setup_comment_form=function(){var t=this;return this.container.on("submit",".comment_form",function(t){return""===$.trim($(t.target).find(".comment_input").val())?!1:void 0}),this.container.on("ajax:success",".comment_form",function(e,n){var i,r;return i=$(e.target),t.container.addClass("comment_posted"),i.find(".comment_input").val(""),t.increment_activity&&$(document.body).trigger("scribd:increment_activity_count",[1,"comment"]),n.comment&&null!=(r=Scribd.ReadPage.activity_list)?r.append_new_comment(n.comment):void 0}),this.container.dispatch("click","read2:"+this.track_category,{add_another_btn:function(){return t.container.removeClass("comment_posted")}})},t}()}).call(this);


/* app/views/read2/_overlay_panel.coffee @ 1425075610 */
(function(){$.fn.detach_with_spacer=function(){var t,e,n,i;for(e=function(t){var e;return e=t.data("spacer"),(null!=e?e.length:void 0)||(e=$('<div class="detach_spacer"></div>'),t.data("spacer",e)),e.css({margin:t.css("margin"),width:t.outerWidth()+"px",height:t.outerHeight()+"px",display:t.css("display"),"float":t.css("float")}).insertAfter(t),t.detach()},n=0,i=this.length;i>n;n++)t=this[n],e($(t));return this},$.fn.reattach_from_spacer=function(){var t,e,n,i;for(e=function(t){var e;return e=t.data("spacer"),e&&e.length?e.after(t).detach():void 0},n=0,i=this.length;i>n;n++)t=this[n],e($(t));return this},Scribd.OverlayPanel=function(){function t(t){var e=this;this.container=$(t),this.content=this.container.find(".scrolling_content"),this.shroud=this.container.prev(".overlay_panel_shroud"),$(document.body).on("click",".overlay_panel_shroud, .toggle_overlay_btn",function(){return e.toggle(),!1}),this.setup_scrolling(),this.container.on("scribd:update_height",function(){return e.recalc_scrolling()}),$(window.document).keydown(function(t){return 27===t.keyCode&&e.container.is(".visible")?(e.toggle(!1),!1):void 0})}return t.prototype.max_width=800,t.prototype.anim_time=400,t.prototype.easing="ease_in_out_cubic",t.prototype.setup_scrolling=function(){return this.scroller=this.container.find(".nano").nanoScroller({preventPageScrolling:!0,contentClass:"scrolling_content"})},t.prototype.recalc_scrolling=function(){var t=this;return _.defer(function(){return t.scroller.nanoScroller({preventPageScrolling:!0})})},t.prototype.attach_content=function(){return this.attach_content=function(){return Scribd.ReadPage.activity_list.container.detach_with_spacer().appendTo(this.content)},Scribd.ReadPage.doc_info.container.clone().appendTo(this.content),this.attach_content()},t.prototype.detach_content=function(){return Scribd.ReadPage.activity_list.container.reattach_from_spacer()},t.prototype.min_position=function(){var t,e;return t=$("#global_header").height(),e=Scribd.ReadPage.toolbar.container,this.min_position=function(){var n;return n=e.is(".has_notification")?e.find(".toolbar_notification").height():0,t+n},this.min_position()},t.prototype.max_position=function(){var t,e;return t=null!=(e=Scribd.ReadPage.activity_list)?e.container:void 0,t.offset().top},t.prototype.toggle=function(t){var e,n,i,r,o,s,a,c,l=this;if(this.container.is(":animated"))return!1;if(n=this.container.is(".visible"),!(t===!0&&n||t===!1&&!n)){if(o=Scribd.ReadPage.toolbar,a=$(window),e=$(document.body),n)return a.off("scroll.overlay_panel"),this.shroud.removeClass("visible"),this.container.animate({right:-this.container.outerWidth()},this.anim_time,this.easing,function(){return l.container.removeClass("visible").hide(),e.removeClass("overlay_open"),l.shroud.hide()}),this.detach_content(),void this.container.trigger("scribd:overlay_panel_hide");if(r=this.min_position(),i=this.max_position(),!(i-r<=a.height())||$(".doc_page").is(".book_view"))return null!=(c=Scribd.ReadPage.toolbar)&&c.toggle_panel("find",!1),s=Math.min($(window).width()-100,this.max_width),this.shroud.show(),_.defer(function(){return l.shroud.addClass("visible")}),this.container.width(s).css("right",-s).show().addClass("visible").animate({right:0},this.anim_time,this.easing,function(){return a.on("scroll.overlay_panel",function(){var t;return t=a.scrollTop(),r>t||i&&t+a.height()>i?(l.toggle(!1),a.off("scroll.overlay_panel")):void 0}),l.recalc_scrolling()}),e.addClass("overlay_open"),a.scrollTop()<r&&$("html, body").animate({scrollTop:r},"fast"),this.attach_content(),this.container.trigger("scribd:overlay_panel_show")}},t}()}).call(this);


/* app/views/login/_archive_login_lightbox.coffee @ 1425075610 */
(function(){Scribd.ArchiveLoginLightbox=function(){function t(t){var e=this;this.set_page(),$(t).on("click","a.skip_login",function(){return Scribd.track_event("login_lightbox","click",""+e.page+":login_lightbox:skip_login")})}return t.prototype.set_page=function(){var t;return this.page=window.location.pathname.split("/")[1],this.page||(this.page="home"),null!=(null!=(t=Scribd.current_doc)?t.signup_context:void 0)?this.page=""+this.page+"_"+Scribd.current_doc.signup_context:void 0},t}()}).call(this);


/* app/views/shared/document_popups.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Scribd.UI||(Scribd.UI={}),Scribd.UI.Popups=function(){function t(t,n){this.trigger_exit=e(this.trigger_exit,this),this.trigger_enter=e(this.trigger_enter,this);var i=this;this._popup_drop=$(t),n&&this.bind(n),$(document.body).on("click",function(t){return $(t.target).closest(".object_popup").length?void 0:i.hide_popup()}),$(document.body).on("Scribd:hide_popups",function(){return i.hide_popup()})}return t.prototype.popup_timeout=300,t.prototype.remove_popup_timeout=200,t.prototype.fetch_data_timeout=150,t.prototype.cell_selector=".object_cell",t.prototype.hover_selector=".object_cell .object_cell_hover",t.prototype.popup_selector=".object_popup",t.prototype.positioning_selector=".object_cell_hover",t.prototype.popup_data=function(){throw"override me (popup_data)"},t.prototype.make_popup=function(){throw"override me (make_popup)"},t.prototype.trigger_enter=function(t){var e;return(e=t.data("remove_popup_timeout"))?(t.removeData("remove_popup_timeout"),window.clearTimeout(e)):void 0},t.prototype.trigger_exit=function(t){var e,n,i=this;if(this.current_popup&&this.current_popup.data("cell").is(t)){if(t.data("remove_popup_timeout"))return;return e=this.current_popup,n=window.setTimeout(function(){return t.removeData("remove_popup_timeout"),window.location.hash.match(/\bstick_popups\b/)||i.current_popup!==e?void 0:i.hide_popup()},this.remove_popup_timeout),t.data("remove_popup_timeout",n)}},t.prototype.bind=function(t){var e,n,i,r=this;return t=$(t),e=null,i=_.debounce(function(){var t;return t=e,t?r.popup_data(t,function(n){return t===e?r.show_popup(t,n):void 0}):void 0},this.popup_timeout),n=_.debounce(function(){return e?r.popup_data(e):void 0},this.fetch_data_timeout),$(document.body).on("mousemove",i).on("mousemove",n),t.on("mouseenter mouseleave",this.hover_selector||this.cell_selector,function(t){var n,i;return n=$(t.currentTarget),r.cell_selector&&(n=n.closest(r.cell_selector)),n.is(".no_popup")?void 0:(i="mouseenter"===t.type,i?(e=n,r.trigger_enter(n)):(e=null,r.trigger_exit(n)))}),t.on("mouseenter mouseleave",this.popup_selector,function(t){var e,n,i;return i=$(t.currentTarget),e=i.data("cell"),n="mouseenter"===t.type,n?r.trigger_enter(e):r.trigger_exit(e)})},t.prototype.hide_popup=function(){return this.current_popup&&this.current_popup.data("cell")&&this.current_popup.data("cell").removeClass("popup_open"),this.current_popup=null,this._popup_drop.children().detach()},t.prototype.show_popup=function(t,e){var n,i,r,o,s,a,c,l,u,d,h,p,f,_,g,m,v,b,y,w,k,x,S,C;if((null!=(C=this.current_popup)?!C.data("cell").is(t):!0)&&(this.current_popup&&this.hide_popup(),jQuery.contains(document.documentElement,t[0]))){if(f=null,t.data("popup_elm")&&t.data("popup_elm").is(this.popup_selector)&&(f=t.data("popup_elm")),!f){if(a=!0,f=this.make_popup(t,e),!f)return;f.data("cell",t).data("object",e),(g=t.data("popup_classes"))&&f.addClass(g),t.data("popup_elm",f)}for(y=this.positioning_selector?t.find(this.positioning_selector):t,b=y.offset(),p=this._popup_drop.offsetParent().offset(),b.left-=p.left,b.top-=p.top,t.addClass("popup_open"),this.current_popup=f.removeClass("on_left").css({left:""+Math.floor(b.left)+"px",top:""+Math.floor(b.top)+"px"}).appendTo(this._popup_drop.children().detach().end()),f.trigger("scribd:popup_added",[a]),x=$(window),o=b.left+y.outerWidth()+f.outerWidth()<x.width(),d=b.left-f.outerWidth()<x.scrollLeft()+10,u=this.default_on_right&&o||d?(f.addClass("on_right"),b.left+y.outerWidth()):(f.addClass("on_left"),b.left-f.outerWidth()),s=S=1;2>=S;s=++S)f.css({left:""+Math.floor(u)+"px"});return k=y.outerHeight(),m=f.outerHeight(),f.css("margin-top",""+(k-m)/2+"px"),h=10,m=f.outerHeight(),v=f.offset(),w=x.scrollTop(),_=f.find(".popup_arrow").css("margin-top",""),n=m/2-20,r=parseInt(_.css("margin-top"),10),c=w+h-v.top,c>0?(f.css("top",Math.floor(b.top+c)),i=r-Math.min(n,c),_.css("margin-top",""+i+"px")):(l=v.top+m-(x.height()+w-h),_.addClass("below_title"),l>0&&(f.css("top",Math.floor(b.top-l)),i=r+Math.min(n,l),_.css("margin-top",""+i+"px"))),this.current_popup.hide().fadeIn()}},t}(),Scribd.UI.DocumentPopups=function(t){function e(t,n,i){i&&(this.context=i),e.__super__.constructor.call(this,t,n),this.setup_events()}return i(e,t),e.prototype.context="document_popups",e.prototype.popup_selector=".document_popup",e.prototype.show_hide=!1,e.prototype.make_popup=function(t,e){if((this.tracker||(this.tracker=Scribd.make_tracker(this.context)))("show","show",{interactive:!1}),e.context=this.context,e.list_title=t.data("object_list_title"),e.source=t.data("object_source"),e.source_ids=String(t.data("object_source_ids")),e.source_titles=t.data("object_source_titles"),t.is(".document_cell"))return this.make_document_popup(e);throw"don't know how to make popup"},e.prototype.make_document_popup=function(t){var e,n,i,r,o,s,a,c;return this._doc_popup_template||(this._doc_popup_template=_.template($("#tpl_document_popup").html())),/excerpt/i.test(t.title)||"book_excerpt"!==t.document_type||(t.title="[Excerpt] "+t.title),a=$(this._doc_popup_template(t)),a.on("click",".save_bookmark_btn",function(t){return $(t.currentTarget).find(".btn_inner").text("Saved!")}),t.user_can_save_bookmarks&&a.addClass("user_can_save_bookmarks"),t.publisher.is_verified&&(t.authors.length?a.find(".verified_badge.author_badge").removeClass("hidden"):a.find(".verified_badge.publisher_badge").removeClass("hidden")),t.authors.length&&a.addClass("has_authors"),t.bookmark_id&&a.find(".save_bookmark_btn").addClass("saved"),t.view_restriction_message&&a.addClass("is_view_restricted").find(".view_restriction_msg").html(t.view_restriction_message),t.download_url&&a.data("download_url",t.download_url).addClass("is_downloadable"),t.read_full||a.addClass("is_excerpt"),e=28,s=t.list_title&&t.list_title.match(/recommendations/),s&&!t.context.match(/read/)&&(o=a.find(".recommendation_explanation"),t.source_ids&&t.source_titles&&t.source_titles.length>0?(a.addClass("has_recommendation"),n=t.source_ids.split(",")[0],r=t.source_titles[0].length>e?t.source_titles[0].substr(0,e)+"...":t.source_titles[0],i=$("<a href='/doc/"+n+"'></a>").text(r),o.html("Similar to: <br />").append(i),_.defer(function(){return o.dotdotdot()})):o.parent().hide()),c=a.find(".star_ratings_row"),new Scribd.StarRatings(c.find(".stars"),{default_value:t.stats.current_user_rating||t.stats.rating_average,doc_id:t.id,interactive:!1}),c.on("scribd:rating",function(){return a.addClass("has_rated")}),null!=t.stats.current_user_rating&&a.addClass("has_rated"),a.one("scribd:popup_added",function(){var t,e,n;return e=a.find(".document_description"),n=e.find(".description"),t=_.trim(_.unescape(n.text().replace("&nbsp;"," "))),n.text(t),0===t.length&&a.addClass("has_no_description"),e.dotdotdot(),a.find(".title_row").dotdotdot()}),a},e.prototype.popup_data=function(t,e){var n,i;return i=t.data("request"),n=t.data("object_id"),i||(i=function(){if(t.is(".document_cell"))return $.get("/documents/popup_data?id="+n);throw"Don't know how to handle popup"}(),t.data("request",i)),e?i.done(e):void 0},e.prototype.bind=function(){return e.__super__.bind.apply(this,arguments)},e.prototype.setup_events=function(){var t=this;return this._popup_drop.on("mouseenter",".not_interested_btn",function(){return t._popup_drop.find(".recommendation_explanation").hide(),t._popup_drop.find(".not_interested_text").show()}),this._popup_drop.on("mouseleave",".not_interested_btn",function(){return t._popup_drop.find(".recommendation_explanation").show(),t._popup_drop.find(".not_interested_text").hide()})},e}(Scribd.UI.Popups),Scribd.UI.OnboardingBookPopups=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.context="onboarding_popup",n.prototype.make_popup=function(t,e){var n;return this._doc_popup_template||(this._doc_popup_template=_.template($("#tpl_onboarding_book_popup").html())),window.popup=n=$(this._doc_popup_template(e)),n.on("click",".save_bookmark_btn",function(t){return $(t.currentTarget).find(".btn_inner").text("Saved!")}),e.user_can_save_bookmarks&&n.addClass("user_can_save_bookmarks"),e.publisher.is_verified&&(e.authors.length?n.find(".verified_badge.author_badge").removeClass("hidden"):n.find(".verified_badge.publisher_badge").removeClass("hidden")),e.authors.length&&n.addClass("has_authors"),e.bookmark_id&&n.find(".save_bookmark_btn").addClass("saved"),n.one("scribd:popup_added",function(){var t,e,i;return e=n.find(".document_description"),i=e.find(".description"),t=_.trim(_.unescape(i.text().replace("&nbsp;"," "))),i.text(t),0===t.length&&n.addClass("has_no_description"),e.dotdotdot(),n.find(".title_row").dotdotdot()}),n},n}(Scribd.UI.DocumentPopups)}).call(this);


/* app/views/shared/dialogs/download_dialog.coffee @ 1425075610 */
(function(){Scribd.UI||(Scribd.UI={}),Scribd.UI.dispatch=function(t,e,n,i,r){var o,s,a;for(a in e)if(e.hasOwnProperty(a)&&(o=$(t.target).parents().andSelf().filter("."+a),o.size()>0))return r||(t.stopPropagation(),t.preventDefault()),o.hasClass("disabled")?!0:(s=i?i+"_"+a:a,trackEvent("newdoc","Click",s,Scribd.logged_in?1:0),e[a].call(n,o,t),!0);return!1},Scribd.UI.DownloadDialog=function(){function t(t,e){_.bindAll(this),this.options=_.extend({secret_password:"",extension_sizes:{},show_premium:!1},e||{}),this.container=$(t),this.suggested_type=this.container.find(".selected_documents").data("suggested_type"),this.radios=this.container.find(".download_types"),this.sizes_node=$("#document_sizes"),this.extensions_node=$("#document_extensions"),this.download_icon=this.container.find(".big_download_icon"),this.download_button=this.container.find(".download_button"),this.after_download_test=this.container.find(".object_grid").length>0,this.current_extension=this.getCurrentExtension(),this.document=this.options.document,this.download_query={secret_password:this.options.secret_password,source:this.options.source},this.autodown_query={secret_password:this.options.secret_password,source:this.options.source},this.updateExtension(this.current_extension),this.setupEvents()}return t.prototype.actions={title_row:function(t){return window.location=$(t).find(".title").attr("href")},download_button:function(){},try_again:function(){return Scribd.download_actions.download_dialog_lightbox(this.document)},bookmark:function(t){var e;return t=$(t),e=t.closest(".document_cell").data("object_id"),$.post("/document_bookmarks/create",{document_id:e},"json"),this.switchButton(t)},unbookmark:function(t){var e;return t=$(t),e=t.closest(".document_cell").data("object_id"),$.post("/document_bookmarks/delete",{document_id:e},"json"),this.switchButton(t)}},t.prototype.getCurrentExtension=function(){return this.radios.find("input:checked").val()},t.prototype.setupEvents=function(){var t,e=this;return this.actions_classes=function(){var e,n,i,r;for(i=_.keys(this.actions),r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push("."+t);return r}.call(this).join(", "),this.radios.find("input").on("click",function(t){return e.updateExtension($(t.target).val())}),this.actions.download_button=this.options.show_premium?this.premiumDownloadHandler:this.downloadHandler,this.container.click(this.actions_classes,function(t){Scribd.UI.dispatch(t,e.actions,e,"download_dialog")})},t.prototype.switchButton=function(t){return t=$(t),t.siblings(".save_button").andSelf().toggleClass("hidden")},t.prototype.downloadHandler=function(){var t=this;return this.container.addClass("download_started"),this.after_download_test&&(this.suggested_type&&trackEvent("newdoc","Click","download_dialog_show_"+this.suggested_type,1),this.container.addClass("after_download_test"),this.container.find(".title:first").text("Your Download Has Started, You Might Like"),this.recommened_documents_grid=new Scribd.UI.ObjectGrid(this.container.find(".selected_documents .document_grid")),this.recommened_documents_grid.container.find(".thumb").each(function(){var t;return t=$(this).css("background-image"),$(this).css("background-image","none"),$(this).css("background-image",t)})),_.delay(function(){return window.location.href=t.downloadUrl()},2e3)},t.prototype.premiumDownloadHandler=function(){var t;return t=$.param.querystring("https://www.scribd.com/archive/plans",{doc:this.options.document_id}),window.location=t},t.prototype.updateExtension=function(t){var e;return this.current_extension=t,e=function(e,n){return n=$(n),n.data("ext")===t?n.show():n.hide()},this.extensions_node.find("span").each(e),this.sizes_node.find("span").each(e),this.download_icon.find(".icon_text").html(t),this.download_query.extension=t,this.autodown_query.autodown=t,this.download_button.find(".button_text").html("Download "+t)},t.prototype.downloadUrl=function(){return $.param.querystring(this.options.base_url,this.download_query)},t.prototype.autodownUrl=function(){return $.param.querystring(this.options.autodown_base_url,this.autodown_query)},t}()}).call(this);


/* app/views/shared/grids/object_grid.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};Scribd.UI||(Scribd.UI={}),t=function(){var e,n,i,r;return e=$("<style type='text/css'>    #_nth_child_test {      margin: 0px;    }    #_nth_child_test:nth-child(1) {      margin: 1px;    }  </style>").appendTo("body"),r=$("<div><div id='_nth_child_test'></div></div>").appendTo(document.body),n=r.children().css("marginLeft"),i="1px"===n,t=function(){return i},r.remove(),i},Scribd.UI.ObjectGrid=function(){function n(t,n){var i,r,o,s,a=this;if(this.opts=null!=n?n:{},this.set_view_id=e(this.set_view_id,this),this.container=$(t),this.container.data("object",this),$(window).on("resize",_.debounce(function(){return a.fit_to_width()},10)),this.container.on("scribd:reshape",function(){return a.fit_to_width()}),this.fit_to_width(),this.after_new_items_added(),$.isReady?this.container.lazyimages():$(window).one("load",function(){return a.container.lazyimages()}),r=this.container.find(".document_grid").addBack(".document_grid"),r.length)for(o=0,s=r.length;s>o;o++)i=r[o],this.setup_tracking($(i))}return n.prototype.margin=45,n.prototype.cell_width=145,n.prototype.min_spacing=80,n.prototype.min_min_spacing=40,n.prototype.min_width=1e3,n.prototype.max_width=1200,n.prototype.css_prefix=function(){var t,e,n;return n=(e=this.container.attr("id"))?"#"+e:(t=this.container.attr("class"))?"."+t.split(/\s+/).join(", ."):".object_grid",this.css_prefix=function(){return n},n},n.prototype.fit_to_width=function(){var e,n,i,r;if(!(this.opts.disable_fit_to_width||(this._head||(this._head=$("head")),r=this.get_width(),e=this.get_n(r),r-=2*this.margin,i=Math.floor((r-this.cell_width*e)/(e-1)),0>r||((i+this.cell_width)*e>r&&!t()&&(i=Math.floor(r/e-this.cell_width)),this._current_spacing=i,this._css&&this._css.remove(),this.container.toggleClass("single_column",1===e),1===e))))return n=this.css_prefix(),this._css=$("<style type='text/css'>      "+n+" .object_cell {        margin-right: "+i+"px;      }      "+n+" .object_cell:nth-child("+e+"n) {        margin-right: 0;      }    </style>").appendTo(this._head),[e,i]},n.prototype.get_width=function(){return this.container.outerWidth()},n.prototype.get_n=function(t){var e;return e=(t-this.min_width)/(this.max_width-this.min_width)*(this.min_spacing-this.min_min_spacing)+this.min_min_spacing,e=Math.floor(Math.max(this.min_min_spacing,Math.min(this.min_spacing,e))),t-=2*this.margin,Math.floor((t+e)/(this.cell_width+e))},n.prototype.after_new_items_added=function(t){var e,n,i,r,o;for(null==t&&(t=this.container.find(".document_cell.has_flag")),o=t.filter(".document_cell.has_flag"),i=0,r=o.length;r>i;i++)n=o[i],e=$(n).find(".flag"),e.data("text")&&e.text(e.data("text"));return $.isReady?this.container.lazyimages():void 0},n.prototype.setup_tracking=function(t){var e,n,i=this;if(Scribd.RecommendationTracking&&(e=t.data("track_compilation_id"),n=t.data("widget_name"),e&&n))return new Scribd.RecommendationTracking.Module(this.container,{compilation_id:e,page_name:n,on_tracking:function(e){return i.set_view_id(t,e)},on_in_view:function(e){return i.track_visible(t,e)}})},n.prototype.set_view_id=function(t,e){var n,i,r,o,s,a;for(s=t.find("a.doc_link"),a=[],r=0,o=s.length;o>r;r++)n=s[r],i=$(n).data("track_rats_value"),i&&a.push(i.view_id=e.view_id);return a},n.prototype.track_visible=function(t,e){var n,i,r,o,s;for(s=t.find(".document_cell"),i=function(t){return t.one("inview",function(){var n;if(t.is(":visible"))return n=t.data(),Scribd.RecommendationTracking.track_obj_view(e.view_id,n.track_uuid,n.object_id,n.object_type,e.module_id),t.addClass("visibility_tracked")})},r=0,o=s.length;o>r;r++)n=s[r],i($(n));return Scribd.RecommendationTracking.trigger_inview_check()},n}()}).call(this);


/* app/views/shared/grids/grouped_documents_grid.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Scribd.UI.GroupedDocumentsGrid=function(){function t(t,n){var i,r=this;this.container=t,this.opts=null!=n?n:{},this.merge_grouped_grid=e(this.merge_grouped_grid,this),this.clean_up_after_removal=e(this.clean_up_after_removal,this),this.load_documents=e(this.load_documents,this),this.container=$(this.container),this.params={page:1,grouping:this.opts.grouping||"recency",reading_state:this.opts.state},i=this.container.find(".load_more_btn"),this.load_more=new Scribd.UI.LoadMore(i,function(t){return r.params.page++,r.load_documents(t)}),Scribd.UI.GroupedDocumentsGrid.instance=this,$(document).on("scribd:update_grouped_grid",function(){return r.clean_up_after_removal()})}return t.prototype.load_documents=function(t){var e=this;return $.ajax({url:this.opts.more_url,data:this.params,type:"get",dataType:"json",success:function(n){var i;return n.grouped_grid&&(i=$(n.grouped_grid),e.container.removeClass(".loading_content"),e.params.page>1&&("function"==typeof callback&&callback(),e.merge_grouped_grid(i)),n.has_more&&e.load_more.enable()),"function"==typeof t?t(n.has_more):void 0}},!0)},t.prototype.clean_up_after_removal=function(){var t,e,n,i,r,o;for(n=this.container.find(".autogen_class_views_shared_grids_selectable_document_grid"),o=[],i=0,r=n.length;r>i;i++)e=n[i],t=$(e),t.children().length?o.push(void 0):(t.prev().remove(),o.push(t.remove()));return o},t.prototype.merge_grouped_grid=function(t){var e,n,i,r,o,s,a,c,l,u;if(i=t.children(),o=t.find("h2").first(),r=t.find(".document_grid").first(),a=this.container.find("h2").last(),s=this.container.find(".document_grid").last(),o.text()===a.text())return o.remove(),r.children().appendTo(s),r.remove();for(u=[],c=0,l=i.length;l>c;c++)n=i[c],e=$(n),e.is("h2.group_header")&&e.insertBefore(this.container.find(".load_more")),e.is(".document_grid")?(this.container.find(".document_grid.edit_mode").length&&e.addClass("edit_mode"),e.insertBefore(this.container.find(".load_more")),u.push(new Scribd.SelectableDocumentGrid(e))):u.push(void 0);return u},t}(),Scribd.UI.LowerMarginGrid=function(e){function n(){return t=n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.margin=40,n}(Scribd.UI.ObjectGrid)}).call(this);


/* app/views/shared/grids/selectable_document_grid.coffee @ 1425075610 */
(function(){Scribd.SelectableDocumentGrid=function(){function t(t,e){var n=this;this.opts=null!=e?e:{},this.container=$(t),new Scribd.UI.LowerMarginGrid(this.container,this.opts),this.container.on("click",".select_layer",function(t){var e,i,r,o,s,a,c;for(e=$(t.target),e.closest(".select_layer").toggleClass("selected"),r=[],i=[],c=n.container.find(".select_layer.selected"),s=0,a=c.length;a>s;s++)o=c[s],r.push($(o).closest("[data-object_id]").data("object_id")),i.push($(o).closest("[data-my_library_data]").data("my_library_data").bookmark_id);return $(document).trigger("scribd:selectable_document_grid:selection",{ids:r,bookmark_ids:i,grid_id:n.container.attr("id")})})}return t}()}).call(this);


/* app/views/shared/carousels/carousel.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};Scribd.UI.Carousel=function(){function e(t,e){var n,i,r,o,s,a,c=this;this.container=t,this.opts=null!=e?e:{},Scribd.UI.Carousel.carousels.push(this),this.container=$(this.container).data("carousel",this),this.images_loaded=!this.container.data("lazy_images"),this.container.hasClass("cache_widget")&&(this.container=this.container.find(".carousel_widget")),this.carousel=this.container.find(".carousel"),this.scrolling=this.carousel.find(".carousel_scrolling"),this.container.delegate_tracking("click",this.opts.page||"carousel"),n=this.check_items_inview,this.check_items_inview=_.debounce(function(){return n.apply(c)},500),this.container.on("scribd:reshape_carousel",function(){return c.reshape()}),new Scribd.RecommendationTracking.Module(this.container,{on_tracking:function(t){return c.tracking=t,c.set_view_id()},on_in_view:function(){return c.check_items_inview()}}),this.setup_events(),this.setup_scrollbar(),this.setup_flags(),this.setup_paddles(),this.reshape(),this.images_loaded||(s=this.container.offset().top,a=$(window),i=!1,o=function(){return a.scrollTop()+a.height()>s?(i=!0,c.show_visible_images(),a.off("scroll resize",o)):void 0},r=function(){return i?c.show_visible_images():void 0},a.on("resize",_.debounce(r,100)),a.on("scroll resize",o),_.defer(o))}return e.prototype.anim_speed=200,e.prototype.easing="ease_in_out_cubic",e.prototype.images_loaded=!1,e.prototype.setup_paddles=function(){var t=this;return this.container.on("mouseenter",function(){var e,n,i,r;for(r=Scribd.UI.Carousel.carousels,n=0,i=r.length;i>n;n++)e=r[n],e.show_paddles(!1);return t.show_paddles(!0)})},e.prototype.setup_events=function(){var t=this;if(!this.opts.disable_click)return this.container.dispatch("click",{carousel_prev:function(){return t.on_interact(),t.scroll_items(-t.cells_to_scroll())},carousel_next:function(){return t.on_interact(),t.scroll_items(t.cells_to_scroll())}})},e.prototype.setup_scrollbar=function(){var e,n,i=this;return this.scrollbar=this.container.find(".carousel_scrollbar"),e=this.scrollbar.find(".carousel_scrollbar_thumb"),n=_.debounce(function(t,e,n){return i.container.toggleClass("on_first_page",0===t),i.container.toggleClass("on_last_page",t+e===n)},100),this.update_scrollbar=function(){var t,r,o;return t=i.scroll_width(),o=i.scrolling.width(),r=i.scrolling.scrollLeft(),n(r,o,t),e.css({left:""+Math.floor(r/t*o)+"px",right:""+(o-Math.floor((r+o)/t*o))+"px"})},this.scrolling.on("scroll",function(){return i.on_interact(),i.update_scrollbar(),i.check_items_inview()}),this.update_scrollbar(),t(e,{start:function(){return i.container.addClass("dragging")},stop:function(){return i.container.removeClass("dragging")},move:function(t){var e;return e=i.scroll_width()/i.scrolling.width(),i.scrolling.scrollLeft(i.scrolling.scrollLeft()+t*e)}})},e.prototype.scroll_items=function(t){var e,n,i,r,o;return o=this.cell_width(),0===o||this.scrolling.is(":animated")||(e=this.scrolling.scrollLeft(),i=Math.floor(e/o+.1)*o+t*o,n=this.scroll_width()-this.scrolling.width(),i=Math.max(0,Math.min(i,n)),15>n-i&&(i=n),15>i&&(i=0),e===i)?void 0:(r=Math.floor(this.anim_speed*Math.abs((e-i)/o)),this.scrolling.animate({scrollLeft:i},{duration:r,easing:"smoothstep"}))},e.prototype.cells_to_scroll=function(){var t;return t=this.carousel.width()/this.cell_width(),1.5>=t?1:Math.ceil(t/2+1)},e.prototype.cell_width=function(){return this.carousel.find(".object_cell:first").outerWidth(!0)},e.prototype.scroll_width=function(){var t;return(null!=(t=this.scrolling[0])?t.scrollWidth:void 0)||0},e.prototype.reshape=function(){var t,e;return t=this.scroll_width(),e=this.scrolling.width(),this.container.toggleClass("has_no_scrolling",5>t-e),"function"==typeof this.update_scrollbar?this.update_scrollbar():void 0},e.prototype.show_visible_images=function(){var t,e,n,i,r,o;if(!this.images_loaded){for(t=this.scrolling.width(),r=this.carousel.find("[data-thumb_url]"),o=[],n=0,i=r.length;i>n&&(e=r[n],e=$(e),e.position().left<t);n++)o.push(this.show_image($(e)));return o}},e.prototype.show_all_images=function(){var t,e,n,i,r;if(!this.images_loaded){for(this.images_loaded=!0,i=this.carousel.find("[data-thumb_url]"),r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(this.show_image($(t)));return r}},e.prototype.setup_flags=function(){var t,e,n,i,r,o;for(r=this.container.find(".document_cell.has_flag"),o=[],n=0,i=r.length;i>n;n++)e=r[n],t=$(e).find(".flag"),o.push(t.data("text")?t.text(t.data("text")):void 0);return o},e.prototype.show_image=function(t){var e,n;return e=t.find(".thumb"),e.length||(e=t),(n=e.data("thumb_url"))?(e.removeData("thumb_url"),window.location.hash.match(/\bdebug_images\b/)?(e.css({backgroundColor:"red"}),setTimeout(function(){return e.css({backgroundImage:"url('"+n+"')"})},500)):e.css({backgroundImage:"url('"+n+"')"})):void 0},e.prototype.show_paddles=function(t){return null==t&&(t=!0),this.container.toggleClass("ui_visible",!!t)},e.prototype.on_interact=function(){return this.on_interact=function(){},this.show_all_images(),Scribd.track_event(this.opts.page||"carousel","click","carousel:first_carousel_click")},e.prototype.set_view_id=function(){var t,e,n,i,r,o,s,a,c,l;if(!(null!=(a=this.tracking)?a.view_id:void 0))throw"missing tracking.view_id";for(i=this.container.data("rats_value_extra"),c=this.container.find(".document_cell"),l=[],o=0,s=c.length;s>o;o++)t=c[o],n=$(t).data("track_rats_value"),n&&(n.view_id=this.tracking.view_id,l.push(i?function(){var t;t=[];for(e in i)r=i[e],t.push(n[e]=r);return t}():void 0));return l},e.prototype.check_items_inview=function(){var t,e,n,i,r,o,s,a,c,l,u;if(null!=this.tracking){for(s=50,o=this.scrolling.width(),u=this.container.find(".document_cell .thumb"),n=c=0,l=u.length;l>c;n=++c)e=u[n],e=$(e),e.is(".visibility_tracked")||(r=e.position().left,a=e.width(),i=r+s>=0&&o>=r+a-s,i&&(t=e.closest(".document_cell").data(),Scribd.RecommendationTracking.track_obj_view(this.tracking.view_id,t.track_uuid,t.object_id,t.object_type,t.module_id),e.addClass("visibility_tracked")));return null}},e}(),Scribd.UI.Carousel.carousels=[],t=function(t,e){var n,i,r,o,s,a,c,l;return null==e&&(e={}),l="ontouchstart"in document,n=$(document.body),s=$("html"),a=0,c=0,o=function(){return n.removeClass("dragging"),t.removeClass("dragging"),s.off("mousemove touchmove",i),"function"==typeof e.stop?e.stop():void 0},i=function(t,n,i){var r,o;return r=n-a,o=i-c,a+=r,c+=o,"function"==typeof e.move?e.move(r,o):void 0},r=function(i,r,o){return n.is(".dragging")||("function"==typeof e.skip_drag?e.skip_drag(i):0)?void 0:(n.addClass("dragging"),t.addClass("dragging"),a=r,c=o,"function"==typeof e.start&&e.start(),!0)},l?t.on("touchstart",function(t){var e,n,a;return a=t.originalEvent.targetTouches[0],e=a.pageX,n=a.pageY,r(t,e,n)?(s.one("touchend",o),i=function(t){return function(i){var r;return r=i.originalEvent.targetTouches[0],e=r.pageX,n=r.pageY,t(i,e,n)}}(i),s.on("touchmove",i),!1):void 0}):t.on("mousedown",function(t){return r(t,t.pageX,t.pageY)?(s.one("mouseup",o),i=function(t){return function(e){return t(e,e.pageX,e.pageY)}}(i),s.on("mousemove",i)):void 0})},Scribd.UI.SquareCarousel=function(t){function n(t,i){this.container=t,this.opts=null!=i?i:{},this.center_contents=e(this.center_contents,this),n.__super__.constructor.apply(this,arguments),this.center_contents()}return i(n,t),n.prototype.center_contents=function(){var t,e,n,i,r,o,s,a,c;for(a=this.container.find(".content_layer .centered"),c=[],o=0,s=a.length;s>o;o++)t=a[o],t=$(t),n=t.closest(".content_layer"),i=n.height(),e=t.outerHeight(),r=Math.floor((i-e)/2),c.push(t.css("marginTop",""+r+"px"));return c},n}(Scribd.UI.Carousel)}).call(this);


/* app/views/shared/filtered_document_page.coffee @ 1425075610 */
(function(){Scribd.UI||(Scribd.UI={}),Scribd.UI.FilteredDocumentPage=function(){function t(t){var e;this.container=$(t),e=this.container.find(".filter_picker"),e.is(".open")&&this.container.find(".toggle_filters_btn").addClass("open"),this.container.on("click",".toggle_filters_btn",function(t){return $(t.currentTarget).toggleClass("open"),e.slideToggle("fast")}),this.container.find(".language_filter_picker").fancy_select(),this.container.on("change",".language_filter_picker",function(t){return window.location=$(t.currentTarget).val()})}return t}()}).call(this);


/* app/views/read2/_activity.coffee @ 1425075610 */
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};t=Scribd.make_tracker("read2:activity"),Scribd.ActivityList=function(){function n(n,i){var r,o,s=this;this.opts=i,this.mark_comment=e(this.mark_comment,this),this.update_pagination=e(this.update_pagination,this),this.append_new_comment=e(this.append_new_comment,this),this.vote_review=e(this.vote_review,this),this.container=$(n),this.filter_params={id:Scribd.current_doc.id},o=this.container.find(".event_filters"),r=this.container.find(".action_picker"),this.comment_form=this.container.find(".comment_form:first"),this.comment_textarea=this.comment_form.find("textarea"),this.rereview_message=this.container.find(".rereview_message"),this.form_rating=new Scribd.RatingPicker(this.comment_form.find(".rating_picker")),this.update_pagination(),$(document.body).on("scribd:increment_activity_count",function(t,e){var n;return null==e&&(e=1),n=s.container.find(".activity_count_value"),n.html(parseInt(n.html().replace(/[^\d]/,""),10)+e)}),(this.is_anonymous=this.container.data("anonymous"))&&this.container.on("click",".comment_form",function(){return t("click","comment_force_login"),Scribd.with_login("add_comment"),!1}),this.container.dispatch("click","read2:activity",{picker_item:function(t){var e,n;return(n=t.data("value"))?(e=t.closest("[data-param]").data("param"),s.filter_params[e]=n,t.addClass("selected").siblings(".picker_item").removeClass("selected"),s.reload_events()):void 0},toggle_filters_btn:function(t){return t.toggleClass("open"),o.slideToggle("fast",function(){return t.trigger("scribd:update_height")})},spam_comment_btn:function(t){var e;return e=t.closest(".document_comment"),s.mark_comment(e.data("id"),"spam"),t.remove()},ham_comment_btn:function(t){var e;return e=t.closest(".document_comment"),s.mark_comment(e.data("id"),"ham"),t.remove()},upvote_item_btn:function(t){var e;return e=t.closest(".document_event"),s.vote_review(s.upvote,e)},downvote_item_btn:function(t){var e;return e=t.closest(".document_event"),s.vote_review(s.downvote,e)},delete_item_btn:function(t){var e,n,i;return e=t.closest(".document_event"),n=Scribd.CSRF.with_token({_method:"DELETE"}),e.is(".document_review")?(i="/read2/"+Scribd.current_doc.id+"/reviews/"+e.data("id"),e.is(".my_review")&&s.comment_textarea.data("review-text",null)):i="/documents/"+Scribd.current_doc.id+"/comments/"+e.data("id"),$.post(i,n,function(){return e.slideUp("fast",function(){return e.remove(),t.trigger("scribd:update_height"),$(document.body).trigger("scribd:increment_activity_count",[-1])})})},reply_comment_btn:function(t){return s.toggle_reply(t.closest(".document_comment"))},load_more_events_btn:function(){return s.filter_params.next_page=s._next_page,s.reload_events(!0),delete s.filter_params.next_page},edit_your_review:function(){return s.container.find(".my_review").css("display","none"),s.comment_textarea.val(s.comment_textarea.data("review-text")),s.toggle_form($(".review_action"))}}),this.container.on("click",".action_btn",function(e){var n,i;return n=$(e.currentTarget),i=n[0].className.match(/\b\w+_action\b/),i&&t("click",i),s.container.find(".my_review").css("display","block"),n.is(".embed_action")?Scribd.DocumentActions.run("embed_btn",n,"read2:activity"):n.is(".add_to_collection_btn")?Scribd.DocumentActions.run("add_to_collection_btn",n,"read2:activity"):n.is(".review_action")&&null!=s.comment_textarea.data("review-text")?(s.select_button(n),s.comment_form.removeClass("visible"),s.rereview_message.addClass("visible")):(s.select_button(n),s.comment_textarea.val(""),s.toggle_form(n)),!1}),this.container.on("submit",function(t){var e,n;return s.is_anonymous?!1:(n=$(t.target).closest(".comment_form"),n.length?(n.removeClass("has_error"),(e=s.validate_form(n))?(n.find(".error_text").text(e).end().addClass("has_error"),!1):(n.addClass("loading"),n.is(".activity_readcast_form")?$.post(s.container.data("like_url")):void 0)):void 0)}),this.container.on("ajax:success",function(t,e){var n;return n=$(t.target).removeClass("loading"),$(document.body).trigger("scribd:increment_activity_count"),e.errors&&n.find(".error_text").text(e.errors.join(", ")).end().addClass("has_error"),e.review_text?(s.comment_textarea.data("review-text",e.review_text),s.full_comment_form_reset(),s.container.find(".my_review").remove()):e.errors||s.reset_form(n),e.comment&&s.append_new_comment(e.comment,n),n.is(".reply_form")?s.toggle_reply(n.prev(".document_comment")):void 0})}return n.prototype.downvote=-1,n.prototype.upvote=1,n.prototype.vote_review=function(t,e){var n,i;return n=Scribd.CSRF.with_token({_method:"PUT"}),n.user_vote={vote:t},i="/read2/"+Scribd.current_doc.id+"/reviews/"+e.data("id"),$.post(i,n,function(n){return e.find(".upvote_item_btn,.downvote_item_btn").removeClass("selected"),1===t?(e.find(".upvote_item_btn").addClass("selected"),e.find(".downvote_item_btn").removeClass("selected")):-1===t&&(e.find(".downvote_item_btn").addClass("selected"),e.find(".upvote_item_btn").removeClass("selected")),e.find(".score_text").text("("+(n.upvotes-n.downvotes)+")")})},n.prototype.append_new_comment=function(t,e){var n,i=this;return n=this.container.find(".event_list:first"),this.container.find(".event_lists .empty_message").remove(),(null!=e?e.is(".reply_form"):void 0)&&(n=e.next(".child_comments"),n.length||(n=$('<div class="child_comments"></div>').insertAfter(e))),$(t).children(":first").prependTo(n).hide().slideDown("fast",function(){return i.container.trigger("scribd:update_height")})},n.prototype.update_pagination=function(){var t;return t=this.container.find(".event_list:last"),this._next_page=t.data("next_page"),this.container.toggleClass("has_more",!!this._next_page)},n.prototype.toggle_form=function(t){var e;return this.rereview_message.removeClass("visible"),this.comment_form.removeClass("has_error"),this.comment_form.removeClass("activity_note_form activity_review_form activity_readcast_form").addClass("visible"),(e=t.data("type"))&&this.comment_form.addClass("activity_"+e+"_form"),this.form_rating.disable("review"!==e),this.comment_form.attr("action",t.data("url")),this.set_form_placeholder(this.comment_form),this.is_anonymous||this.comment_textarea.focus(),t.trigger("scribd:update_height")},n.prototype.select_button=function(t){return this._action_buttons||(this._action_buttons=this.container.find(".action_btn")),this._action_buttons.removeClass("selected"),t.addClass("selected")},n.prototype.validate_form=function(t){var e,n,i;if(n=t.find("textarea"),i=n.val(),t.is(".activity_review_form")){if(""===$.trim(i))return"Please enter a review";if(e=parseInt(t.find("input[name='rated']").val(),10),!(e>=1&&5>=e))return"Please choose a rating"}else if(""===$.trim(i))return"Please enter a note"},n.prototype.full_comment_form_reset=function(){return this._action_buttons||(this._action_buttons=this.container.find(".action_btn")),this._action_buttons.removeClass("selected"),this.comment_form.removeClass("visible"),this.reset_form(this.comment_form)},n.prototype.reset_form=function(t){return t.removeClass("has_error").find("textarea").val("")},n.prototype.set_form_placeholder=function(t){var e,n,i,r,o;i=t.find("textarea"),e=i.data("placeholders"),i.attr("placeholder",""),o=[];for(r in e){if(n=e[r],t.is("."+r+"_form")){i.attr("placeholder",n);break}o.push(void 0)}return o},n.prototype.reload_events=function(t){var e=this;return this.container.addClass("loading").trigger("scribd:update_height"),this._event_lists||(this._event_lists=this.container.find(".event_lists")),t||this._event_lists.empty(),$.get(this.opts.url+"?"+$.param(this.filter_params)).done(function(t){return e._event_lists.append(t.events),e.container.removeClass("loading").trigger("scribd:update_height"),e.update_pagination()})},n.prototype.toggle_reply=function(t){var e,n=this;return this._reply_form||(this._reply_form=this.comment_form.clone().attr("action",this.container.data("reply_url")).find(".rating_picker").remove().end().addClass("reply_form").removeClass("has_error activity_note_form activity_review_form activity_readcast_form").prepend("<input type='hidden' name='parent_id' value='' />"),this.set_form_placeholder(this._reply_form)),this._reply_form.prev(".document_comment").removeClass("open"),t.next().is(this._reply_form)?this._reply_form.stop().slideUp("fast",function(){return n._reply_form.detach(),n.container.trigger("scribd:update_height")}):(this._reply_form.parent().length&&(e=$("<div class='reply_spacer'></div>").height(this._reply_form.outerHeight(!0)).insertAfter(this._reply_form).slideUp("fast",function(){return e.remove()})),this._reply_form.find("input[name='parent_id']").val(t.data("id")),this._reply_form.stop().insertAfter(t.addClass("open")).hide().slideDown("fast",function(){return n.container.trigger("scribd:update_height")}))},n.prototype.mark_comment=function(t,e){return null==e&&(e="spam"),$.ajax({url:"/admin/documents/"+Scribd.current_doc.id+"/newcomments/"+t+"/mark_"+e,type:"put"})},n}(),Scribd.RatingPicker=function(){function e(e){var n,i,r=this;this.container=$(e),n=this.container.data("field_name")||"rating",this.input=$("<input type='hidden' name='"+n+"' value='0'/>").appendTo(this.container),i=this.container.find(".star_icon"),this.container.on("mousemove",".star_icon",function(t){var e;return e=$(t.target).closest(".star_icon"),i.removeClass("highlight"),e.prevAll().addBack().addClass("highlight")}),this.container.on("click",".star_icon",function(e){var n;return t("click","choose_star_rating"),n=$(e.target).closest(".star_icon"),i.removeClass("selected"),n.prevAll().addBack().addClass("selected"),r.set_value(n.data("value")),!1})}return e.prototype.set_value=function(t){return this.input.val(t),this.container.addClass("has_value").find(".current_rating").text(t)},e.prototype.disable=function(t){return this.input.prop("disabled",t)},e}()}).call(this);


/* app/views/read2/_banner.coffee @ 1425075610 */
(function(){Scribd.ReadBanner=function(){function t(t){var e=this;return this.container=$(t),this.container.html().length?(this.make_sticky(),this.container.dispatch("click","read2:preview_banner",{buy_doc_btn:function(){return Scribd.Books.get_buy_manager().get_buy_callback("preview_banner")()},premium_signup_btn:function(){return Scribd.Books.get_buy_manager().get_premium_callback("preview_banner_signup")()},toggle_banner_btn:function(){return e.collapse_banner()},login_btn:function(){return Scribd.SignIn.open("global_login")}}),this.container.click(function(t){var n;return n=$(t.target),n.is("a")||n.is(".toggle_banner_btn")?void 0:(t.stopPropagation(),e.is_collapsed()?e.collapse_banner():void 0)}),_.defer(function(){return e.container.trigger("scribd:adjust_size")}),void("function"==typeof Scribd.ReadRestrictionBanner&&new Scribd.ReadRestrictionBanner(this.container,{after_submit:function(){return Scribd.Lightbox.open("publisher_request_lb")}}))):(this.container.hide(),void(this.visible=!1))}return t.prototype.visible=!0,t.prototype.make_sticky=function(){return this.sticky_area=this.container.sticky_container({unstick_after:this.container.parent(),padding:this.container.position().top+this.container.height()}),this.sticky_area.trigger("Scribd:restick")},t.prototype.is_collapsed=function(){return this.container.hasClass("collapsed")},t.prototype.is_visible=function(){return this.visible},t.prototype.collapse_banner=function(){var t=this;if(!this.container.is(".no_toggle"))return $(".reader_footer").toggleClass("collapsed"),this.container.toggleClass("collapsed"),setTimeout(function(){return t.container.trigger("scribd:adjust_size")},400)},t}()}).call(this);


/* app/views/read2/dialogs/embed_dialog.coffee @ 1425075610 */
(function(){Scribd.UI||(Scribd.UI={}),Scribd.UI.CustomSize=function(){function t(t,e,n){var i=this;_.bindAll(this),this.embed_ui=t,this.container=$(e),this.book_mode=!1,this.options=_.extend({min_width:400,min_height:300,aspect_ratio:.75},n||{}),this.lock_aspect_ratio=!0,this.width_input=this.container.find(".custom_width"),this.height_input=this.container.find(".custom_height"),this.update_from_width=this.updater_for("width"),this.update_from_height=this.updater_for("height"),this.width_input.on("change",this.update_from_width),this.height_input.on("change",this.update_from_height),this.lock_button=this.container.find(".lock_button"),this.lock_button.on("click",function(){return i.lock_button.toggleClass("unlocked"),i.lock_aspect_ratio=!i.lock_aspect_ratio,i.lock_aspect_ratio&&0===!i.width_input.val().length?i.update_from_width():void 0})}return t.prototype.values=function(){return[parseInt(this.width_input.val(),10),parseInt(this.height_input.val(),10)]},t.prototype.has_values=function(){return 0===!this.width_input.val().length&&0===!this.height_input.val().length},t.prototype.updater_for=function(t){var e,n,i,r,o,s,a=this;return r="width"===t?"height":"width",e=this.options.aspect_ratio,"height"===t&&(e=1/e),n=this[t+"_input"],o=this[r+"_input"],i="min_"+t,s="min_"+r,function(){var c,l;if(0!==n.val().length)return a.book_mode&&(e=1/e),l=parseInt(n.val(),10),l<a.options[i]&&(l=a.options[i],n.val(l)),c=void 0,a.lock_aspect_ratio||0===o.val().length?(c=Math.max(Math.floor(l/e),a.options[s]),o.val(c)):c=a.embed_ui.custom_options[r],"width"===t?a.embed_ui.set_size(l,c):a.embed_ui.set_size(c,l)}},t}(),Scribd.UI.EmbedDialog=function(){function t(t){var e,n,i=this;_.bindAll(this),this.container=$(t),this.document=this.container.data("document"),(n=this.document).aspect_ratio||(n.aspect_ratio=.75),this.options={num_pages:this.document.page_count,aspect_ratio:this.document.aspect_ratio,doc_url:this.document.url,title:this.document.title,user_url:this.document.word_user.url,user_title:this.document.word_user.name,doc_id:this.document.id,access_key:this.document.access_key,secret_password:this.document.secret_password},this.input=this.container.find(".code_input"),this.preview_container=this.container.find(".doc_preview"),this.custom_options={},this.generators={html:new Scribd.Embed.HTML5CodeGenerator(_.clone(this.options)),wordpress:new Scribd.Embed.WordpressCodeGenerator(_.clone(this.options))},this.container.find(".content").css("padding",0),this.starting_page=this.container.find(".misc_options .starting_page"),this.container.find(".custom_size input").add(this.starting_page).restrict_numeric({allow_period:!1}),this.custom_size=new Scribd.UI.CustomSize(this,this.container.find(".custom_size")),this.starting_page.on("change",function(){var t,e;return e=0===i.starting_page.val().length?1:parseInt(i.starting_page.val(),10),t=i.options.num_pages,null!==t&&0!==t&&e>t&&(e=t,i.starting_page.val(e)),i.custom_options.page=e,i.update_code()}),this.container.on("change",".view_style",function(t){var e;return e=$(t.currentTarget).val(),i.custom_options.mode=e,i.update_code()}),this.input.select_on_focus(),this.container.find(".include_link_input").on("change",function(t){return i.custom_options.show_title=$(t.target).prop("checked"),i.update_code(),!0}),this.container.find(".include_recommendations_input").on("change",function(t){return i.custom_options.show_recommendations=$(t.target).prop("checked"),i.update_code(),!0}),this.container.on("click",".close",function(){return Scribd.Lightbox.close()}),this.container.on("click","#embed_format",function(t){var e;return e=$(t.target),e.hasClass("inactive")?(e.removeClass("inactive"),i.container.find(".option.active").removeClass("active").addClass("inactive"),e.addClass("active"),i.update_format(e.data("format"))):void 0}),e=this.container.find(".size_picker"),e.find("li").on("click",function(t){var n,r,o,s,a;return r=$(t.target).parent("li").andSelf().filter("li"),r&&(e.find("li").removeClass("active"),r.addClass("active"),s=r.data("size"),s?(a=null,n=null,o=s.match(/(\d+)x(\d+)/),o&&(a=o[1],n=o[2]),i.set_size(a,n)):i.custom_size.has_values()&&i.set_size.apply(i,i.custom_size.values())),!1}),this.update_format("html"),this.setup_copy_link()}return t.prototype.set_size=function(t,e){return t!==this.custom_options.width||e!==this.custom_options.height?(this.custom_options.width=t,this.custom_options.height=e,this.custom_options.auto_width=!t,this.custom_options.auto_height=!e,this.update_code()):void 0},t.prototype.update_format=function(t){return this.current_format=t,this.update_code()},t.prototype.update_code=function(t){var e,n=this;return"book"===this.custom_options.mode?this.showing_book||(this.showing_book=!0,this.custom_size.book_mode=!0,this.toggle_sizes()):this.showing_book&&(this.showing_book=!1,this.custom_size.book_mode=!1,this.toggle_sizes()),this.input.val(this.generators[this.current_format].render(this.custom_options)),e=this.generators.html.render(),this.preview_container.show().html(e),_.defer(function(){var t;return n.custom_options.auto_height&&n.custom_options.auto_width?(t={width:n.preview_container.width(),height:n.preview_container.height()},n.preview_container.find(".scribd_iframe_embed").css(t)):void 0}),t?void 0:this.flash()},t.prototype.toggle_sizes=function(){return $(".size_picker:first").children().toggleClass("hidden"),$(".custom_size:first").removeClass("hidden")},t.prototype.flash=function(){var t;return t=this.container.find(".tab_bodies input").flash()},t.prototype.setup_copy_link=function(){var t,e,n,i,r=this;return t=this.container.find(".copy_link"),i=t.find(".document_url_input"),e=t.find("form"),i.on("click",function(){return i[0].select()}),("undefined"!=typeof docManager&&null!==docManager?docManager.firstVisiblePage:void 0)||t.find(".position_picker").remove(),n=function(){var t,n,o,s,a,c,l,u,d;for(n={},u=e.serializeArray(),c=0,l=u.length;l>c;c++)d=u[c],t=d.name,a=d.value,n[t]=a;return o={},"current"===n.doc_position&&(o.page=docManager.firstVisiblePage.pageNum),n.fullscreen&&(o.fullscreen=1),s=r.options.doc_url,$.isEmptyObject(o)||(s+="#"+$.param(o)),i.val(s)},e.on("change",function(){return n()}),n()},t}()}).call(this);


/* app/views/read2/dialogs/flag_doc_dialog.coffee @ 1425075610 */
(function(){Scribd.FlagDocDialog=function(){function t(t){var e=this;this.container=$(t).on("submit",function(){return e.container.addClass("loading")}).on("ajax:complete",function(){return e.container.removeClass("loading"),Scribd.Lightbox.close()})}return t}()}).call(this);


/* app/views/read2/dialogs/print_dialog.coffee @ 1425075610 */
(function(){var t;t=Scribd.make_tracker("read2:print_dialog"),Scribd.PrintDialog=function(){function e(e){this.container=$(e),t("show","show"),this.container.dispatch("click","read2:print_dialog",{download_btn:function(){return Scribd.download_actions.download(Scribd.current_doc.id,"read","print")}})}return e}()}).call(this);


/* app/views/read2/dialogs/readcast_history_dialog.coffee @ 1425075610 */
(function(){var t,e,n,i,r,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};null==window.Scribd&&(window.Scribd={}),null==Scribd.UI&&(Scribd.UI={}),i={delete_readcast:function(t){var e;return e=Scribd.CSRF.with_token({_method:"delete"}),$.post("/readcast/"+t,e)},fetch_readcasts:function(t){return $.get("/readcast/all",{page:t})}},n=function(n){function o(){return r=o.__super__.constructor.apply(this,arguments)}return a(o,n),o.prototype.initialize=function(){var n=this;return _.bindAll(this),this.paginator=new e({page_size:10,item_count:this.options.readcast_count}),this.footer=new t({el:this.$(".footer"),paginator:this.paginator}),this.paginator.on("change:page",function(){return n.update_page()}),this.paginator.on("change:item_count",function(t,e){return n.update_page(e)}),this.update_page(!1)},o.prototype.update_page=function(t){return null==t&&(t=!0),0===this.paginator.item_count?this.render_no_items():t?this.load_page().then(this.footer.update):this.footer.update()},o.prototype.events={"click .next_page":"next_page","click .prev_page":"prev_page","click .delete_button":"confirm_delete","click .cancel_button, .done_button":function(){return Scribd.Lightbox.close()}},o.prototype.render_no_items=function(){var t;return t=Scribd.template("readcast_history_no_items")(),this.$(".items").replaceWith(t),this.footer.remove()},o.prototype.next_page=function(t){return t.preventDefault(),this.paginator.next()},o.prototype.prev_page=function(t){return t.preventDefault(),this.paginator.prev()},o.prototype.load_page=function(){var t=this;return i.fetch_readcasts(this.paginator.page).then(function(e){return t.$(".items").html(e)})},o.prototype.confirm_delete=function(t){var e,n,i;return t.preventDefault(),e=$(t.currentTarget).closest(".item"),i=e.find(".item_title").text(),n='Are you sure you want to delete the shares for "'+i+'"?',confirm(n)?this.delete_item(e):void 0},o.prototype.delete_item=function(t){var e,n;return i.delete_readcast(t.data("id")),$(document).trigger("scribd:delete_readcast",[t.data("readcast_id")]),t.addClass("deleted"),n=t.find(".item_title"),n.replaceWith("<span class='item_title'>"+n.text()+"</span>"),e=t.find(".item_date"),e.replaceWith("<span class='status'>Deleted</span>"),this.paginator.set_item_count(this.paginator.item_count-1),t.delay(2e3).slideUp(150)},o}(Backbone.View),t=function(t){function e(){return o=e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.initialize=function(){return _.bindAll(this),this.paginator=this.options.paginator,this.update()},e.prototype.update=function(){return this.update_status(),this.update_nav_buttons()},e.prototype.update_nav_buttons=function(){var t,e,n,i;return i=!this.paginator.at_first(),n=!this.paginator.at_last(),e=[[".prev_page",i],[".divider",i&&n],[".next_page",n]],t=this.$(".paginator"),_.each(e,function(e){var n,i,r;return i=e[0],r=e[1],n=t.find(i),r?n.show():n.hide()})},e.prototype.update_status=function(){var t,e,n,i,r,o;return o=this.paginator,n=o.page,i=o.page_size,e=o.item_count,r=Scribd.template("readcast_history_footer_status"),t=r({start:(n-1)*i+1,end:Math.min(n*i,e),count:e}),this.$(".footer_status").html(t)},e}(Backbone.View),e=function(){function t(t){_.bindAll(this),this.item_count=t.item_count,this.page_size=t.page_size,this.page=t.page,null==this.page&&(this.page=1)}return _.extend(t.prototype,Scribd.Events),t.prototype.next=function(){if(this.at_last())throw new Error("Already on the last page");return this.trigger("change:page",++this.page)},t.prototype.prev=function(){if(this.at_first())throw new Error("Already on the first page");return this.trigger("change:page",--this.page)},t.prototype.at_first=function(){return 1===this.page},t.prototype.at_last=function(){return this.page===this.max_page()},t.prototype.max_page=function(){return Math.ceil(this.item_count/this.page_size)},t.prototype.set_item_count=function(t){var e,n;if(!(t>=0))throw new Error("Item count must be at least 0");return this.item_count=t,n=this.page,this.page=Math.min(this.page,this.max_page()),e=this.page!==n,this.trigger("change:item_count",t,e)},t}(),Scribd.UI.ReadcastHistoryDialog=n}).call(this);


/* app/views/read2/_footer_documents.coffee @ 1425075610 */
(function(){Scribd.ReadFooter=function(){function t(t){this.container=$(t)}return t}()}).call(this);


/* app/views/read2/_info.coffee @ 1425075610 */
(function(){var t,e,n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};t=function(t){function n(){return e=n.__super__.constructor.apply(this,arguments)}return i(n,t),n.prototype.download_page="read",n.prototype.download_action="info_download",n.prototype.find_object=function(){return{type:"document",id:Scribd.current_doc.id,secret_password:Scribd.current_doc.secret_password}},n.prototype.flag_document_btn=function(){return Scribd.with_login("flag_document",Scribd.current_doc.url,function(){return Scribd.Lightbox.remote_open("lightbox_flag_document","/read/flag_dialog",Scribd.toolbar_params())})},n}(Scribd.DocumentActions),Scribd.DocInfo=function(){function e(e,n){var i=this;null==n&&(n={}),this.container=$(e).has_expandable_text(function(t){return t.trigger("scribd:update_height")}),this.container.find(".doc_description_short").dotdotdot(),new t(this.container,"document_info"),this.container.dispatch("click","read2:info",{premium_signup_link:function(){return Scribd.read_page.buy_manager.get_premium_callback("info_signup")()},toggle_open_btn:function(){return i.container.toggleClass("open")}}),Scribd.hook_tooltips(this.container,{position:Scribd.Tooltips.Under2.position}),$(document.body).on("scribd:increment_activity_count",function(t,e,n){var r;return null==e&&(e=1),"like"===n?(r=i.container.find(".like_count_value"),r.html(parseInt(r.html(),10)+e)):void 0}),new Scribd.StarRatings(this.container.find(".rating_star_holder"),{default_value:n.user_rating||n.rating_average,force_login:!0,doc_id:Scribd.current_doc.id}),this.container.on("scribd:rating",function(t,e){var n;return n=3,i.container.find(".rating_stat .label").text("You rated this: "),i.container.find(".rating_stat .value").hide(),$.post("/ratings?word_document_id="+Scribd.current_doc.id+".json",{rated:e,source:n},function(){})})}return e}()}).call(this);


/* app/views/read2/lists/_tracked_footer_carousel.coffee @ 1425075610 */
(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Scribd.TrackedFooterCarousel=function(t){function n(){var t=this;n.__super__.constructor.apply(this,arguments),Scribd.RecommendationTracking.page_view_deferred(this.opts.compilation_id,"read").done(function(e){return t.container.trigger("scribd:setup_tracking",[e,"read",t.opts.index])})}return e(n,t),n}(Scribd.UI.Carousel)}).call(this);


/* app/views/read2/popups/_readcast_popup.coffee @ 1425075610 */
(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},n=[].slice;Scribd.ReadcastPopup=function(t){function i(t){var e=this;this.container=$(t),this._has_readcasted=!1,$(document).on("scribd:delete_readcast",function(t,n){var i;return n===(null!=(i=e.submitted_readcast)?i.like_id:void 0)?e._after_undo():void 0}),this.container.on("scribd:popup_open",function(t,n){return e._has_readcasted?void 0:(e.toolbar_btn=n,e._has_readcasted=!0,e._submit_readcast().done(function(t){return e.submitted_readcast=t.data,e.set_readcast_message(t.data.total_readcasts),e.container.addClass("success"),e.toolbar_btn.addClass("liked"),$(document.body).trigger("scribd:increment_activity_count",[1,"like"])}))}),this._toggle_facebook_share=_.debounce(function(){var t;return t=1<=arguments.length?n.call(arguments,0):[],this.constructor.prototype._toggle_facebook_share.apply(this,t)},200),this.container.dispatch("click","read2:"+this.track_category,{undo_readcast_btn:function(){return e._undo_readcast()},view_history_btn:function(){return Scribd.Lightbox.remote_open("readcast_history_dialog","/read/readcast_history_dialog")},toggle_share_btn:function(t){return Scribd.named_current_user_sync().is_facebook_user?(e._toggle_facebook_share(),t.toggleClass("enabled")):void Scribd.facebook.login(function(){return Scribd.named_current_user_sync().is_facebook_user?t.trigger("click"):void 0})}}),this.setup_comment_form(),this._check_facebook()}return e(i,t),i.prototype.track_category="readcast_popup",i.prototype.increment_activity=!1,i.prototype._check_facebook=function(){var t=this;return Scribd.with_named_current_user(function(){var e;if(t._is_facebook_user()&&(null!=(e=Scribd.current_doc.auto_share)?e.facebook:void 0))return t.needs_facebook=Scribd.facebook_login_status.then(function(){return Scribd.facebook.check_permission("publish_stream")})})},i.prototype._is_facebook_user=function(){return Scribd.named_current_user_sync().is_facebook_user},i.prototype._toggle_facebook_share=function(){var t,e,n;return t=Scribd.current_doc.auto_share,n={_method:"put"},e=function(t){return"options[event_settings][reading]["+t+"]"},t.scribd=!t.scribd,n[e("scribd")]=t.scribd?"on":"off",t.facebook=t.scribd,n[e("facebook")]=n[e("scribd")],$.post("/sharing_preference",n)},i.prototype._submit_readcast=function(){var t,e,n=this;return this.needs_facebook?(t=$.Deferred(),e=function(){return $.post(n.container.data("like_url")).done(function(){return t.resolve.apply(t,arguments)})},this.needs_facebook.then(e,function(){return Scribd.facebook.login(function(t){return t?(e(),n.needs_facebook=null):void 0})}),t):$.post(this.container.data("like_url"))},i.prototype._undo_readcast=function(){return $.post(this.container.data("unlike_url"),{like_id:this.submitted_readcast.like_id}),this._after_undo()},i.prototype._after_undo=function(){var t;return this.container.removeClass("success").addClass("canceled"),null!=(t=this.toolbar_btn)&&t.removeClass("liked"),$(document.body).trigger("scribd:increment_activity_count",[-1,"like"])},i.prototype.set_readcast_message=function(t){var e;return e=function(){switch(t){case 0:case 1:return I18n.t("js.newdoc.you_liked_this");case 2:return I18n.t("js.newdoc.you_and_one_other_liked_this");default:return isNaN(t)?I18n.t("js.newdoc.you_liked_this"):I18n.t("js.newdoc.you_and_x_others_liked_this",{count:t-1})}}(),this.container.find(".readcast_total > .text").html(e)},i}(Scribd.CommentingPopup)}).call(this);


/* app/views/read2/popups/_share_popup.coffee @ 1425075610 */
(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Scribd.SharePopup=function(){function e(e){this.add_scripts=t(this.add_scripts,this);var n=this;this.container=$(e),this.container.on("scribd:popup_open",function(){return n.add_scripts(),n.add_scripts=function(){}})}return e.prototype.add_scripts=function(){return $(document.body).append(this.container.data("external_scripts")),FB.XFBML.parse(this.container[0])},e}()}).call(this);


/* app/views/read2/_seo_banner.coffee @ 1425075610 */
(function(){var t;t=Scribd.make_tracker("read2"),Scribd.SeoBanner=function(){function e(e){var n=this;this.container=$(e),this.make_sticky(),Scribd.SeoShared.setup_quotes(this.container),Scribd.SeoShared.setup_carousel(this.container.find(".seo_images")),t("show","seo_banner"),_.defer(function(){return n.sticky_area.trigger("Scribd:restick")}),this.container.dispatch("click","read2:seo_banner",{toggle_banner_btn:function(){return n.toggle_banner()},start_month_btn:function(){return n.start_month_btn_clicked()}})}return e.prototype._track_click=function(t){var e;return e=this.container.is(".collapsed")?"closed":"open",Scribd.track_event("SEOPromoBanner:"+e,"Click",""+t),!0},e.prototype.make_sticky=function(){return this.container.addClass("collapsed"),this.sticky_area=this.container.sticky_container({unstick_after:this.container.parent(),padding:this.container.position().top+this.container.outerHeight()}),this.sticky_area.trigger("Scribd:restick")},e.prototype.toggle_banner=function(){var t=this;return this.container.toggleClass("collapsed"),this.resize_spacer(),this.container.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){return t.resize_spacer()})},e.prototype.start_month_btn_clicked=function(){return this._track_click("start_month_btn"),window.open("/subscribe?page=read&action=DocPromoThree")},e.prototype.resize_spacer=function(){return $(".seo_banner_spacer").height(this.container.outerHeight())},e}()}).call(this);


/* app/views/read2/_seo_lightbox.coffee @ 1425075610 */
(function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};t=Scribd.make_tracker("read2"),Scribd.SeoLightbox=function(e){function i(){var e=this;i.__super__.constructor.apply(this,arguments),Scribd.SeoShared.setup_quotes(this.container),Scribd.SeoShared.setup_carousel(this.container.find(".seo_images")),t("show","seo_lightbox"),this.container.dispatch("click","read2:seo_lightbox",{close_button:function(){return e.close_button_clicked()},start_month_btn:function(){return e.start_month_btn_clicked()}})}return n(i,e),i.prototype._track_click=function(t){return Scribd.track_event("SEOLightbox","Click",""+t),!0},i.prototype.close_button_clicked=function(){return this._track_click("close_btn"),this.close()},i.prototype.start_month_btn_clicked=function(){var t;return this._track_click("start_month_btn"),t="DocPromoOne",window.open("/subscribe?page=read&action="+t)},i}(Scribd.Lightbox)}).call(this);


/* app/views/read2/show_bot.coffee @ 1425075610 */
(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Scribd.BotReadPage=function(t){function n(t,e){null==e&&(e={}),this.container=$(t),this.doc_container=$(),this.setup_responsive(),this.setup_width()}return e(n,t),n}(Scribd.ReadPage)}).call(this);


/* app/views/read2/_sidebar.coffee @ 1425075610 */
(function(){Scribd.ReadSidebar=function(){function t(t){this.container=$(t),this.setup_responsive(),this.make_sticky(),this.is_downloader=!!this.container.find(".sidebar_downloader .has_download").length}return t.prototype.height_threshold=1100,t.prototype.make_sticky=function(){var t=this;if(!this.container.find(".sidebar_downloader").is(".no_stick"))return this.sticky_area=this.container.find(".sticky_area").sticky_container({unstick_after:this.container.parent(),padding:55,before_stick:function(e){return e.is(".bottomed")?void 0:e.is(".unbottoming")?void e.removeClass("unbottoming"):t.reveal_sticky_content()},before_unstick:function(e){return e.is(".bottomed")?void 0:t.hide_sticky_content()},before_bottom:function(e){var n;return n=e.offset().top-t.container.offset().top,e.css({top:n})},before_unbottom:function(t){return t.css({top:""}).addClass("unbottoming")}}),$(document.body).on("scribd:ads_disabled",function(){return t.sticky_area.trigger("Scribd:update_root").trigger("Scribd:restick")})},t.prototype.reveal_sticky_content=function(){var t;if(this.should_stick_promo())return(null!=(t=this._stuck_element)?t.is(":animated"):void 0)?void this._stuck_element.stop(!0).hide().fadeIn():(this._promo_clone||(this._promo_clone=this.container.find(".sidebar_downloader").clone(!0),this.update_sticky_promo()),this._stuck_element=this._promo_clone,this.sticky_area.append(this._stuck_element),this._stuck_element.hide().fadeIn())},t.prototype.hide_sticky_content=function(){var t=this;return this._stuck_element?this._stuck_element.stop(!0).fadeOut(function(){return t._promo_clone.detach(),delete t._stuck_element}):void 0},t.prototype.should_stick_promo=function(){return this.is_downloader?!0:$(document.body).is(".ads_disabled")?!0:!1},t.prototype.update_sticky_promo=function(){var t,e;return e=$(window),t=$(document.body),this.update_sticky_promo=function(){var n;return null!=(n=this._promo_clone)?n.toggleClass("is_short",!t.is(".ads_disabled")&&e.height()<this.height_threshold):void 0},this.update_sticky_promo()},t.prototype.setup_responsive=function(){var t=this;return $(window).on("resize",function(){return t.update_sticky_promo()}),this.update_sticky_promo()},t}()}).call(this);


/* app/views/read2/sidebar/_admin.coffee @ 1425075610 */
(function(){Scribd.ReadPageAdmin=function(){function t(t){var e,n=this;this.container=$(t),e=!0,this.container.dispatch("click",{toggle_admin_btn:function(){return n.container.toggleClass("open")}})}return t}()}).call(this);


/* app/views/read2/sidebar/_document_list.coffee @ 1425075610 */
(function(){var t;t=Scribd.make_tracker("read"),Scribd.SidebarDocumentList=function(){function t(t){var e=this;this.container=$(t),this.pages=this.container.find(".sidebar_doc_page"),this.container.find(".document_list_pager").dispatch("click","read2:sidebar_list",{next_page_btn:function(){return e.move_page(1)},prev_page_btn:function(){return e.move_page(-1)}}),this.container.delegate_tracking("click","read:sidebar"),this.setup_tracking()}return t.prototype.current_page=1,t.prototype.move_page=function(t){return null==t&&(t=0),this.current_page_label||(this.current_page_label=this.container.find(".current_page")),this.current_page+=t,this.current_page=Math.max(1,Math.min(this.pages.length,this.current_page)),this.current_page_label.text(this.current_page),this.container.toggleClass("first_page",1===this.current_page).toggleClass("last_page",this.current_page===this.pages.length),this.pages.hide().eq(this.current_page-1).show(),this.track_visible()},t.prototype.setup_tracking=function(){var t,e=this;return t=this.container.data("compilation_id"),Scribd.RecommendationTracking.track_page_view(t,"read",function(n){var i,r,o,s;for(s=e.container.find(".sidebar_doc"),r=0,o=s.length;o>r;r++)i=s[r],$(i).data("track_rats_value").view_id=n;return e.tracking={view_id:n,compilation_id:t},e.container.one("inview",function(){return Scribd.RecommendationTracking.track_module_view(n,e.container.data("track_uuid"),"read:sidebar",1),e.track_visible()}),Scribd.RecommendationTracking.trigger_inview_check()})},t.prototype.track_visible=function(){var t,e,n,i,r,o,s;if(this.tracking){for(n=this.pages.eq(this.current_page-1),o=n.find(".sidebar_doc"),s=[],i=0,r=o.length;r>i;i++)e=o[i],e=$(e),e.is("visiblity_tracked")||(t=e.data(),Scribd.RecommendationTracking.track_obj_view(this.tracking.view_id,t.track_uuid,t.object_id,"document"),s.push(e.addClass("visibility_tracked")));return s}},t}()}).call(this);


/* app/views/read2/sidebar/_downloader.coffee @ 1425075610 */
(function(){Scribd.SidebarDownloader=function(){function t(t){var e=this;this.container=$(t),this.container.dispatch("click","read2:sidebar_downloader",{format_download_btn:function(){var t,n;return t=Scribd.current_doc,n=e.container.find("input[name='extension']:checked").val(),Scribd.download_actions.download_attempt(function(){var e;return e={extension:n},t.secret_password&&(e.secret_password=t.secret_password),window.location.href=t.download_url+"?"+$.param(e)},"read","download_promo",t)}}),$(document.body).on("scribd:buy_disabled",function(t,n){return e.container.find(".country_name").text(n.country)})}return t}()}).call(this);


/* app/views/read2/sidebar/_find_panel.coffee @ 1425075610 */
(function(){var t;t=Scribd.make_tracker("read2:find_panel"),Scribd.Highlighter={highlight_class:"fourgen_highlight",clear:function(){var t,e,n,i,r,o;for(r=$("."+this.highlight_class),o=[],n=0,i=r.length;i>n;n++)t=r[n],e=t.parentNode,e.replaceChild(t.firstChild,t),o.push(e.normalize());return o},highlight:function(t,e){var n,i,r,o=this;return r=RegExp(Scribd.escape_regexp(e),"i"),i=0,n=function(t){var s,a,c,l,u,d,h;if(u=0,3===t.nodeType)l=t.data.search(r),l>=0&&(d=$("<span>"),d.addClass(o.highlight_class),s=t.splitText(l),s.splitText(e.length),a=$(s).clone(),d.append(a),$(s).replaceWith(d),u=1,i++);else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))if((null!=(h=t.className)?h.indexOf(o.highlight_class):void 0)<0||null==t.className)for(c=0;c<t.childNodes.length;)c+=n(t.childNodes[c]),++c;else i++;return u},n(t),i}},Scribd.ToolbarFindPanel=function(){function e(t,e){var n=this;this.toolbar=e,this.container=$(t),this.input=this.container.find(".find_input"),this.input.on("keydown",function(t){return 27===t.keyCode?(n.toolbar.toggle_panel("find"),!1):void 0}),this.form=this.container.find(".search_form").on("ajax:success",function(t,e){return n.render_results(e),e.length?n.goto_result(0):void 0}),this.form.on("submit",function(){return n.form.addClass("loading"),n.last_query=n.input.val()}),this.form.on("ajax:complete",function(){return n.form.removeClass("loading")}),this.container.dispatch("click","read2:find_panel",{clear_search_btn:function(){return""!==n.input.val()||n.container.hasClass(".has_results")?(Scribd.Highlighter.clear(),n.container.removeClass("has_results").trigger("scribd:update_panel"),n.input.val("")):void n.toolbar.toggle_panel("find")},search_result:function(t){var e;return e=t.data("result_id"),n.goto_result(e)}}),docManager.addEvent("pageLoaded",function(t){var e,i,r;return e=parseInt(t.id.match(/\d+$/)[0],10),(null!=(i=n._to_highlight)?i[e]:void 0)&&(n.highlight_page($(t)),delete n._to_highlight[e],null!=(r=n._selected_result)?r.page_num=e:void 0)?n.select_result(n._selected_result.result_id):void 0}),this.add_inline_auth(),this.setup_sections()}return e.prototype.setup_sections=function(){var e=this;return this.container.on("click","[data-first_page]",function(n){var i,r;return t("click","goto_section"),r=$(n.currentTarget),i=r.data("first_page"),document.location.hash="#page="+i,e.toolbar.with_lock(function(){return docManager.gotoPage(i)}),!1})},e.prototype.add_inline_auth=function(t){var e,n,i;return null==t&&(t=Scribd.current_doc.inline_search_auth),t?(e=function(){var e;e=[];for(n in t)i=t[n],e.push($('<input type="hidden" />').attr("name",n).val(i));return e}(),$('<div class="auth_inputs"></div>').append(e).appendTo(this.form.find(".auth_inputs").remove().end())):void 0},e.prototype.render_results=function(t){var e,n,i,r,o,s;return null!=this.last_results&&Scribd.Highlighter.clear(),this.last_results=t,this._results||(this._results=this.container.find(".search_results")),this._results.find(".max_result").text(t.length).end().find(".search_query").text(this.last_query),this._result_template||(this._result_template=_.template($("#tpl_search_result").html())),n=new RegExp(Scribd.escape_regexp(this.last_query),"i"),i=function(){var i,s,a;for(a=[],e=i=0,s=t.length;s>i;e=++i)r=t[e],o=_.escape(r.snippet).replace(n,"<strong>$&</strong>"),a.push(this._result_template({page_number:r.pageNum,result_text:o,result_id:e}));return a}.call(this),this._results.find(".results_list").html(i.join("")),this.container.addClass("has_results").toggleClass("empty_results",!t.length).trigger("scribd:update_panel"),null!=(s=this._curr_result)&&s.text("0"),this._all_results=this._results.find(".search_result"),this.highlight_all()},e.prototype.goto_result=function(t){var e;return e=this.last_results[t].pageNum,e!==docManager.currentPageNum()&&this.toolbar.with_lock(function(){return docManager.gotoPage(e)}),this.select_result(t),this._curr_result||(this._curr_result=this.container.find(".curr_result")),this._curr_result.text(t+1)},e.prototype.select_result=function(t){var e,n,i,r,o,s,a;for(r=this.last_results[t],i=r.pageNum,this._all_results.removeClass("active").eq(t).addClass("active"),n=0;(null!=(o=this.last_results[t-n-1])?o.pageNum:void 0)===i;)n++;return(null!=(s=docManager.pages[i])?s.innerPageElem:void 0)?(delete this._selected_result,e=""+Scribd.Highlighter.highlight_class+"_selected",null!=(a=this._previously_highlighted)&&a.removeClass(e),this._previously_highlighted=$("#outer_page_"+i).find("."+Scribd.Highlighter.highlight_class+":eq("+n+")").addClass(e)):this._selected_result={page_num:i,result_id:t}},e.prototype.highlight_all=function(){var t,e,n,i,r,o,s;for(this._to_highlight={},r=_.uniq(function(){var t,n,i,r;for(i=this.last_results,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(e.pageNum);return r}.call(this),!0),s=[],n=0,i=r.length;i>n;n++)t=r[n],s.push((null!=(o=docManager.pages[t])?o.innerPageElem:void 0)?this.highlight_page($("#outer_page_"+t)):this._to_highlight[t]=!0);return s},e.prototype.highlight_page=function(t){return Scribd.Highlighter.highlight(t[0],this.last_query)},e}()}).call(this);
